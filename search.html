<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>Search Result</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />

    <!-- Custom.css -->
    <link rel="stylesheet" type="text/css" href="/assets/built/custom.css" />

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- webfont -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css">

    <!-- syntax.css -->
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />

    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="Careful Writer" />
    <link rel="shortcut icon" href="https://heuristicwave.github.io/assets/built/images/water-wave-48.png" type="image/png" />
    <link rel="canonical" href="https://heuristicwave.github.io/search" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="Heuristic Wave Blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Search Result" />
    <meta property="og:description" content="Careful Writer" />
    <meta property="og:url" content="https://heuristicwave.github.io/search" />
    <meta property="og:image" content="https://heuristicwave.github.io/assets/built/images/blog-cover.jpg" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Search Result" />
    <meta name="twitter:description" content="Careful Writer" />
    <meta name="twitter:url" content="https://heuristicwave.github.io/" />
    <meta name="twitter:image" content="https://heuristicwave.github.io/assets/built/images/blog-cover.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Heuristic Wave Blog" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="2000" />
    <meta property="og:image:height" content="666" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "Heuristic Wave Blog",
        "logo": "https://heuristicwave.github.io/"
    },
    "url": "https://heuristicwave.github.io/search",
    "image": {
        "@type": "ImageObject",
        "url": "https://heuristicwave.github.io/assets/built/images/blog-cover.jpg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://heuristicwave.github.io/search"
    },
    "description": "Careful Writer"
}
    </script>
    <script data-ad-client="ca-pub-6093187208665634" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="Search Result" href="https://heuristicwave.github.io/feed.xml" />


</head>
<body class="page-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- < default -->
<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<!-- The big featured header, it uses blog cover image as a BG if available -->
<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://heuristicwave.github.io/">Heuristic Wave Blog</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
    <li class="nav-projects" role="menuitem"><a href="/tag/projects/">Projects</a></li>
    <li class="nav-devops" role="menuitem"><a href="/tag/devops/">DevOps</a></li>
    <li class="nav-aws" role="menuitem"><a href="/tag/aws/">AWS</a></li>
    <li class="nav-backend" role="menuitem"><a href="/tag/backend/">Back-end</a></li>
    <li class="nav-archive" role="menuitem">
        <a href="/archive">All Posts</a>
    </li>
    <li class="nav-archive" role="menuitem">
        <a href="/author_archive.html">Tagë³„ Posts</a>
    </li>
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Search</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  post page no-image">

            <header class="post-full-header">
                <h1 class="post-full-title">Search Result</h1>
            </header>

            

            <section class="post-full-content">
                <form action="/search" method="get" hidden="hidden">
    <label for="search-box"></label>
    <input type="text" id="search-box" name="query">
</form>

<ul class="mylist" id="search-results"></ul>

<script>
    window.store = {
    
    "ec2-clocksource": {
        "title": "EC2 Clocksource",
            "author": "HeuristicWave",
            "category": "",
            "content": "ëª°ë¼ë„ ë˜ì§€ë§Œ ì•Œë©´ ì•Œìˆ˜ë¡ ë” ì‹ ë¹„í•œ EC2 ğŸ™ƒPreviewì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” AWS Well-Architected Labs - Performance Efficiency ì— ê°œì¬ëœ Calculating differences in clock sourceë¥¼ ì½ê³  ê¶ê¸ˆì¦ì´ ìƒê²¨ êµ¬ê¸€ë§ì„ í•˜ë‹¤ ì•Œê²Œ ëœ ì‚¬ì‹¤ë“¤ì„ ì˜ì‹ì˜ íë¦„ëŒ€ë¡œ ì‘ì„±í•œ í¬ìŠ¤íŒ…ì…ë‹ˆë‹¤.Performance Efficiency Summaryì¼ë‹¨ Performance Efficiencyì— ë‚˜ì˜¤ëŠ” ì‹¤í—˜ ë‚´ìš©ì„ ìš”ì•½í•˜ìë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.AWSì˜ 5ì„¸ëŒ€ ê°€ìƒë¨¸ì‹  Nitroì™€ non-nitro ì¸ìŠ¤í„´ìŠ¤ 2ê°œë¥¼ ì˜¬ë¦¬ê³  ì‹œê°„ì„ ë°˜í™˜í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ëŒë ¤ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.ë‹¹ì—°íˆ 5ì„¸ëŒ€ Nitroê°€ ê¸°ì¡´ ì„¸ëŒ€ë³´ë‹¤ ì›”ë“±í•œ ê²°ê³¼ë¥¼ ë³´ì—¬ ì£¼ì§€ë§Œ,non-nitro ê¸°ë°˜ì˜ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ â€˜ë¦¬ëˆ…ìŠ¤ í´ëŸ­ ì†ŒìŠ¤ë¥¼ êµì²´í•˜ë©´ ìœ ì˜ë¯¸í•œ ì„±ëŠ¥ í–¥ìƒì˜ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤â€™ ë¼ëŠ” ì‹¤í—˜ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.  Nitro ê¸°ë°˜ ì¸ìŠ¤í„´ìŠ¤ì˜ default clocksource : kvm-clock(ê¶Œì¥)  Non-nitro ì¸ìŠ¤í„´ìŠ¤ì˜ default clocksource : xen  ì‹¤í—˜ì—ì„œ êµì²´í•œ Non-nitro ì¸ìŠ¤í„´ìŠ¤ì˜ clocksource : tscë§ˆì§€ë§‰ìœ¼ë¡œ ì²¨ë¶€ëœ How do I manage the clock source for EC2 instances running Linux?ê²Œì‹œë¬¼ì—ì„œ í´ëŸ­ ì†ŒìŠ¤ë¥¼ êµì²´í•˜ëŠ” ë°©ë²•(xenì—ì„œ tscë¡œ êµì²´)ì„ ì†Œê°œí•˜ë©° ì‹¤í—˜ ë‚´ìš©ì„ ë§ˆì¹©ë‹ˆë‹¤.ê¶ê¸ˆí•œ ê±´ ëª» ì°¸ì•„ â“ìœ„ì— ì†Œê°œí•œ Labì„ ì§„í–‰í•˜ë‹¤ ë³´ë‹ˆ â€˜ì™œ tscë¡œ êµì²´í•˜ì—¬ ì„±ëŠ¥ í–¥ìƒ íš¨ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ”ì§€â€™ ì•Œ ìˆ˜ê°€ ì—†ì—ˆìŠµë‹ˆë‹¤.ê¶ê¸ˆì¦ì„ í•´ì†Œí•˜ê¸° ìœ„í•´ êµ¬ê¸€ë§ì„ í•˜ë‹¤ ë³´ë‹ˆ ì´í•´ë¥¼ ë•ëŠ” ë‹¤ìŒ 3ê°€ì§€ ìë£Œë¥¼ ì°¾ì„ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.â± TimestampingRed Hat Reference Guide ì—ì„œ ì–´ëŠ ì •ë„ ì œ ê°€ë ¤ìš´ ë¶€ë¶„ì„ ê¸ì–´ ì£¼ì—ˆë˜ í¬ìŠ¤íŒ…ì´ ìˆìŠµë‹ˆë‹¤.ê¸°ë³¸ì ìœ¼ë¡œ ë©€í‹°í”„ë¡œì„¸ì„œ ì‹œìŠ¤í…œì¸ NUMAì™€ SMP ì•„í‚¤í…ì²˜ì—ì„œëŠ” ì—¬ëŸ¬ ê°œì˜ clock sourceê°€ íƒ‘ì¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤.ë©€í‹°í”„ë¡œì„¸ì„œ ê¸°ë°˜ì˜ EC2 ì¸ìŠ¤í„´ìŠ¤ì—ì„œë„ ì•„ë˜ ëª…ë ¹ì–´ë¡œ ì‚¬ìš© ê°€ëŠ¥í•œ clocksourceë¥¼ í™•ì¸í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.cat /sys/devices/system/clocksource/clocksource0/available_clocksourcexen tsc hpet acpi_pmRed Hatì˜ ì‹¤í—˜ ê²°ê³¼ì— ë”°ë¥´ë©´ tsc &gt; hpet &gt; acpi_pm ìˆœìœ¼ë¡œ ì˜¤ë²„í—¤ë“œê°€ ì ì€ë°,tscëŠ” registerì—ì„œ hpetì€ memory areaì—ì„œ ì½ê¸° ë•Œë¬¸ì— ìˆ˜ì‹­ë§Œ ê°œì˜ íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ì§€ì •í•  ë•Œ ìƒë‹¹í•œ ì„±ëŠ¥ ì´ì ì„ ì œê³µí•œë‹¤ê³  í•©ë‹ˆë‹¤.âš™ï¸ Heap Engineering PostRunning a database on EC2? Your clock could be slowing you down. ì„ ë³´ë©´ ë” ì •í™•í•œ ë¶„ì„ì´ ìˆìŠµë‹ˆë‹¤.ë‚´ìš©ì´ ì–´ë ¤ì›Œ ì €ëŠ” ì™„ë²½í•˜ê²Œ ì´í•´í•˜ì§€ ëª»í–ˆì§€ë§Œ, ì½ì–´ë³´ì‹œë©´ êµ‰ì¥íˆ ì¢‹ì€ ìë£Œì¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤.Heap Engineering í•´ë‹¹ í¬ìŠ¤íŒ…ì—ì„œ ë°€ë‹¹ì„ ì‹œë„í•˜ëŠ”ë°â€¦â€˜tscì—ì„œëŠ” ë‚®ì€ ê°€ëŠ¥ì„±ìœ¼ë¡œ clock drift í˜„ìƒì´ ìˆì–´ í”„ë¡œë•ì…˜ì—ì„œëŠ” ìˆ˜í–‰í•˜ì§€ ë§ë¼â€™ ê³  í–ˆë‹¤ê°€,ì‹¤ì œë¡œëŠ” clock drfitê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤ë©° AWSê°€ tscë¥¼ ê¶Œì¥í–ˆë˜ ìŠ¬ë¼ì´ë“œ ìë£Œ ë¥¼ í•¨ê»˜ ë³´ì—¬ì¤ë‹ˆë‹¤.ê·¸ëƒ¥ ë§˜ë†“ê³  kvm-clockì´ íƒ‘ì¬ëœ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ”ê²Œ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.ğŸ¥ Tudum~ ë˜! Netflixí´ë¼ìš°ë“œë¥¼ ê³µë¶€í•˜ë‹¤ ë³´ë©´ Netflix ê°€ í´ë¼ìš°ë“œì— ì§€ëŒ€í•œ ì˜í–¥ì„ ë¼ì¹œ ê²ƒ ê°™ë‹¤ê³  ëŠë‚„ ë•Œê°€ ë§ì€ë°, ì´ë²ˆì—ë„ ê·¸ë¬ìŠµë‹ˆë‹¤.AWS re:Invent 2014ì—ì„œ Netflixì˜ Senior Performance Architect, Brendan Greggì˜ ë°œí‘œ ìë£Œ ë¥¼ ë³´ë©´xenì—ì„œ tscë¡œ êµì²´í•˜ì—¬ CPU ì‚¬ìš©ëŸ‰ì€ 30%, í‰ê·  ì•± ë ˆì´í„´ì‹œëŠ” 43%ê°€ ì¤„ì—ˆë‹¤ê³  í•©ë‹ˆë‹¤.Resultì´ë²ˆì—ë„ êµ¬ê¸€ë§ìœ¼ë¡œ ë”´ì§“ì„ í•˜ë‹¤ ë³´ë‹ˆ ë§ì€ ì‚¬ì‹¤ë“¤ì„ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì‚¬ì‹¤ Current generation instances ë¥¼ì‚¬ìš©í•˜ë©´ ëŒ€ë¶€ë¶„ ìœ„ì—ì„œ ì–¸ê¸‰í•œ ìµœì í™”ëŠ” T2 ì‹œë¦¬ì¦ˆ, Gravition ê³„ì—´ì„ ì œì™¸í•œ ëŒ€ë¶€ë¶„ì˜ ì¸ìŠ¤í„´ìŠ¤ì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì ìš©ë˜ì–´ ìˆìŠµë‹ˆë‹¤.ê·¸ë˜ì„œ í¬ìŠ¤íŒ…ì˜ ì²« í¬ë¬¸ì„ â€˜ëª°ë¼ë„ ë˜ì§€ë§Œ ~â€™ì´ë¼ ì§€ì—ˆìŠµë‹ˆë‹¤.clocksourceì™€ëŠ” ë³„ë„ë¡œ ì´ë²ˆ í¬ìŠ¤íŒ…ì„ ì¤€ë¹„í•˜ë‹¤ ê±°ì˜ ì£¼ë§ í•˜ë£¨ë¥¼ ì†Œë¹„í–ˆëŠ”ë°,ë¹„êµì  ìµœê·¼ì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ê³¼ê±° ì¸ìŠ¤í„´ìŠ¤ë“¤ê³¼ ì–´ë–»ê²Œ ë‹¤ë¥¸ì§€(Hypervisor, Jumbo Frame ë“±ë“±)ë¥¼ ì•Œ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ì‚¬ì‹¤ë“¤ ì—­ì‹œ ê·¸ëƒ¥ Nitro ê¸°ë°˜ì˜ Amazon Linux 2ë¥¼ ì‚¬ìš©í•˜ë©´, ìš´ì˜í•˜ëŠ”ë° ëª°ë¼ë„ ì§€ì¥ ì—†ì´ ìµœê³ ì˜ ì„±ëŠ¥ì„ ë³´ì¥ë°›ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.ì•„ì§ ì•ŒìŒì•ŒìŒ ì•„ëŠ” ì§€ì‹ì´ë¼ í¬ìŠ¤íŒ…í•˜ê¸° ì–´ë µì§€ë§Œ, í›—ë‚  ë” ì •í™•íˆ ì•Œê²Œ ë˜ë©´ ì„±ëŠ¥ê³¼ ê´€ë ¨ëœ ë‹¤ë¥¸ íŠœë‹ ìš”ì†Œë“¤ë„ ì ì–´ë³´ê² ìŠµë‹ˆë‹¤.ì†Œì¤‘í•œ ì‹œê°„ì„ ë‚´ì–´ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ì˜ëª»ëœ ë‚´ìš©ì€ ì§€ì í•´ì£¼ì„¸ìš”! ğŸ˜ƒğŸ“š í¬ìŠ¤íŒ…ê³¼ ì§ì ‘ì ì¸ ì—°ê´€ë„ëŠ” ë–¨ì–´ì§€ì§€ë§Œ í•¨ê»˜ ë³´ë©´ ì¢‹ì€ ìë£Œ  AWS EC2 Virtualization 2017: Introducing Nitro  Linux AMI virtualization types  Reinventing virtualization with the AWS Nitro System",
        "url": "/EC2_Clocksource"
    }
    ,
    
    "selfservice": {
        "title": "Self-service Infrastructure",
            "author": "HeuristicWave",
            "category": "",
            "content": "ë³¸ ê¸€ì€ Kief Morrisì˜ Infrastructure as Code ì™€ HashiCorp ë°±ì„œ ë¥¼ ì½ê³  í•™ìŠµí•œ ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±í•œ ê¸€ ì…ë‹ˆë‹¤.ì„œë¬¸IaC(Infrastructure as Code)ì— ê´€ì‹¬ì„ ê°–ê³  ê³µë¶€ë¥¼ í•˜ë‹¤ë³´ë©´ Self-service Infraë¼ëŠ” ë§ì„ ìì£¼ ë§Œë‚˜ê²Œ ë©ë‹ˆë‹¤.ëª‡ ê°œì›”ì§¸ ì™€ë‹¿ì§€ ì•ŠëŠ” ê°œë…ì´ì˜€ì§€ë§Œ, ìµœê·¼ í‚¤í”„ ëª¨ë¦¬ìŠ¤ì˜ ì±…ì„ ë‹¤ì‹œ ì½ê³  ì¡°ê¸ˆì€ ì•Œê²Œ ëœ ê±° ê°™ì•„ ê·¸ë™ì•ˆ ê³µë¶€í•œ Self-service Infraì— ëŒ€í•œ ìë£Œë“¤ì„ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.Self-service Infraì— ê´€í•œ ë°°ê²½ì§€ì‹ì„ ë„“íˆëŠ” ë° ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.Dynamic Infrastructureë™ì  ì¸í”„ë¼ëŠ” ì„œë²„, ìŠ¤í† ë¦¬ì§€, ë„¤íŠ¸ì›Œí¬ì™€ ê°™ì€ ì¸í”„ë¼ ìì›ì„ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œì„ ë§í•©ë‹ˆë‹¤.ë™ì  ì¸í”„ë¼ì˜ ì¢…ë¥˜ë¡œëŠ” Public/Private í´ë¼ìš°ë“œ, ì˜¤í”ˆìŠ¤íƒì„ í™œìš©í•˜ëŠ” ì‚¬ì„¤ í´ë¼ìš°ë“œ, ë² ì–´ë©”íƒˆ ë“±ì´ ìˆìŠµë‹ˆë‹¤.ì•ì„  ì •ì˜ë§Œ ë³´ë©´ ë™ì  ì¸í”„ë¼ëŠ” í´ë¼ìš°ë“œì™€ êµ‰ì¥íˆ ìœ ì‚¬í•˜ì§€ë§Œ, í‚¤í”„ ëª¨ë¦¬ìŠ¤ëŠ” ë™ì  ì¸í”„ë¼ê°€ í´ë¼ìš°ë“œë³´ë‹¤ ë²”ìœ„ê°€ ë” ë„“ë‹¤ê³  í•©ë‹ˆë‹¤.ğŸ“£ ë™ì  ì¸í”„ë¼ë¥¼ ì†Œê°œí•˜ë©° ì•Œë ¤ë“œë¦¬ê³  ì‹¶ì€ ë¬¸ì¥ì´ ìˆìŠµë‹ˆë‹¤.í´ë¼ìš°ë“œë¡œì˜ ì „í™˜ì´ë¼ëŠ” ì˜ë¯¸ì— ëŒ€í•´ ë§ì€ ì‚¬ëŒë“¤ì´ ì—¬ëŸ¬ ì¸¡ë©´ì—ì„œ ì„¤ëª…ì„ í•˜ì§€ë§Œ,ì €ëŠ” HashiCorpì˜ Unlocking the Cloud Operating Model: Provisioningë°±ì„œì— ì†Œê°œëœ ë‹¤ìŒ í‘œí˜„ì— ì°¸ ê³µê°ì´ ê°‘ë‹ˆë‹¤.  í´ë¼ìš°ë“œë¡œì˜ ì „í™˜ì˜ ë³¸ì§ˆì ì¸ ì˜ë¯¸ëŠ” â€œì •ì â€ ì¸í”„ë¼ì—ì„œ â€œë™ì â€ ì¸í”„ë¼ë¡œì˜ ì „í™˜ì…ë‹ˆë‹¤.  The essential implications of the transition to the cloud is the shift from â€œstaticâ€ infrastructure to â€œdynamicâ€ infrastructureë™ì  ì¸í”„ë¼ í”Œë«í¼ ìš”êµ¬ ì‚¬í•­ë™ì  ì¸í”„ë¼ í”Œë«í¼ì€ ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì„±ì´ ìˆìŠµë‹ˆë‹¤.  Programmable  On-Demand  Self-ServiceğŸ’» Programmableë™ì  ì¸í”„ë¼ í”Œë«í¼ì€ í”„ë¡œê·¸ë˜ë°ì„ ì‰½ê²Œ í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ìœ ì € ì¸í„°í˜ì´ìŠ¤ ì™¸ì—ë„ ìŠ¤í¬ë¦½íŠ¸, CLIì™€ ê°™ì€ ë„êµ¬ë“¤ê³¼ë„ ìƒí˜¸ ì‘ìš© í•  ìˆ˜ ìˆë„ë¡ í”„ë¡œê·¸ë˜ë° APIê°€ í•„ìš”í•©ë‹ˆë‹¤.ì•„ë˜ ê° í”Œë«í¼ ë³„ SDKë¥¼ ì‚¬ìš©í•˜ë©´ í´ë¼ìš°ë“œ ë‚´ ìì›ì„ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  AWS SDK  Azure SDK  GCP SDK  Openstack SDKâ° On-Demandë™ì  ì¸í”„ë¼ í”Œë«í¼ì—ì„œ ìì›ì„ ì¦‰ì‹œ ìƒì„±í•˜ê³  ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.ë˜í•œ ì „í†µì ì¸ ì¸í”„ë¼ì˜ ê³¼ê¸ˆ ì •ì±…ì´ ì¼ì • ê¸°ê°„ ë™ì•ˆì˜ ê³„ì•½ì„ ê¸°ë°˜ìœ¼ë¡œ í•œë‹¤ë©´, ë™ì  ì¸í”„ë¼ì—ì„œëŠ” ì‹œê°„ë‹¹ ê³¼ê¸ˆ ì²´ê³„ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.ğŸŠ ë“œë””ì–´ ëŒ€ë§ì˜ ì…€í”„ ì„œë¹„ìŠ¤ê°€ ì²˜ìŒ ì†Œê°œ ë©ë‹ˆë‹¤!ğŸƒğŸ» Self-Serviceì…€í”„ì„œë¹„ìŠ¤ëŠ” ì˜¨ë””ë§¨ë“œ ìš”êµ¬ ì‚¬í•­ì„ ì¢€ ë” ë°œì „ì‹œí‚¨ ê°œë…ì…ë‹ˆë‹¤. ì „í†µì ì¸ ë°©ë²•ì—ì„œ ì¸í”„ë¼ë¥¼ ìš”êµ¬í•˜ê¸° ìœ„í•´ì„œëŠ” ì„¸ë¶€ ìš”ì²­ ì–‘ì‹, ì„¤ê³„ ë° ëª…ì„¸ ë¬¸ì„œ, êµ¬í˜„ ê³„íš ìˆ˜ë¦½ ë“±ì„ í•„ìš”ë¡œ í–ˆìŠµë‹ˆë‹¤.ì…€í”„ì„œë¹„ìŠ¤ëŠ” ì „í†µì ì¸ ë°©ë²•ì—ì„œ ë” ì§„í™”í•˜ì—¬ í•„ìš”í•œ ì¸í”„ë¼ë¥¼ ì¦‰ì‹œ í”„ë¡œë¹„ì €ë‹í•˜ê³  ì‰½ê²Œ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” ìë™í™”ëœ ì ˆì°¨ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.ğŸ›  ì…€í”„ ì„œë¹„ìŠ¤ëŠ” ì¸í”„ë¼ í…œí”Œë¦¿ì„ ìš´ìš©í•  ìˆ˜ ìˆëŠ” IaC ë„êµ¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬í˜„í•©ë‹ˆë‹¤.ì˜ˆë¥¼ ë“¤ì–´ ê°œë°œìê°€ ë¡œë“œë°¸ëŸ°ì„œë¡œ ALBë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ê°€ NLBë¡œ ë°”ê¾¸ê³  ì‹¶ì€ ê²½ìš°, ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ëœ ì¸í”„ë¼ ì½”ë“œë¥¼ ì¬ë°°í¬ í•˜ë©´ ë©ë‹ˆë‹¤.resource \"aws_lb\" \"test\" {  name               = \"test-lb-tf\"  internal           = false    # load_balancer_type = \"application\"  load_balancer_type = \"network\"    # Leave out other config ...}HashiCorpê°€ ì •ì˜í•œ Self-Service Infrastructure ê²Œì‹œë¬¼ì„ ë³´ë©´,Self-Service Infraê°€ ì–´ë–¤ ì˜ë¯¸ì¸ì§€ ë” ì‰½ê²Œ ë‹¤ê°€ì˜µë‹ˆë‹¤. (ì²¨ë¶€ëœ ë§í¬ë¥¼ í†µí•´ ì…€í”„ì„œë¹„ìŠ¤ì˜ ì¥ì ì„ ê¼­ í•œë²ˆ ì½ì–´ë³´ì„¸ìš”!)ê¸°ì¡´ ë°©ë²•ê°œë°œìëŠ” ì¸í”„ë¼ ë‹´ë‹¹ìê°€ ì¸í”„ë¼ë¥¼ í• ë‹¹í•  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•©ë‹ˆë‹¤.ì…€í”„ ì„œë¹„ìŠ¤ ì ìš©ì‘ì„±ëœ ì¸í”„ë¼ í…œí”Œë¦¿ì„ í™œìš©í•´ ì˜¨ë””ë§¨ë“œë¡œ í”„ë¡œë¹„ì €ë‹ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.ê¸€ì„ ë§ˆì¹˜ë©°ì €ëŠ” í…Œë¼í¼ì„ ê³µë¶€í•œ ì´í›„, ê°„ë‹¨í•œ ì›¹ì„œë¹„ìŠ¤ë¥¼ ìš´ì˜í•˜ëŠ” í† ì´í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•  ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ì¸í”„ë¼ í™˜ê²½ì„ ìì£¼ ì‚¬ìš©í•©ë‹ˆë‹¤.ë¯¸ë¦¬ ì½”ë“œë¡œ ì •ì˜í•œ ì¸í”„ë¼ ë•ë¶„ì— ê°œë°œì—ë§Œ ì§‘ì¤‘í•  ìˆ˜ ìˆëŠ” í™˜ê²½ê³¼ ìƒì‚°ì„± í–¥ìƒì„ ê²½í—˜í–ˆìŠµë‹ˆë‹¤.ë˜í•œ í…Œë¼í¼ ëª¨ë“ˆ ë•ë¶„ì— ì œê°€ ì›í•˜ëŠ” ëŒ€ë¡œ ì¸í”„ë¼ ìŠ¤í™ì„ ë³€ê²½í•˜ê³  ê°ì¢… í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ ì¶”ê°€ í˜¹ì€ ì œê±°ê°€ ê°€ëŠ¥í–ˆìŠµë‹ˆë‹¤.ì…€í”„ì„œë¹„ìŠ¤ ì¸í”„ë¼ê°€ ê¸°ì¡´ ìŠ¹ì¸ ì²´ê³„(ë¦¬ì†ŒìŠ¤ ìš”ì²­ â¡ï¸ ë‹´ë‹¹ì ìŠ¹ì¸)ë¥¼ ë¶€ì •í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë¼ê³  ìƒê°í•©ë‹ˆë‹¤.ê¸°ì¡´ ì²´ê³„ê°€ ê°–ê³  ìˆëŠ” ë³´ì•ˆì  ì´ì ì„ í¬í•¨í•œ ì¥ì ë“¤ì„ ìœ ì§€í•˜ë©°, ìœ ì—°í•˜ê³  ì‹ ì†í•˜ê²Œ ì¸í”„ë¼ë¥¼ ìš´ìš©í•˜ëŠ” Self-service í™˜ê²½ì´ ë¶ˆëŸ¬ì˜¬ ì¥ì ì„ ê³ ë¯¼í•´ ë´ì•¼ê² ìŠµë‹ˆë‹¤.ë§ˆì§€ë§‰ìœ¼ë¡œ, DevOps ë¬¸í™”ê°€ ì •ì°©í•´ê°€ë©° CI/CD ë¥¼ í†µí•´ ì§€ì†ì  ë°°í¬ê°€ ê°€ëŠ¥í•´ì§€ë©° ë” ì¦ì€ ì„œë¹„ìŠ¤ ì¶œì‹œê°€ ê°€ëŠ¥í•´ì¡ŒìŠµë‹ˆë‹¤.ë˜í•œ, IaCë¥¼ í†µí•´ Immutable Infraë¥¼ ì¶”êµ¬í•˜ë©° ì¸í”„ë¼ì˜ ì¼ê´€ì„±ê³¼ ì•ˆì •ì„±ì„ ë³´ì¥í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.ì•ì„  ë‘ ê°œì˜ ê°œë…ì— ë”í•´ Self-serviceë¥¼ ì¶”êµ¬í•œë‹¤ë©´ ì¡°ì§ì˜ ë¯¼ì²©ì„±ê³¼ ìƒì‚°ì„± í–¥ìƒì— ë„ì›€ì´ ë  ê²ƒì´ë¼ê³  ìƒê°í•©ë‹ˆë‹¤.ì†Œì¤‘í•œ ì‹œê°„ì„ ë‚´ì–´ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ì˜ëª»ëœ ë‚´ìš©ì€ ì§€ì í•´ì£¼ì„¸ìš”! ğŸ˜ƒ",
        "url": "/SelfService"
    }
    ,
    
    "packer": {
        "title": "Provision Infrastructure with Packer",
            "author": "HeuristicWave",
            "category": "",
            "content": "ë³¸ ê¸€ì€ HashiCorp Learn - Provision Infrastructure with Packer ì—ì„œ ë‹¤ë£¨ëŠ” ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±í•œ ê¸€ ì…ë‹ˆë‹¤.  Packerë¥¼ ì‚¬ìš©í•´ AWS AMIë¥¼ ë§Œë“¤ê³  Terraformê³¼ ì—°ê³„í•˜ì—¬ í™œìš©í•˜ëŠ” ë°©ë²•ì— ì•½ê°„ì˜ ì„¤ëª…ê³¼ íŒì„ ë‹´ì•„ í•œêµ­ì–´ë¡œ ì¬ì‘ì„±í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. (ì„¤ì¹˜ì™€ ê´€ë ¨ëœ ì¤€ë¹„ì‚¬í•­ì€ ìƒëµë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì›ë¬¸ì„ í™•ì¸í•´ì£¼ì„¸ìš”.)í”„ë¡œì íŠ¸ êµ¬ì¡°ë¨¼ì €, í•´ë‹¹ íŠœí† ë¦¬ì–¼ì„ ì§„í–‰í•˜ê¸° ìœ„í•œ í”„ë¡œì íŠ¸ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. ì•„ë˜ì™€ í´ë”ì™€ íŒŒì¼ì„ ì¤€ë¹„í•´ì£¼ì„¸ìš”..â””â”€â”€ provision-infra-with-packer    â”œâ”€â”€ images    â”‚   â””â”€â”€ image.pkr.hcl    â”œâ”€â”€ instances    â”‚   â”œâ”€â”€ main.tf    â”‚   â””â”€â”€ variables.tf    â””â”€â”€ scripts        â””â”€â”€ setup.shLocal SSH key ìƒì„±í•˜ê¸°provision-infra-with-packer í´ë” ì•ˆì—ì„œ AWS AMIë¡œ ë§Œë“¤ ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•˜ê¸° ìœ„í•œ SSH í‚¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.í•„ìëŠ” ì‚¬ìš©í•  ê³µê°œí‚¤ë¥¼ Mac OSì—ì„œ ssh-keygenìœ¼ë¡œ ìƒì„±í•˜ì˜€ìŠµë‹ˆë‹¤. ê°ì í™˜ê²½ì— ë§ëŠ” ë°©ë²•ìœ¼ë¡œ SSH ê³µê°œí‚¤ë¥¼ ìƒì„±í•˜ì„¸ìš”.ì•”í˜¸í™” íƒ€ì…(-t)ì„ RSAë¡œ ì£¼ì„(-C)ì„ ì´ë©”ì¼ë¡œ ìƒì„±ë˜ëŠ” ê³µê°œí‚¤ì˜ ìœ„ì¹˜(-f)ë¥¼ í˜„ì¬ directoryë¡œ ì„¤ì •í•˜ê³  ê³µê°œí‚¤ì˜ ì´ë¦„ì„ tf-packerë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ê³  ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ë©´ ë˜ì§€ë§Œ í¸ì˜ìƒ ê³µë°±ìœ¼ë¡œ ë‘ê² ìŠµë‹ˆë‹¤.$ ssh-keygen -t rsa -C \"your_email@example.com\" -f ./tf-packerì´í›„ tf-packerì™€ tf-packer.pub 2ê°€ì§€ íŒŒì¼ì´ ìƒì„±ë˜ì—ˆë‹¤ë©´ ë‹¤ìŒ ë‹¨ê³„ ğŸš€Packer ì½”ë“œ ì‘ì„±í•˜ê¸°image.pkr.hcl íŒŒì¼ì—ì„œ ì§„í–‰í•©ë‹ˆë‹¤. 1ï¸âƒ£ AMI êµ¬ì¶•ì— í•„ìš”í•œ config ì‘ì„±packerê°€ ë¹Œë“œí•œ ì´ë¯¸ì§€ê°€ ì €ì¥ë  ë¦¬ì „ì˜ ì •ë³´ì™€ AMIì— timestamp ì •ë³´ë¥¼ ë„£ê¸° ìœ„í•œ configë¥¼ ì°¨ë¡€ë¡œ ì‘ì„±í•©ë‹ˆë‹¤.variable \"region\" {  type    = string  default = \"us-east-1\"}locals { timestamp = regex_replace(timestamp(), \"[- TZ:]\", \"\") }2ï¸âƒ£ï¸ Base AMIì— ëŒ€í•œ Source AMI config ì‘ì„±packerê°€ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” Base AMIì— ëŒ€í•œ ì •ë³´ë¥¼ source ë¸”ë¡ì— ì •ì˜í•©ë‹ˆë‹¤.1ë‹¨ê³„ì—ì„œ ì‘ì„±í•œ config ê°’ì„ í™œìš©í•´ ë¦¬ì „ê³¼ timestampë¥¼ ë„£ì–´ì£¼ëŠ” ì½”ë“œì™€ Packer Builderë¡œ ì‚¬ìš©í•  ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…ì„ ì§€ì •í•©ë‹ˆë‹¤.ì´í›„, AWSì— ì¡´ì¬í•˜ëŠ” ìˆ˜ë§ì€ AMI ì¤‘ì—ì„œ sourceë¡œ í™œìš©í•  ì´ë¯¸ì§€ë¥¼ filter ì½”ë“œë¡œ ì‘ì„±í•©ë‹ˆë‹¤.(name ë¶€ë¶„ì— ì§ì ‘ ami ë²ˆí˜¸ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ê¸°ì¬ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.)source \"amazon-ebs\" \"example\" {  ami_name      = \"learn-terraform-packer-${local.timestamp}\"  instance_type = \"t2.micro\"  region        = var.region  source_ami_filter {    filters = {      name                = \"ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*\"      root-device-type    = \"ebs\"      virtualization-type = \"hvm\"    }    most_recent = true    owners      = [\"099720109477\"]  }  ssh_username = \"ubuntu\"}3ï¸âƒ£ Packer build config ì‘ì„±build ë¶€ë¶„ì—ì„œëŠ” í™˜ê²½ë³€ìˆ˜ ì„¸íŒ…ì´ë‚˜ ëª…ë ¹ì–´ë¥¼ inline í˜•íƒœë¡œ ê¸°ì… í•  ìˆ˜ ìˆì§€ë§Œ,ì•„ë˜ì™€ ê°™ì€ ê°„ë‹¨í•œ ê¸°ëŠ¥ë§Œ ìˆ˜í–‰í•˜ë„ë¡ ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. hcl ë¬¸ë²•ì— ë”°ë¼ sourceë¥¼ ì§€ì •í•˜ê³ , í”„ë¡œë¹„ì €ë‹ì„ ìœ„í•œ ê³µê°œí‚¤ì˜ ìœ„ì¹˜ë¥¼ ëª…ì„¸í•©ë‹ˆë‹¤. sourceëŠ” ë¡œì»¬ ë¨¸ì‹ , destinationì€ ì›ê²© ë¨¸ì‹  ì…ë‹ˆë‹¤.ë§ˆì§€ë§‰ìœ¼ë¡œ Packerë¡œ ë¹Œë“œí•œ ì´ë¯¸ì§€ì—ì„œ Application Setupì´ ë‹´ê¸´ scriptë¥¼ ì§€ì •í•©ë‹ˆë‹¤.build {  sources = [\"source.amazon-ebs.example\"]  provisioner \"file\" {    source      = \"../tf-packer.pub\"    destination = \"/tmp/tf-packer.pub\"  }  provisioner \"shell\" {    script = \"../scripts/setup.sh\"  }}4ï¸âƒ£ Shell script ì‘ì„±í•´ë‹¹ ì‘ì—…ì€ scripts í´ë”ì˜ setup.shì—ì„œ ì§„í–‰í•©ë‹ˆë‹¤. ì´ ë¶€ë¶„ì€ Terraformìœ¼ë¡œ í”„ë¡œë¹„ì €ë‹ í•œ ì¸í”„ë¼ë¥¼ ì›¹í˜ì´ì§€ì—ì„œ í™•ì¸í•˜ê¸° ìœ„í•´ ê°„ë‹¨í•œ ìƒ˜í”Œì„ ë„ìš°ëŠ” ì½”ë“œê°€ ë‹´ê²¨ìˆìŠµë‹ˆë‹¤.ì•„ë˜ Scriptì— í•„ìš”í•œ ì¢…ì†ì„± ì„¤ì¹˜, terraformì„ userì— ì¶”ê°€, ìƒì„±í•œ SSHí‚¤ ì„¤ì¹˜, ìƒ˜í”Œ Go App ì„¤ì¹˜ê°€ ë‹¨ê³„ê°€ ì‘ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.  #!/bin/bashset -e# Install necessary dependenciessudo DEBIAN_FRONTEND=noninteractive apt-get -y -o Dpkg::Options::=&quot;--force-confdef&quot; -o Dpkg::Options::=&quot;--force-confold&quot; dist-upgradesudo apt-get -y -qq install curl wget git vim apt-transport-https ca-certificatessudo add-apt-repository ppa:longsleep/golang-backports -ysudo apt -y -qq install golang-go# Setup sudo to allow no-password sudo for &quot;hashicorp&quot; group and adding &quot;terraform&quot; usersudo groupadd -r hashicorpsudo useradd -m -s /bin/bash terraformsudo usermod -a -G hashicorp terraformsudo cp /etc/sudoers /etc/sudoers.origecho &quot;terraform ALL=(ALL) NOPASSWD:ALL&quot; | sudo tee /etc/sudoers.d/terraform# Installing SSH keysudo mkdir -p /home/terraform/.sshsudo chmod 700 /home/terraform/.sshsudo cp /tmp/tf-packer.pub /home/terraform/.ssh/authorized_keyssudo chmod 600 /home/terraform/.ssh/authorized_keyssudo chown -R terraform /home/terraform/.sshsudo usermod --shell /bin/bash terraform# Create GOPATH for Terraform user &amp; download the webapp from GitHubsudo -H -i -u terraform -- env bash &lt;&lt; EOFwhoamiecho ~terraformcd /home/terraformexport GOROOT=/usr/lib/goexport GOPATH=/home/terraform/goexport PATH=$PATH:$GOROOT/bin:$GOPATH/bingo get -d github.com/hashicorp/learn-go-webapp-demoEOF1 ~ 4ë‹¨ê³„ë¥¼ ë§ˆì³¤ë‹¤ë©´ images í´ë” ìœ„ì¹˜ì— packer build image.pkr.hcl ëª…ë ¹ì–´ë¡œ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•©ë‹ˆë‹¤.ì´ë¯¸ì§€ ë¹Œë“œ í›„, ì½˜ì†” Images íƒ­ì˜ AMIsì„ í™•ì¸í•˜ë©´ ë¹Œë“œí•œ ì´ë¯¸ì§€ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.ë˜í•œ, ì¸ìŠ¤í„´ìŠ¤ íƒ­ì„ í™•ì¸í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ Base AMIë¥¼ ë§Œë“¤ê¸° ìœ„í•œ Packer Builderì˜ í”ì ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.í•´ë‹¹ í™”ë©´ì˜ Instance IDë¥¼ ëˆŒëŸ¬ ì„¤ì •ë“¤ì„ í™•ì¸í•´ë³´ë©´ source ë¸”ë¡ì— ì •ì˜í•œ ê°’ì„ ë°”íƒ•ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.Terraformìœ¼ë¡œ Packer ì´ë¯¸ì§€ ë°°í¬í•´ë‹¹ ì‘ì—…ì€ instances í´ë”ì—ì„œ ì§„í–‰í•©ë‹ˆë‹¤. Sample App Infra Code ì‘ì„±í•˜ê¸°ì•„ë˜ ğŸ›  ì´ëª¨í‹°ì½˜ì„ í´ë¦­í•˜ì—¬ main.tfì™€ varaiables.tfë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.  ğŸ”¨ main.tf ğŸ”¨    terraform {  required_providers {    aws = {      source  = \"hashicorp/aws\"      version = \"~&gt; 3.26.0\"    }  }  required_version = \"~&gt; 1.0.2\"}provider \"aws\" {  region = var.region}resource \"aws_vpc\" \"vpc\" {  cidr_block           = var.cidr_vpc  enable_dns_support   = true  enable_dns_hostnames = true}resource \"aws_internet_gateway\" \"igw\" {  vpc_id = aws_vpc.vpc.id}resource \"aws_subnet\" \"subnet_public\" {  vpc_id     = aws_vpc.vpc.id  cidr_block = var.cidr_subnet}resource \"aws_route_table\" \"rtb_public\" {  vpc_id = aws_vpc.vpc.id  route {    cidr_block = \"0.0.0.0/0\"    gateway_id = aws_internet_gateway.igw.id  }}resource \"aws_route_table_association\" \"rta_subnet_public\" {  subnet_id      = aws_subnet.subnet_public.id  route_table_id = aws_route_table.rtb_public.id}resource \"aws_security_group\" \"sg_22_80\" {  name   = \"sg_22\"  vpc_id = aws_vpc.vpc.id  # SSH access from the VPC  ingress {    from_port   = 22    to_port     = 22    protocol    = \"tcp\"    cidr_blocks = [\"0.0.0.0/0\"]  }  ingress {    from_port   = 8080    to_port     = 8080    protocol    = \"tcp\"    cidr_blocks = [\"0.0.0.0/0\"]  }  ingress {    from_port   = 80    to_port     = 80    protocol    = \"tcp\"    cidr_blocks = [\"0.0.0.0/0\"]  }  egress {    from_port   = 0    to_port     = 0    protocol    = \"-1\"    cidr_blocks = [\"0.0.0.0/0\"]  }}resource \"aws_instance\" \"web\" {  ami                         = \"ami-YOUR-AMI-ID\"  instance_type               = \"t2.micro\"  subnet_id                   = aws_subnet.subnet_public.id  vpc_security_group_ids      = [aws_security_group.sg_22_80.id]  associate_public_ip_address = true  tags = {    Name = \"Learn-Packer\"  }}output \"public_ip\" {  value = aws_instance.web.public_ip}    ğŸ”§ varaiables.tf ğŸ”§    variable \"cidr_vpc\" {  description = \"CIDR block for the VPC\"  default     = \"10.1.0.0/16\"}variable \"cidr_subnet\" {  description = \"CIDR block for the subnet\"  default     = \"10.1.0.0/24\"}variable \"environment_tag\" {  description = \"Environment tag\"  default     = \"Learn\"}variable \"region\"{  description = \"The region Terraform deploys your instance\"  default     = \"us-east-1\"}    ì¸í”„ë¼ ì½”ë“œì— ëŒ€í•œ ì„¤ëª…ì€ ìƒëµí•˜ê² ìŠµë‹ˆë‹¤. ì¸í”„ë¼ì— ëŒ€í•œ í…Œë¼í¼ ì½”ë“œê°€ ê¶ê¸ˆí•˜ì‹œë‹¤ë©´ ë‹¤ë¥¸ ê²Œì‹œê¸€ì´ë‚˜ ì œ í¬ìŠ¤íŒ…ì„ ì½ì–´ë³´ì„¸ìš”!AMI Query í•˜ê¸°ë³¸ë¬¸ì—ëŠ” ì†Œê°œë˜ì§€ ì•Šì•˜ì§€ë§Œ, Packerì™€ Terraformì˜ í†µí•©ì„ ìœ„í•´ í•„ìê°€ ì‘ì„±í•œ ë¶€ë¶„ì…ë‹ˆë‹¤.Terraformì˜ Data Sourcesë¥¼ í™œìš©í•´ ë¹Œë“œëœ AMIë¥¼ Queryí•˜ì—¬ ìƒ˜í”Œ ì•±ì„ í”„ë¡œë¹„ì €ë‹ í•´ë´…ì‹œë‹¤.ì„ í–‰ ì‘ì—…ì—ì„œ ì§„í–‰í•œ main.tf í•˜ë‹¨ì— ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.data \"aws_ami_ids\" \"myami\" {  owners = [\"YOUR Account ID\"]  # sort_ascending = true    filter {    name   = \"name\"    values = [\"learn-terraform-packer-*\"]  }}Packerë¡œ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí–ˆìœ¼ë¯€ë¡œ, ami ownerê°€ ë˜ì—ˆìŠµë‹ˆë‹¤!owners ë¶€ë¶„ì— ìì‹ ì˜ ê³„ì • IDë¥¼ ì‘ì„±í•˜ê³  filterì— packer buildë¥¼ í•  ë–„ ì‚¬ìš©í•œ ami_nameì„ value ê°’ìœ¼ë¡œ ë„£ìŠµë‹ˆë‹¤.  sort_ascending default ê°’ì´ false  sort_ascending = false : listì˜ 0ë²ˆì§¸ ìš”ì†Œê°€ latest sort_ascending = true : ë§Œë“¤ì–´ì§„ ìˆœì„œëŒ€ë¡œ ë¦¬ìŠ¤íŠ¸ ìƒì„± (ê°€ì¥ ë¨¼ì € ìƒì„±ëœ amiê°€ 0ë²ˆ)ì´ì–´ì„œ main.tfì— ì¸ìŠ¤í„´ìŠ¤ ë¦¬ì†ŒìŠ¤ë¥¼ ì •ì˜í•œ ë¶€ë¶„ì˜ ami = \"ami-YOUR-AMI-ID\" ì½”ë“œë¥¼ ì•„ë˜ì™€ ê°™ì´ ëŒ€ì²´í•©ë‹ˆë‹¤.data ê°ì²´ì— í•„í„°ë§í•œ ê²°ê³¼ ê°’ë“¤ì´ ë¹Œë“œëœ AMIë“¤ì´ ë¦¬ìŠ¤íŠ¸ í˜•ì‹ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ”ë° latest ë²„ì „ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ 0ë²ˆì§¸ ì´ë¯¸ì§€ë¥¼ ëª…ì‹œí•©ë‹ˆë‹¤.í¸ì˜ìƒ ì‚¬ìš©ëœ ami ë²ˆí˜¸ë¥¼ í„°ë¯¸ë„ì—ì„œ í™•ì¸ í•  ìˆ˜ ìˆë„ë¡ outputì— ëŒ€í•œ ì½”ë“œë„ í•¨ê»˜ ì‘ì„±í•©ë‹ˆë‹¤.resource \"aws_instance\" \"web\" {  ami = data.aws_ami_ids.myami.ids[0]   # \"ami-YOUR-AMI-ID\"  # Skip Other Config}output \"my_ami\" {  value = aws_instance.web.ami}ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  í…Œë¼í¼ ì½”ë“œê°€ ìœ„ì¹˜í•œ í´ë”ì—ì„œ(instances í´ë” í•˜ìœ„) ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.terraform init &amp;&amp; terraform apply ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ yesë¥¼ ê¸°ì…í•©ë‹ˆë‹¤. ëª…ë ¹ì–´ë¡œ ì¸í”„ë¼ ìƒíƒœë¥¼ ì ê²€í•´ ì•„ë˜ì™€ ê°™ë‹¤ë©´ ë‹¤ìŒ ë‹¨ê³„ë¡œ ğŸš€$ terraform state listdata.aws_ami_ids.myamiaws_instance.webaws_internet_gateway.igwaws_route_table.rtb_publicaws_route_table_association.rta_subnet_publicaws_security_group.sg_22_80aws_subnet.subnet_publicaws_vpc.vpc  data objectì— ë‹´ê¸´ ì •ë³´ê°€ í™•ì¸í•˜ê³  ì‹¶ë‹¤ë©´? $ terraform state show data.aws_ami_ids.myami.idsì¸ìŠ¤í„´ìŠ¤ í™•ì¸í•˜ê¸°SSHë¥¼ í†µí•´ ì¸ìŠ¤í„´ìŠ¤ì— ì—°ê²°í•©ë‹ˆë‹¤. ssh terraform@$(terraform output -raw public_ip) -i ../tf-packerGo ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•˜ì„¸ìš”. cd go/src/github.com/hashicorp/learn-go-webapp-demoë°ëª¨ ì•±ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. go run webapp.goë°°í¬í•œ ì•± í™•ì¸ì„ ìœ„í•´ terraform output public_ipë¡œ ì–»ì€ IPì— 8080 í¬íŠ¸ë¡œ ì ‘ì†í•˜ë©´ ê°„ë‹¨í•œ í…ŒíŠ¸ë¦¬ìŠ¤ ê²Œì„ ì•±ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.ì¸ìŠ¤í„´ìŠ¤ ë¦¬ì†ŒìŠ¤ íšŒìˆ˜terraform destroy ëª…ë ¹ì–´ë¡œ ìƒê¸° í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•œ ì¸í”„ë¼ë¥¼ ë¦¬ì†ŒìŠ¤ë¥¼ íšŒìˆ˜í•©ë‹ˆë‹¤. Packerë¡œ ì‘ì„±í•œ ì´ë¯¸ì§€ëŠ” íŒŒê´´ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.ìœ„ì™€ ê°™ì€ ë‹¨ê³„ë“¤ì„ í†µí•´ íŒ¨ì»¤ë¡œ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ê³  í…Œë¼í¼ê³¼ í†µí•©í•˜ëŠ” ë°©ë²•ì„ í•™ìŠµí•´ë³´ì•˜ìŠµë‹ˆë‹¤.ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ ë‹¤ë¤˜ë˜ ë‚´ìš©ì€ Immutable Serversë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•œ ë°©ë²• ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.ì˜¤ëŠ˜ í¬ìŠ¤íŒ…ì— ì¶”ê°€ë¡œ Ansibleì„ í†µí•©í•œë‹¤ë©´, Immutable Infrastructureë¥¼ êµ¬ì¶•í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.Terraform Courses    3-Tier VPC Architecture with Terraform    ECR Pipeline with Terraform â…  (CodeCommit)    ECR Pipeline with Terraform â…¡ (ECR, CodeBuild, IAM)    ECR Pipeline with Terraform â…¢ (CodePipeline)    Provision Infrastructure with Packer",
        "url": "/Packer"
    }
    ,
    
    "eks-max-pods": {
        "title": "Look into EKS max pods",
            "author": "HeuristicWave",
            "category": "",
            "content": "EKS ë…¸ë“œì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ Podì˜ ê°œìˆ˜ëŠ” ëª‡ ê°œì¼ê¹Œ?Previewì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” EKSì˜ ë…¸ë“œ ê·¸ë£¹ì—ì„œëŠ” ìµœëŒ€ ëª‡ ê°œì˜ í¬ë“œ(Private IP)ê°€ í• ë‹¹ ê°€ëŠ¥í•˜ê³  ì–´ë– í•œ ë°©ë²•ìœ¼ë¡œ ìµœëŒ€ í¬ë“œì˜ ê°œìˆ˜ë¥¼ ì œì–´í•  ìˆ˜ ìˆëŠ”ì§€ ì•Œì•„ë³´ì.Build Upì¿ ë²„ë„¤í‹°ìŠ¤ ë„ê·œë¨¼íŠ¸ ì— ë”°ë¥´ë©´ ë…¸ë“œë‹¹ 110ê°œì˜ í¬ë“œë¥¼ ìƒì„±í•  ìˆ˜ ìˆìœ¼ë©°, ë…¸ë“œëŠ” 5000ê°œê¹Œì§€ ìƒì„± ê°€ëŠ¥í•´ ì´ 15ë§Œ ê°œì˜ í¬ë“œê°€ ìƒì„± ê°€ëŠ¥í•˜ë‹¤ê³  í•œë‹¤. GCPì˜ GKE ê°€ì´ë“œ ì— ë”°ë¥´ë©´ ê¸°ë³¸ í´ëŸ¬ìŠ¤í„° ë…¸ë“œ í•˜ë‚˜ì— ìµœëŒ€ 110ê°œì˜ í¬ë“œê°€ ìƒì„± ê°€ëŠ¥í•˜ë‹¤ê³  í•œë‹¤. êµ¬ê¸€ë§ì„ í†µí•´ í™•ì¸í•˜ë‹ˆ, ë…¸ë“œì—ì„œ í¬ë“œì˜ ê°¯ìˆ˜ê°€ ì¦ê°€í• ìˆ˜ë¡ kubelet, cAdvisor ë“±ê³¼ ê°™ì€ K8s ì—ì´ì „íŠ¸ì— ì˜¤ë²„í—¤ë“œë¥¼ ë°œìƒì‹œí‚¤ë¯€ë¡œ 110ê°œ ì •ë„ë¥¼ ê¶Œì¥í•œë‹¤ê³  í•œë‹¤.ê·¸ë˜ì„œ ê·¸ëŸ°ì§€ kubelet docs ì—ì„œë„ ì•„ë˜ì™€ ê°™ì€ max-podsê°€ 110ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ê°€ì§„ë‹¤.--max-pods int32     Default: 110EKS eni max podsIP addresses per network interface per instance type ì„ í™•ì¸í•´ë³´ë©´ AWSì˜ ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…ë³„ ENI ê°œìˆ˜ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.EKS ì„¤ëª…ì„œ ë¥¼ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê³µì‹ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. (# of network interfaces for the instance type Ã— (# of IPv4 per network interface - 1)) + 2ENIì˜ ì²« ë²ˆì§¸ IPëŠ” í¬ë“œê°€ ì‚¬ìš©í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ 1ì„ ë¹¼ê³  AWS CNIì™€ kube-proxyê°€ ì°¨ì§€í•˜ëŠ” 2ê°œì˜ IPë¥¼ ë§ˆì§€ë§‰ ìˆ˜ì‹ì— ë”í•´ ìµœì¢… ì‚¬ìš© ê°€ëŠ¥í•œ max-pod ê°’ì„ ì•Œ ìˆ˜ ìˆë‹¤. ì„¤ëª…í•œ ê³µì‹ ì´ì™¸ì—ë„ kubectl ëª…ë ¹ì–´ë¥¼ í†µí•´ Maximum Podsë¥¼ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.â¯ kubectl get nodes -ANAME                                            STATUS   ROLES    AGE   VERSIONip-10-0-0-178.ap-northeast-2.compute.internal   Ready    &lt;none&gt;   18h   v1.19.6-eks-49a6c0ip-10-0-1-143.ap-northeast-2.compute.internal   Ready    &lt;none&gt;   18h   v1.19.6-eks-49a6c0â¯ kubectl describe nodes ip-10-0-0-178.ap-northeast-2.compute.internal | grep -i pods  pods:                        17  pods:                        17Non-terminated Pods:          (17 in total)ğŸ‘€ Labs 1kubectlì˜ ëª…ë ¹ì–´ì—ì„œ ë…¸ë“œ(t3.medium)ë‹¹ 17ê°œì˜ í¬ë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ê³  í–ˆëŠ”ë°, ì§ì ‘ ë…¸ë“œê·¸ë£¹ ë‚´ì—ì„œ í¬ë“œë¥¼ ìµœëŒ€ë¡œ ë„ì›Œ í™•ì¸í•´ë³´ì. ë…¸ë“œê·¸ë£¹ ë‚´ì— nginx 32ê°œë¥¼ ì˜¬ë ¤ë³´ì•˜ë‹¤.K9s ì‰˜ì„ í†µí•´ ì´ 38ê°œì˜ í¬ë“œê°€ í™•ì¸ë˜ì—ˆê³  38ê°œ ì¤‘ aws-node, coredns, kube-proxyê°€ ê°ê° 2ê°œì˜ ë…¸ë“œì— ìœ„ì¹˜í•˜ê³  4ê°œì˜ nginx í¬ë“œê°€ Pending ìƒíƒœë¼ëŠ” ê²ƒì„ íŒŒì•…í–ˆë‹¤.ì¦‰, 38(Total) - 4(Pending) = 17(t3.medium Maximum Pods) * 2(# of Node) ì‹¤í—˜ ê²°ê³¼ì™€ ì•ì„œ ì•Œì•„ë³¸ Maximum Podsê°€ ë™ì¼í•˜ë‹¤.Maximum Pods ë³€ê²½í•˜ê¸°EKSì—ì„œ Maximum Podsë¥¼ ê²°ì • ì§“ëŠ” ìš”ì†ŒëŠ” ENIë‹¤. ê·¸ëŸ¬ë‚˜ í´ëŸ¬ìŠ¤í„°ì˜ ë…¸ë“œê·¸ë£¹ì„ ìƒì„±í•  ë•Œ kubeletì˜ max-pods ê°’ì„ ë³€ê²½í•´ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•  ìˆ˜ ìˆë‹¤. AWS Docs ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ (ë¶ˆì¹œì ˆí•œ?) ì„¤ëª…ì„ í†µí•´ ENIì™€ ë³„ê°œë¡œ max-podsë¥¼ ì œì–´í•  ìˆ˜ ìˆëŠ” íŒíŠ¸ë¥¼ ì–»ì—ˆë‹¤.ê³µì‹ ë¬¸ì„œì—ì„œ ì„¤ëª…ì´ êµ‰ì¥íˆ ë¹ˆì•½í•˜ì§€ë§Œ, EKSì—ì„œ ë…¸ë“œ ê·¸ë£¹ì„ ì»¤ìŠ¤í…€ìœ¼ë¡œ ìƒì„±í•  ë•Œ Launch templatesì˜ UserDataë¥¼ ì•„ë˜ì™€ ê°™ì´ ì •ì˜í•˜ë©´ Maximum Podsê°€ ë³€ê²½ëœë‹¤.MIME-Version: 1.0Content-Type: multipart/mixed; boundary=\"==MYBOUNDARY==\"--==MYBOUNDARY==Content-Type: text/x-shellscript; charset=\"us-ascii\"#!/bin/bash/etc/eks/bootstrap.sh {Cluster Name} --use-max-pods false --kubelet-extra-args '--max-pods=10'--==MYBOUNDARY==--\\  GCPì—ì„œ Max Podsë¥¼ ì œì–´í•˜ëŠ” ë°©ë²• ğŸ‘ˆ Click!   GCPì—ì„œëŠ” í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•  ë•Œì•„ë˜ ëª…ë ¹ì–´ì˜ --default-max-pods-per-node íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ max-pods(ğŸ‘† Build Up ë‹¨ê³„ì—ì„œ default 110 ğŸ‘†)ë¥¼ ì¡°ì ˆí•  ìˆ˜ ìˆë‹¤.  gcloud container clusters create CLUSTER_NAME \\  # ìƒëµ  --default-max-pods-per-node MAXIMUM_PODS \\  # ìƒëµ  ğŸ‘€ Labs 2ì•„ë˜ ì‚¬ì§„ì˜ ì™¼ìª½ì€ Labs 1ì˜ Pureí•œ t3.medium, ì˜¤ë¥¸ìª½ì€ max-podsë¥¼ ì§€ì •í•œ Custom t3.mediumì´ë‹¤. ì½˜ì†”í™”ë©´ì—ì„œ ìŠ¤í™ì€ ê°™ì§€ë§Œ í• ë‹¹ëœ í¬ë“œì˜ ìˆ˜ê°€ ë‹¤ë¥´ë‹¤.Resultì§€ê¸ˆê¹Œì§€ ë‹¤ì–‘í•œ ë°©ë²•ì„ í†µí•´ EKSì—ì„œ Maximum Podsë¥¼ íŒŒì•…í•˜ëŠ” ë°©ë²•ê³¼ ë³€ê²½í•˜ëŠ” ë°©ë²• ë°°ì› ë‹¤.AWSì—ì„œëŠ” ENIë¼ëŠ” ê°€ìƒ ë„¤íŠ¸ì›Œí¬ ì¹´ë“œë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë…¼ë¦¬ì  ë„¤íŠ¸ì›Œí¬ êµ¬ì„± ìš”ì†Œ ë•ë¶„ì— ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…ë§ˆë‹¤ ìƒì„±ë  ìˆ˜ ìˆëŠ” í¬ë“œì˜ ìˆ˜ê°€ ë‹¬ëë‹¤.ê·¸ ë°–ì—ë„ GCPì— ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ì„¤ê³„ ì² í•™ì„ ê·¸ëŒ€ë¡œ ì´ì–´ë°›ì•„ kubeletì˜ max-pods ê°’ì´ ë™ì¼í•˜ê³  í´ëŸ¬ìŠ¤í„° ìƒì„± ìˆœê°„ì—ë„ max-pods ì„¤ì •ì— ëŒ€í•œ ììœ ë„ê°€ ë†’ë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.ì–´ë– í•œ ë°©ë²•ì´ ë” ìš°ìœ„ì— ìˆëŠ”ì§€ ê²°ë¡ ì§“ê¸° ì–´ë µì§€ë§Œ, CSPì˜ ì¿ ë²„ë„¤í‹°ìŠ¤ max-pods ìƒì„± ì›ë¦¬ë¥¼ íŒŒì•…í•˜ì—¬ ìµœì ì˜ IP í• ë‹¹ì— ë„ì›€ì´ ë˜ë©´ ì¢‹ê² ë‹¤.ì†Œì¤‘í•œ ì‹œê°„ì„ ë‚´ì–´ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ì˜ëª»ëœ ë‚´ìš©ì€ ì§€ì í•´ì£¼ì„¸ìš”! ğŸ˜ƒEKS Series    Look into EKS max pods",
        "url": "/EKS_Max_Pods"
    }
    ,
    
    "codepipeline": {
        "title": "ECR CodePipeline with Terraform â…¢",
            "author": "HeuristicWave",
            "category": "",
            "content": "Terraformìœ¼ë¡œ ECR íŒŒì´í”„ë¼ì¸ êµ¬ì¶•í•˜ê¸° 3 (CodePipeline)Preview3í¸ì—ì„œëŠ” CodePipelineì„ ìƒì„±í•˜ê³  IAM ì •ì±…ê³¼ ì—­í• ì„ ë¶€ì—¬í•˜ëŠ” ë²•ì„ ë°°ì›Œë³´ê² ìŠµë‹ˆë‹¤.ë¬¸ì„œë¥¼ í™•ì¸í•˜ë©´ artifactê°€ ë‹´ê¸°ëŠ” ë²„í‚·, pipelineì„ ìƒì„±í•˜ëŠ” ë¦¬ì†ŒìŠ¤, ê´€ë ¨ëœ IAM Roleê³¼ Policyê°€ ë³´ì…ë‹ˆë‹¤.í…Œë¼í¼ì€ ì„ ì–¸í˜• ì–¸ì–´ì´ë¯€ë¡œ Roleê³¼ Resourceì˜ ì‘ì„± ìˆœì„œê°€ ë°”ë€Œì–´ë„ ìƒê´€ì´ ì—†ì§€ë§Œ, ì½˜ì†”ì—ì„œ ì‘ì—…í•  ê²½ìš° Roleì„ ë¨¼ì € ì‘ì„±í•˜ê³  ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•˜ë‹ˆ 3í¸ì—ì„œëŠ” IAMì„ ë¨¼ì € ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤.IAM Roleì•„ë˜ Roleì„ ë°©ê¸ˆì „ ìƒì„±í•œ codepipeline.tfì— ì‘ì„±í•©ë‹ˆë‹¤.resource \"aws_iam_role\" \"codepipeline_role\" {  name = \"terraform-codepipeline\"  assume_role_policy = &lt;&lt;EOF{  \"Version\": \"2012-10-17\",  \"Statement\": [    {      \"Action\": \"sts:AssumeRole\",      \"Principal\": {        \"Service\": \"codepipeline.amazonaws.com\"      },      \"Effect\": \"Allow\"    }  ]}EOF}IAM Policyë³¸ë˜ í•„ìš”í•œ ì •ì±…ë§Œì„ ê³¨ë¼ ì •ì±…ìƒì„±ê¸° ì—ì„œ ìƒìƒëœ ì •ì±…ì„ í™œìš©í•˜ëŠ” ë°©ë²•ì´ ìˆì§€ë§Œ, ì–´ë–¤ ì •ì±…ì´ í•„ìš”í•œì§€ í•œë²ˆì— ë§ì¶”ê¸°ëŠ” ë„ˆë¬´ ì–´ë µìŠµë‹ˆë‹¤.(ì €ì˜ ê²½ìš° ì¸í„°ë„·ì—ì„œ íƒ€ì¸ì´ ì‘ì„±í•œ ì •ì±…ê³¼ ì—ëŸ¬ë©”ì‹œì§€ë¥¼ ë§ì•„ê°€ë©° ì •ì±…ì„ ì‘ì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤ ğŸ˜…)â• ì•„ë˜ Policyë¥¼ ë°©ê¸ˆì „ ìƒì„±í•œ codepipeline.tfì— ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.resource \"aws_iam_policy\" \"codepipeline_policy\" {  description = \"Codepipeline Execution Policy\"  policy      = &lt;&lt;EOF{  \"Version\": \"2012-10-17\",  \"Statement\": [    {      \"Action\": [        \"s3:GetObject\", \"s3:GetObjectVersion\", \"s3:PutObject\",        \"s3:GetBucketVersioning\"      ],      \"Effect\": \"Allow\",      \"Resource\": \"${aws_s3_bucket.artifact_bucket.arn}/*\"    },    {      \"Action\" : [        \"codebuild:StartBuild\", \"codebuild:BatchGetBuilds\",        \"iam:PassRole\"      ],      \"Effect\": \"Allow\",      \"Resource\": \"*\"    },    {      \"Action\" : [        \"codecommit:CancelUploadArchive\",        \"codecommit:GetBranch\",        \"codecommit:GetCommit\",        \"codecommit:GetUploadArchiveStatus\",        \"codecommit:UploadArchive\"      ],      \"Effect\": \"Allow\",      \"Resource\": \"${aws_codecommit_repository.test.arn}\"    }  ]}EOF}ğŸš© ì´ì–´ì„œ ìƒì„±í•œ Policyë¥¼ Roleì— ë¶€ì—¬í•©ë‹ˆë‹¤. ì´ê²ƒ ì—­ì‹œ codebuild.tfì— ì¶”ê°€í•©ë‹ˆë‹¤.resource \"aws_iam_role_policy_attachment\" \"codepipeline-attach\" {  role       = aws_iam_role.codepipeline_role.name  policy_arn = aws_iam_policy.codepipeline_policy.arn}CodePipelineaws_codepipelineë¦¬ì†ŒìŠ¤ì˜ configì—ëŠ” artifact storeì™€ ì•”í˜¸í™” í‚¤, Source-Build-Deployë¡œ ì´ì–´ì§€ëŠ” ê° Stageê°€ ì„ ì–¸ë˜ì–´ ìˆìŠµë‹ˆë‹¤.ë¦¬ì†ŒìŠ¤ ì•ˆì— ê¸°ì¬ëœ ì„¤ì •ë“¤ì€ í•„ìˆ˜ê°€ ì•„ë‹ˆë¯€ë¡œ ì„ íƒí•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” deploy stageì™€ ì•”í˜¸í™” configëŠ” ì œì™¸í•˜ê³  ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.resource \"aws_codepipeline\" \"pipeline\" {  name     = \"${var.source_repo_name}-${var.source_repo_branch}-Pipeline\"  role_arn = aws_iam_role.codepipeline_role.arn  artifact_store {    location = aws_s3_bucket.artifact_bucket.bucket    type     = \"S3\"  }  stage {    name = \"Source\"    action {      name             = \"Source\"      category         = \"Source\"      owner            = \"AWS\"      version          = \"1\"      provider         = \"CodeCommit\"      output_artifacts = [\"SourceOutput\"]      run_order        = 1      configuration = {        RepositoryName       = var.source_repo_name        BranchName           = var.source_repo_branch        PollForSourceChanges = \"false\"      }    }  }  stage {    name = \"Build\"    action {      name             = \"Build\"      category         = \"Build\"      owner            = \"AWS\"      version          = \"1\"      provider         = \"CodeBuild\"      input_artifacts  = [\"SourceOutput\"]      output_artifacts = [\"BuildOutput\"]      run_order        = 1      configuration = {        ProjectName = aws_codebuild_project.codebuild.id      }    }  }}1í¸ì—ì„œ ì‘ì„±í•œ CodeCommitì„ Stageì˜ Source, 2í¸ì—ì„œ ì‘ì„±í•œ CodeBuildë¥¼ Buildë‹¨ê³„ ì§€ì •í–ˆìŠµë‹ˆë‹¤.terraform apply, plan ëª…ë ¹ì–´ë¥¼ ì°¨ë¡€ë¡œ ë°˜ì˜í•´ ì˜¤ë¥˜ê°€ ì—†ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.ì§€ê¸ˆê¹Œì§€ ì‘ì„±ëœ ì¸í”„ë¼ë¥¼ terraform state listëª…ë ¹ì–´ë¥¼ í†µí•´ í™•ì¸í•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.â¯ terraform state listaws_codebuild_project.codebuildaws_codecommit_repository.testaws_codepipeline.pipelineaws_ecr_repository.image_repoaws_iam_policy.codebuild_policyaws_iam_policy.codepipeline_policyaws_iam_role.codebuild_roleaws_iam_role.codepipeline_roleaws_iam_role_policy_attachment.codebuild-attachaws_iam_role_policy_attachment.codepipeline-attachaws_s3_bucket.artifact_bucketCodePipe line ì½˜ì†” ì—ì„œ í™•ì¸í•˜ë©´ ê¶Œí•œì´ ì—†ì–´ ì‹¤íŒ¨í•œ í™”ë©´ì´ ë‚˜ì˜¬ ê²ƒ ì…ë‹ˆë‹¤.ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë˜ ë‹¤ë¥¸ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.CodePipeline TriggerCodeCommitì—ì„œ ë°œìƒí•œ ì´ë²¤íŠ¸ê°€ CodePipelineìœ¼ë¡œ íŠ¸ë¦¬ê±°ë˜ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ ì •ì˜ëœ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.â• ì•„ë˜ ì½”ë“œë¥¼ codepipeline.tfì— ì¶”ê°€í•˜ê³  ì¸í”„ë¼ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.  resource &quot;aws_iam_role&quot; &quot;trigger_role&quot; {  name               = &quot;terraform-trigger&quot;  assume_role_policy = &lt;&lt;EOF{  &quot;Version&quot;: &quot;2012-10-17&quot;,  &quot;Statement&quot;: [    {      &quot;Action&quot;: &quot;sts:AssumeRole&quot;,      &quot;Principal&quot;: {        &quot;Service&quot;: &quot;events.amazonaws.com&quot;      },      &quot;Effect&quot;: &quot;Allow&quot;,      &quot;Sid&quot;: &quot;&quot;    }  ]}EOF}resource &quot;aws_iam_policy&quot; &quot;trigger_policy&quot; {  description = &quot;CodePipeline Trigger Execution Policy&quot;  policy      = &lt;&lt;EOF{  &quot;Version&quot;: &quot;2012-10-17&quot;,  &quot;Statement&quot;: [    {      &quot;Action&quot;: [        &quot;codepipeline:StartPipelineExecution&quot;      ],      &quot;Effect&quot;: &quot;Allow&quot;,      &quot;Resource&quot;: &quot;${aws_codepipeline.pipeline.arn}&quot;    }  ]}EOF}resource &quot;aws_iam_role_policy_attachment&quot; &quot;trigger-attach&quot; {  role       = aws_iam_role.trigger_role.name  policy_arn = aws_iam_policy.trigger_policy.arn}ResultTrigger ê¹Œì§€ ì •ìƒì ìœ¼ë¡œ ì ìš©í•˜ê³  í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ í™œìš©í•  ì•„ë¬´ Dockerfileì„ CodeCommitì— Pushí•©ë‹ˆë‹¤.ë‹¤ì‹œ CodePipeline ì½˜ì†” ì— ì ‘ì†í•´ ìš°ìƒë‹¨ì— ìœ„ì¹˜í•œ ë³€ê²½ì‚¬í•­ ë¦´ë¦¬ìŠ¤ë¥¼ ëˆ„ë¥´ë©´,ì•„ë˜ì™€ ê°™ì´ ì •ìƒì ìœ¼ë¡œ ì½”ë“œ íŒŒì´í”„ë¼ì¸ì´ ì‘ë™í•˜ì—¬ ìš´ì˜ë˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.CleanupS3 bucketì€ ë¹ˆìƒíƒœì—¬ì•¼ ì œê±°ê°€ ê°€ëŠ¥í•˜ê¸°ì— S3 ì½˜ì†” ì—ì„œ ecr-pipelineì˜ ë°ì´í„°ë¥¼ ëª¨ë‘ ì‚­ì œí•©ë‹ˆë‹¤.ì´ì–´ì„œ terraform destory ëª…ë ¹ì–´ë¡œ ëª¨ë“  ë¦¬ì†ŒìŠ¤ë¥¼ íšŒìˆ˜í•©ë‹ˆë‹¤.ì´ 3í¸ì— ê±¸ì³ì„œ í…Œë¼í¼ìœ¼ë¡œ ìµœì†Œí•œì˜ ë¦¬ì†ŒìŠ¤ë¡œ ECR Pipeline êµ¬ì¶•ë²•ì„ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. (CloudWatch ê¸°ëŠ¥ì„ ì¶”ê°€í•´ CodePipelineì„ êµ¬ì¶•í•´ë³´ì„¸ìš” ğŸ‘)í•´ë‹¹ ê³¼ì •ì„ í†µí•´ AWS ì¸í”„ë¼ ìƒì„±ë²•ê³¼, IAM í™œìš©ë²•, Variable, Output, tfvars ë“±ì„ í™œìš©í•´ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ë²•ì„ ê³µë¶€í–ˆìŠµë‹ˆë‹¤.ë‹¤ë¥¸ CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•ë²•ë„ ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ ë‹¤ë£¬ ë°©ë²•ê³¼ í¬ê²Œ ë‹¤ë¥´ì§€ ì•Šìœ¼ë‹ˆ, í•´ë‹¹ í¬ìŠ¤íŒ…ì´ ë„ì›€ì´ ë˜ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤. ğŸ˜Terraform Courses    3-Tier VPC Architecture with Terraform    ECR Pipeline with Terraform â…  (CodeCommit)    ECR Pipeline with Terraform â…¡ (ECR, CodeBuild, IAM)    ECR Pipeline with Terraform â…¢ (CodePipeline)    Provision Infrastructure with Packer",
        "url": "/CodePipeline"
    }
    ,
    
    "codebuild": {
        "title": "ECR CodePipeline with Terraform â…¡",
            "author": "HeuristicWave",
            "category": "",
            "content": "Terraformìœ¼ë¡œ ECR íŒŒì´í”„ë¼ì¸ êµ¬ì¶•í•˜ê¸° 2 (ECR, CodeBuild, IAM)2í¸ì—ì„œëŠ” ECRê³¼ CodeBuildë¥¼ ìƒì„±í•˜ê³  IAM ì—­í• , ì •ì±…ì„ ë¶€ì—¬í•˜ëŠ” ë²•ì„ í•™ìŠµí•©ë‹ˆë‹¤.ECRECR ì—­ì‹œ ê³µì‹ ë¬¸ì„œ ì—ì„œ ì‚¬ìš©ë°©ë²•ì„ í™•ì¸í•©ë‹ˆë‹¤.ê³µì‹ë¬¸ì„œì—ì„œ image_scanning_configuration configë¥¼ ì‚¬ìš©í•˜ë©´ ì·¨ì•½ì  ìŠ¤ìº”ì´ ê°€ëŠ¥í•˜ë‹¤ ì„¤ëª…ë˜ì–´ ìˆì§€ë§Œ, í•„ìš”í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì œì™¸í•˜ê² ìŠµë‹ˆë‹¤.ë”ë¶ˆì–´, outputë„ í•¨ê»˜ ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤.cat &lt;&lt;EOF &gt; ecr.tfresource \"aws_ecr_repository\" \"image_repo\" {  name                 = var.image_repo_name  image_tag_mutability = \"MUTABLE\"}output \"image_repo_url\" {  value = aws_ecr_repository.image_repo.repository_url}output \"image_repo_arn\" {  value = aws_ecr_repository.image_repo.arn}EOFì´ì–´ì„œ ecr.tfì—ì„œ ë³€ìˆ˜ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ var.image_repo_name ë¶€ë¶„ì´ ì‘ë™í•˜ë„ë¡ 1í¸ì—ì„œ ì‘ì„±í•œ variables.tf ì•„ë˜ ê°’ì„ ì¶”ê°€í•©ë‹ˆë‹¤.âœ… í¸ì˜ìƒ ì´ë²ˆ ë‹¨ê³„ì— í•„ìš”í•œ variableì„ í•¨ê»˜ í¬í•¨í–ˆìŠµë‹ˆë‹¤.variable \"image_repo_name\" {  description = \"Image repo name\"  type        = string}variable \"container_name\" {  description = \"Container Name\"  default     = \"my-container\"}variable \"source_repo_branch\" {  description = \"Source repo branch\"  type        = string}ecr ì‘ì„±ì„ ì™„ë£Œí–‡ìœ¼ë‹ˆ plan, apply ëª…ë ¹ì–´ë¥¼ ì°¨ë¡€ë¡œ ì…ë ¥í•´ ì¸í”„ë¼ë¥¼ ìƒì„±í•˜ê³  terraform state listëª…ë ¹ì–´ë‚˜ ì½˜ì†” ì—ì„œ ìƒì„±ëœ ì¸í”„ë¼ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.CodeBuildCodeBuildë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ Terraform ë„íë¨¼íŠ¸ ì—ì„œ ì‚¬ìš©ë²•ì„ í™•ì¸í•©ë‹ˆë‹¤.ê¸°ì¡´ê¹Œì§€ì˜ ì‘ì—…ê³¼ëŠ” ë‹¬ë¦¬ ìƒë‹¹íˆ ì–´ë ¤ì›Œ ë³´ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì“± í›ì–´ë³´ë©´ í¬ê²Œ 4ê°€ì§€(bucket, IAM Roleê³¼ Policy, Codebuild)ë¡œ ì •ë¦¬ë©ë‹ˆë‹¤.Bucketë„íë¨¼íŠ¸ì™€ ê°™ì´ ìš°ì„ ì ìœ¼ë¡œ S3ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. bucketì˜ ì´ë¦„ì€ ì„ íƒì´ì§€ë§Œ, ì—¬ëŸ¬ê°œì˜ ë²„í‚·ì„ ê°€ì§€ê³  ìˆëŠ” ì €ëŠ” ì‹ë³„ì„ ìœ„í•´ ì´ë¦„ì„ ë¶€ì—¬í–ˆìŠµë‹ˆë‹¤.cat &lt;&lt;EOF &gt; codebuild.tfresource \"aws_s3_bucket\" \"artifact_bucket\" {  bucket = \"ecr-pipeline\"}EOFIAM Roleë„íë¨¼íŠ¸ë¥¼ ë”°ë¼ AssumeRoleì„ ì‚¬ìš©í•©ì‹œë‹¤. â• S3ì„ ë§Œë“¤ë•Œ ì‚¬ìš©í•œ codebuild.tfì— ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.resource \"aws_iam_role\" \"codebuild_role\" {  name = \"terraform-codebuild\",  assume_role_policy = &lt;&lt;EOF{   \"Version\": \"2012-10-17\",   \"Statement\": [      {         \"Effect\": \"Allow\",         \"Principal\": {            \"Service\": \"codebuild.amazonaws.com\"         },         \"Action\": \"sts:AssumeRole\"      }   ]}EOF}IAM Policyì •ì±…ì€ IAM ì½˜ì†”ì—ì„œ ê¸°ì¡´ì— ë§Œë“¤ì–´ì§„ ì •ì±…ì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆì§€ë§Œ, ì•„ë˜ì™€ ê°™ì´ ì§ì ‘ ì‘ì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.ë„íë¨¼íŠ¸ì—ì„œ EC2ì— ëŒ€í•œ ì •ì±…ì„ ì‚¬ìš©í•˜ì§€ë§Œ, ìš°ë¦¬ëŠ” ECRì„ ì‚¬ìš©í•˜ë¯€ë¡œ ì•„ë˜ì™€ ê°™ì€ ì •ì±…ì„ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.  resource &quot;aws_iam_policy&quot; &quot;codebuild_policy&quot; {  description = &quot;CodeBuild Execution Policy&quot;  policy      = &lt;&lt;EOF{  &quot;Version&quot;: &quot;2012-10-17&quot;,  &quot;Statement&quot;: [    {      &quot;Action&quot;: [        &quot;logs:CreateLogGroup&quot;, &quot;logs:CreateLogStream&quot;, &quot;logs:PutLogEvents&quot;,        &quot;ecr:GetAuthorizationToken&quot;      ],      &quot;Effect&quot;: &quot;Allow&quot;,      &quot;Resource&quot;: &quot;*&quot;    },    {      &quot;Action&quot;: [        &quot;s3:GetObject&quot;, &quot;s3:GetObjectVersion&quot;, &quot;s3:PutObject&quot;      ],      &quot;Effect&quot;: &quot;Allow&quot;,      &quot;Resource&quot;: &quot;${aws_s3_bucket.artifact_bucket.arn}/*&quot;    },    {      &quot;Action&quot;: [        &quot;ecr:GetDownloadUrlForLayer&quot;, &quot;ecr:BatchGetImage&quot;,        &quot;ecr:BatchCheckLayerAvailability&quot;, &quot;ecr:PutImage&quot;,        &quot;ecr:InitiateLayerUpload&quot;, &quot;ecr:UploadLayerPart&quot;,        &quot;ecr:CompleteLayerUpload&quot;      ],      &quot;Effect&quot;: &quot;Allow&quot;,      &quot;Resource&quot;: &quot;${aws_ecr_repository.image_repo.arn}&quot;    }  ]}EOF}20, 30ë¼ì¸ì—ì„œ ì•ì„œ ìƒì„±í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ${ì±„ì›€ì°¸ì¡°} ë¬¸ë²•ìœ¼ë¡œ ìœ ì—°í•œ ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.ğŸš© ì´ì–´ì„œ ìƒì„±í•œ Policyë¥¼ Roleì— ë¶€ì—¬í•©ë‹ˆë‹¤. ì´ê²ƒ ì—­ì‹œ codebuild.tfì— ì¶”ê°€í•©ë‹ˆë‹¤.resource \"aws_iam_role_policy_attachment\" \"codebuild-attach\" {  role       = aws_iam_role.codebuild_role.name  policy_arn = aws_iam_policy.codebuild_policy.arn}CodeBuildTerraform ë„íë¨¼íŠ¸ ë¥¼ ë³´ì•„ë„ ì–´ë–»ê²Œ í•´ì•¼ ECRì— ì ìš©ì‹œí‚¬ ìˆ˜ ìˆëŠ”ì§€ ì•Œê¸° ì–´ë µìŠµë‹ˆë‹¤.ìš°ì„  CodeBuildë¥¼ ì´í•´í•˜ê¸° ìœ„í•´ AWS docs ë¥¼ ì½ì–´ë´…ì‹œë‹¤.ëŒ€ëµ ë¦¬ì†ŒìŠ¤ ì´ë¦„ì„ ì •í•˜ê³ , í™˜ê²½ì„ êµ¬ì„±í•˜ê³  ë¹Œë“œë¥¼ í•˜ê¸° ìœ„í•œ ë°©ë²•ì„ ì •ì˜í•´ì•¼ í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.CodeBuildê°€ ì •ì˜ëœ ì•„ë˜ ì½”ë“œë¥¼ í™œìš©í•´ codebuild.tfì— ì¶”ê°€í•©ë‹ˆë‹¤.  resource &quot;aws_codebuild_project&quot; &quot;codebuild&quot; {  name         = &quot;codebuild-${var.source_repo_name}-${var.source_repo_branch}&quot;  service_role = aws_iam_role.codebuild_role.arn  artifacts {    type = &quot;CODEPIPELINE&quot;  }    environment {    compute_type                = &quot;BUILD_GENERAL1_MEDIUM&quot;    image                       = &quot;aws/codebuild/standard:3.0&quot;    type                        = &quot;LINUX_CONTAINER&quot;    privileged_mode             = true    image_pull_credentials_type = &quot;CODEBUILD&quot;    environment_variable {      name  = &quot;REPOSITORY_URI&quot;      value = aws_ecr_repository.image_repo.repository_url    }    environment_variable {      name  = &quot;AWS_DEFAULT_REGION&quot;      value = var.aws_region    }    environment_variable {      name  = &quot;CONTAINER_NAME&quot;      value = var.container_name    }  }  source {    type      = &quot;CODEPIPELINE&quot;    buildspec = &lt;&lt;BUILDSPEC${file(&quot;buildspec.yml&quot;)}BUILDSPEC  }}31ë¼ì¸ì´ ì°¸ì¡°í•˜ëŠ” buildspec.ymlì„ pre_build, build, post_buildì— ë§ì¶° ì‘ì„±í•©ë‹ˆë‹¤.cat &lt;&lt;EOF &gt; buildspec.ymlversion: 0.2phases:  install:    runtime-versions:      docker: 18  pre_build:    commands:      - echo Logging in to Amazon ECR...      - $(aws ecr get-login --region $AWS_DEFAULT_REGION --no-include-email)      - COMMIT_HASH=$(echo $CODEBUILD_RESOLVED_SOURCE_VERSION | cut -c 1-7)      - IMAGE_TAG=${COMMIT_HASH:=latest}  build:    commands:      - echo Build started on `date`      - echo Building the Docker image...      - docker build -t $REPOSITORY_URI:latest .      - docker tag $REPOSITORY_URI:latest $REPOSITORY_URI:$IMAGE_TAG  post_build:    commands:      - echo Build completed on `date`      - echo Pushing the Docker image...      - docker push $REPOSITORY_URI:latest      - docker push $REPOSITORY_URI:$IMAGE_TAG      - echo Writing image definitions file...      - printf '[{\"name\":\"%s\",\"imageUri\":\"%s\"}]' $CONTAINER_NAME $REPOSITORY_URI:$IMAGE_TAG &gt; imagedefinitions.jsonartifacts:  files: imagedefinitions.jsonEOFì§€ê¸ˆê¹Œì§€ ì‘ì„±ëœ ì¸í”„ë¼ë¥¼ terraform state listëª…ë ¹ì–´ë¥¼ í†µí•´ í™•ì¸í•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.â¯ terraform state listaws_codebuild_project.codebuildaws_codecommit_repository.testaws_ecr_repository.image_repoaws_iam_policy.codebuild_policyaws_iam_role.codebuild_roleaws_iam_role_policy_attachment.codebuild-attachaws_s3_bucket.artifact_bucket  ìƒì„±í•œ ì¸í”„ë¼ê°€ ìœ„ì™€ ê°™ì§€ ì•Šì„ ê²½ìš°, ğŸ‘‰ Click  ì‹¤ìˆ˜ë¡œ ì˜ë„ì¹˜ ì•Šì€ ì¸í”„ë¼ê°€ í”„ë¡œë¹„ì €ë‹ ë˜ì—ˆë‹¤ë©´ 2ê°€ì§€ ë°©ë²•ì„ í†µí•´ ì› ìƒíƒœë¡œ ë³µêµ¬ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.      terraform destroy ëª…ë ¹ì–´ë¡œ íŠ¹ì • ì¸í”„ë¼ë§Œ ë˜ëŒë¦¬ê±°ë‚˜ í”„ë¡œë¹„ì €ë‹ í•˜ê³ ì‹¶ì€ ê²½ìš°, -target ì˜µì…˜ê³¼ í•¨ê»˜ resource ëª…ìœ¼ë¡œ ëª…ë ¹ì–´ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. ì˜ˆì‹œ) terraform destory -target aws_vpc.main    ì˜ëª» ì‘ì„±í•œ ì½”ë“œë¥¼ ìˆ˜ì • í›„, terraform applyëª…ë ¹ì–´ë¥¼ ì ìš©í•˜ì—¬ ìµœì‹  ìƒíƒœì˜ ì¸í”„ë¼ë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤.  Terraform Courses    3-Tier VPC Architecture with Terraform    ECR Pipeline with Terraform â…  (CodeCommit)    ECR Pipeline with Terraform â…¡ (ECR, CodeBuild, IAM)    ECR Pipeline with Terraform â…¢ (CodePipeline)    Provision Infrastructure with Packer",
        "url": "/CodeBuild"
    }
    ,
    
    "codecommit": {
        "title": "ECR CodePipeline with Terraform â… ",
            "author": "HeuristicWave",
            "category": "",
            "content": "Terraformìœ¼ë¡œ ECR íŒŒì´í”„ë¼ì¸ êµ¬ì¶•í•˜ê¸° 1 (CodeCommit)Overviewì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì»¤ë°‹ í›„, ë„ì»¤ì˜ ì´ë¯¸ì§€ë¥¼ ìë™ìœ¼ë¡œ ë°°í¬í•˜ëŠ” ECR Pipelineì„ í…Œë¼í¼ìœ¼ë¡œ ìƒì„±í•´ë³´ê² ìŠµë‹ˆë‹¤.AWSì—ì„œ ì €ì¥ì†Œ ì—­í• ì„ í•˜ëŠ” CodeCommit, ì½”ë“œë¥¼ ë¹Œë“œí•˜ëŠ” CodeBuild, íŒŒì´í”„ë¼ì¸ì„ ìë™í™” í•˜ëŠ” CodePipeline, ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ëŠ” ECRì„ í™œìš©í•´ êµ¬ì¶•í•©ë‹ˆë‹¤.1í¸ì—ì„œëŠ” CodeCommit êµ¬ì¶•ê³¼ terraformì˜ Output, Variables, tfvars ë“±ì„ ë°°ì›Œ ë³´ê² ìŠµë‹ˆë‹¤.ì¤€ë¹„ ì‘ì—…ì´ë²ˆ í¬ìŠ¤íŒ…ì˜ ì‘ì—…ê³µê°„(~/terraform)ì„ ìƒì„±í•˜ê³  í•´ë‹¹ ìœ„ì¹˜ì—ì„œ ì•„ë˜ ì½”ë“œ ë¸”ëŸ­ì„ í„°ë¯¸ë„ì— ë³µì‚¬í•©ë‹ˆë‹¤.cat &lt;&lt;EOF &gt; provider.tfprovider \"aws\" {  region  = var.aws_region}EOFì´í›„, terraform init ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰ì‹œì¼œì£¼ì„¸ìš”.CodeCommitCodeCommitì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ Terraform ë„íë¨¼íŠ¸ ì—ì„œ ì‚¬ìš©ë²•ì„ í™•ì¸í•©ë‹ˆë‹¤.ë§í¬ì˜ Example Usageë¥¼ í™œìš©í•´ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ë„ ìˆì§€ë§Œ, ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì œ ë°©ì‹ëŒ€ë¡œì•„ë˜ ì½”ë“œë¥¼ í™œìš©í•´ ì‘ì„±í•´ë³´ê² ìŠµë‹ˆë‹¤.ë§í¬ì—ì„œ ì†Œê°œí•˜ëŠ” ì½”ë“œì™€ ë‹¤ë¥¸ ë¶€ë¶„ì€ outputê³¼ variableì˜ ì‚¬ìš© ì—¬ë¶€ì…ë‹ˆë‹¤.âœ… ì•„ë˜ ì½”ë“œì™€ ë„íë¨¼íŠ¸ì˜ ì½”ë“œê°€ ì–´ë–»ê²Œ ë‹¤ë¥¸ì§€ ê¼­ í™•ì¸í•´ë³´ì„¸ìš”!cat &lt;&lt;EOF &gt; codecommit.tfresource \"aws_codecommit_repository\" \"test\" {  repository_name = var.source_repo_name  description     = \"This is the Sample App Repository\"}output \"source_repo_clone_url_http\" {  value = aws_codecommit_repository.test.clone_url_http}EOFOutputì€ í–¥í›„ cloneí•  ì›ê²© ì €ì¥ì†Œì˜ ìœ„ì¹˜ë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•´ ë„£ì–´ì¤ë‹ˆë‹¤. ë˜í•œ Variableì„ ì‚¬ìš©í•´ ë³´ë‹¤ ìœ ì—°í•œ ì½”ë“œë¥¼ ì‘ì„±í•´ ë³´ê² ìŠµë‹ˆë‹¤.ì¤€ë¹„ ì‘ì—…ì— ì •ì˜í•œ ë¦¬ì „ê³¼ CodeCommit Repo ì´ë¦„ì— Variableì„ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.cat &lt;&lt;EOF &gt; variables.tfvariable \"aws_region\" {  description = \"The AWS region\"  default     = \"ap-northeast-2\"}variable \"source_repo_name\" {  description = \"Source repo name\"  type        = string}EOFìœ„ ì½”ë“œë¥¼ ë³µì‚¬í•œ í›„, terraform plan ëª…ë ¹ì–´ë¡œ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.ì•ì„œ ì‘ì„±í•œ variables.tfì˜ regionì€ default ê°’ì´ ìˆì§€ë§Œ, repositoryëŠ” variableì˜ í˜•ì‹ë§Œ ì •ì˜ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì¸í”„ë¼ë¥¼ ìƒì„±í•  ë•Œ í•„ìˆ˜ì ìœ¼ë¡œ ì´ë¦„ì„ ì…ë ¥ë°›ìŠµë‹ˆë‹¤.âœ… variableì˜ inputê°’ì„ ìˆ˜ê¸°ë¡œ ì‘ì„±í•˜ëŠ” ê²ƒì„ í”¼í•˜ê³  ì‹¶ìœ¼ë©´ tfvarsë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. í¸ì˜ìƒ ì´ë²ˆ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•  ê°’ë“¤ì„ ë¯¸ë¦¬ ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤.cat &lt;&lt;EOF &gt; terraform.tfvarsaws_ecr=\"my-image\"source_repo_name=\"my-pipeline\"source_repo_branch=\"master\"image_repo_name=\"my-pipeline\"EOFtfvarsëŠ” ìœ„ì™€ ê°™ì´ ë³€ìˆ˜ì˜ ê°’ì„ ì§€ì •í•˜ê¸°ë„ í•˜ì§€ë§Œ, .envì²˜ëŸ¼ ì™¸ë¶€ë¡œ ë…¸ì¶œí•˜ë©´ ì•ˆë˜ëŠ” ê°’ì„ ë„£ì–´ë‘ê³  gitì— ignoreì‹œì¼œ ì‚¬ìš©í•˜ê¸°ë„ í•©ë‹ˆë‹¤.ìœ„ ì‘ì—…ì„ ì§„í–‰ í›„, terraform applyëª…ë ¹ì–´ë¥¼ ì ìš©í•˜ë©´ â€œApply completeâ€ê³¼ í•¨ê»˜ Outputs ê°’ì´ ë‚˜ì˜µë‹ˆë‹¤.terraform state listëª…ë ¹ì–´ ì´ì™¸ì—ë„, ì½˜ì†” ë¡œ ì´ë™í•˜ë©´ ìƒì„±ëœ ì¸í”„ë¼ë¥¼ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.ìƒì„±ëœ ì›ê²©ì €ì¥ì†Œë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ terraform outputì„ í™œìš©í•´ export í™˜ê²½ ë³€ìˆ˜ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.export tf_source_repo_clone_url_http=$(terraform output source_repo_clone_url_http)echo $tf_source_repo_clone_url_http\t# í™•ì¸Git SettingCodeCommitì˜ Repo í™œìš©ë²•ì€ ì•„ë˜ 2ê°€ì§€ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤.1. ë¡œì»¬ì— ìœ„ì¹˜í•œ ì½”ë“œë¥¼ CodeCommitì— pushí•˜ê¸° (ì›ê²©ì €ì¥ì†Œê°€ ë¹„ì–´ìˆìŒ)ë¡œì»¬ì˜ ë¹ˆê³µê°„ì—ì„œ CodeCommit Repo ì‚¬ìš©ì„ ìœ„í•œ git remote ì§€ì •git initgit remote add origin $tf_source_repo_clone_url_httpgit remote -v   # ì›ê²© ì €ì¥ì†Œ í™•ì¸ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  CodeCommitì— Pushí•˜ê¸°git add .git commit -m \"First commit\"git statusgit push origin # master branchë¡œ pushìê²© ì¦ëª… ë¬¸ì œê°€ ìˆë‹¤ë©´ ì•„ë˜ ëª…ë ¹ì–´ë¡œ í•´ê²°í•©ë‹ˆë‹¤. ìê²© ì¦ëª… í—¬í¼ ë° AWS CodeCommitì— ëŒ€í•œ HTTPS ì—°ê²° ë¬¸ì œ í•´ê²°git config --global credential.helper '!aws codecommit credential-helper $@'git config --global credential.UseHttpPath true2. ë¡œì»¬ì— ì›ê²©ì €ì¥ì†Œì˜ ì½”ë“œë¥¼ cloneí•˜ê¸° (ì›ê²©ì €ì¥ì†Œê°€ ë¹„ì–´ìˆì§€ ì•ŠìŒ)git clone $tf_source_repo_clone_url_httpì§€ê¸ˆê¹Œì§€ ë„íë¨¼íŠ¸ë¥¼ í™œìš©í•´ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³ , variable, output, tfvarsì˜ í™œìš©ë²•ì„ ë°°ì›Œë³´ì•˜ìŠµë‹ˆë‹¤.ì•ì„œ ì‘ì„±ëœ ì‘ì—…ë“¤ì´ ì •ìƒì ìœ¼ë¡œ ì»¤ë°‹ê³¼ cloneì´ ê°€ëŠ¥í•˜ë©´, ë‹¤ìŒ ë‹¨ê³„ë¡œ ğŸš€Terraform Courses    3-Tier VPC Architecture with Terraform    ECR Pipeline with Terraform â…  (CodeCommit)    ECR Pipeline with Terraform â…¡ (ECR, CodeBuild, IAM)    ECR Pipeline with Terraform â…¢ (CodePipeline)    Provision Infrastructure with Packer",
        "url": "/CodeCommit"
    }
    ,
    
    "3tier": {
        "title": "3-Tier VPC Architecture with Terraform",
            "author": "HeuristicWave",
            "category": "",
            "content": "ë³¸ ê¸€ì€ Configure and Deploying VPCs with Multiple Subnets ì—ì„œ ë‹¤ë£¨ëŠ” Production-Ready: The 3-Tier VPC ê°•ì˜ë¥¼ ë°”íƒ•ìœ¼ë¡œ, í…Œë¼í¼ìœ¼ë¡œ êµ¬ì¶•í•˜ëŠ” 3ê³„ì¸µ VPC ì•„í‚¤í…ì²˜ì— ëŒ€í•œ ê¸€ì…ë‹ˆë‹¤.  Multi-Tier VPC ë€?  VPCë¥¼ êµ¬ì¶•í•  ë•Œ ë‹¨ì¼ ê³„ì¸µ VPCì— ëª¨ë“  ìì›ì„ ë„£ëŠ”ë‹¤ë©´, ë„¤íŠ¸ì›Œí¬ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì ì¬ì  ê³µê²©ìì—ê²Œ ìì›ì´ ë…¸ì¶œë©ë‹ˆë‹¤. ì´ë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ ì„œë¸Œë„·ìœ¼ë¡œë‹¤ì¤‘ ê³„ì¸µ VPC ì•„í‚¤í…ì²˜ë¥¼ ë§Œë“¤ì–´ ë°©ì–´ ê³„ì¸µì„ ì´ë£° ìˆ˜ ìˆìŠµë‹ˆë‹¤.  ë””ìì¸ íŒ¨í„´ : 3 Tier VPC Architectureí…Œë¼í¼ ì½”ë“œëŠ” ëª¨ë“ˆë¡œ ê´€ë¦¬í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•˜ì§€ë§Œ, ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” 3-tier ì•„í‚¤í…ì²˜ ì¤‘ ë„¤íŠ¸ì›Œí¬ì™€ ê´€ë ¨ëœ ë¶€ë¶„ë§Œì„ ë‹¤ë¤„ í•˜ë‚˜ì˜ íŒŒì¼ì—ì„œ ì½”ë“œë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.  Step 0 (í…Œë¼í¼ì„ í™œìš©í•˜ì‹¤ ì¤„ ì•ˆë‹¤ë©´ ë„˜ì–´ê°€ì„¸ìš”)  Step 0  ì•„í‚¤í…ì²˜ë¥¼ êµ¬ì„±í•  í´ë”ë¥¼ ë§Œë“¤ê³  providerë¥¼ ì£¼ì…í•©ë‹ˆë‹¤.  mkdir architecturecd architectureterraform inittouch threeTierVPC.tf    threeTierVPC.tfì— ë²¤ë” ì •ë³´ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.  provider \"aws\" {  region = \"ap-northeast-2\"}    ëª…ë ¹ì–´terraform plan, terraform applyë¥¼ í†µí•´, ì˜¤ë¥˜ ì—†ì´ í†µê³¼í•˜ëŠ” í™”ë©´ì„ í™•ì¸í•˜ê³  ë‹¤ìŒ ë‹¨ê³„ë¡œ ğŸš€      terraform applyë¡œ ì¸í”„ë¼ë¥¼ ë°˜ì˜ í• ë•Œ, -auto-approveì˜µì…˜ì„ ì£¼ë©´ yesì…ë ¥ ì—†ì´ ì§„í–‰ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ yesë¥¼ ì…ë ¥í•˜ê¸° ì „, í•œë²ˆ ë” ê²€í† í•  ìˆ˜ ìˆëŠ” ê¸°íšŒê°€ ìˆìœ¼ë¯€ë¡œ ê¶Œì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.  ğŸ’¡ê° ì†Œì œëª© ë§í¬ì— ì²¨ë¶€ëœ ì½”ë“œë¥¼ í™œìš©í•´ Step 0 ì—ì„œ ë§Œë“  threeTierVPC.tfì— ì´ì–´ì„œ ì‘ì„±í•˜ê±°ë‚˜, ë”°ë¡œ ìƒˆë¡œìš´ íŒŒì¼ì„ ë§Œë“¤ì–´ terraform plan, terraform apply ëª…ë ¹ì–´ë¥¼ ì°¨ë¡€ë¡œ ì‘ì„±í•˜ë©° ê³„ì¸µì„ ìŒ“ì•„ ì˜¬ë¦½ë‹ˆë‹¤.Step 1Layer 1ï¸âƒ£ : Public subnetí•˜ë‚˜ì˜ VPCì— 2ê°œì˜ AZë¥¼ ë§Œë“¤ê³  ê°ê°ì˜ Public ì„œë¸Œë„·ì„ ìœ„ì¹˜ì‹œí‚µë‹ˆë‹¤.  í¼ë¸”ë¦­ ì„œë¸Œë„·ì€ í”„ë¼ì´ë¹— ì„œë¸Œë„· ë³´ë‹¤ ì ì€ ìˆ˜ì˜ IP ì˜ˆì•½í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.Step 1 ì½”ë“œë¥¼ ì ìš© í›„, ëª…ë ¹ì–´ë¡œ ì¸í”„ë¼ ìƒíƒœë¥¼ ì ê²€í•´ ì•„ë˜ì™€ ê°™ë‹¤ë©´ ë‹¤ìŒ ë‹¨ê³„ë¡œ ğŸš€$ terraform state listdata.aws_availability_zones.availableaws_internet_gateway.igwaws_subnet.pub_sub_1aws_subnet.pub_sub_2aws_vpc.main  ìƒì„±í•œ ì¸í”„ë¼ê°€ ìœ„ì™€ ê°™ì§€ ì•Šì„ ê²½ìš°  ì‹¤ìˆ˜ë¡œ ì˜ë„ì¹˜ ì•Šì€ ì¸í”„ë¼ê°€ í”„ë¡œë¹„ì €ë‹ ë˜ì—ˆë‹¤ë©´ 2ê°€ì§€ ë°©ë²•ì„ í†µí•´ ì› ìƒíƒœë¡œ ë³µêµ¬ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.      terraform destroy ëª…ë ¹ì–´ë¡œ íŠ¹ì • ì¸í”„ë¼ë§Œ ë˜ëŒë¦¬ê±°ë‚˜ í”„ë¡œë¹„ì €ë‹ í•˜ê³ ì‹¶ì€ ê²½ìš°, -target ì˜µì…˜ê³¼ í•¨ê»˜ resource ëª…ìœ¼ë¡œ ëª…ë ¹ì–´ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. ì˜ˆì‹œ) terraform destory -target aws_vpc.main    ì˜ëª» ì‘ì„±í•œ ì½”ë“œë¥¼ ìˆ˜ì • í›„, terraform applyëª…ë ¹ì–´ë¥¼ ì ìš©í•˜ì—¬ ìµœì‹  ìƒíƒœì˜ ì¸í”„ë¼ë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤.  Step 2Layer 1ï¸âƒ£ : Internet access resourcesì™¸ë¶€ ì¸í„°ë„·ê³¼ì˜ ë…¸ì¶œì„ ì œí•œí•˜ê³  ë‚˜ê°€ëŠ” íŠ¸ë˜í”½ì„ ìœ„í•´ NAT Gatewayë¥¼ í™œìš©í•©ë‹ˆë‹¤. ë˜í•œ ë“¤ì–´ì˜¤ëŠ” íŠ¸ë˜í”½ì„ ìœ„í•´ ALBë¥¼ ìœ„ì¹˜ì‹œì¼°ìŠµë‹ˆë‹¤.ë¡œë“œë°¸ëŸ°ì„œì™€ NAT GatewayëŠ” ê°€ìš©ì„±ì´ ë†’ì€ ê´€ë¦¬í˜• ì„œë¹„ìŠ¤ë¡œ ë³‘ëª© í˜„ìƒì— ëŒ€í•´ ê±±ì •í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.  ğŸ’¡Nat Gateway ì•Œì•„ë³´ê¸°  NAT(ë„¤íŠ¸ì›Œí¬ ì£¼ì†Œ ë³€í™˜) ê²Œì´íŠ¸ì›¨ì´ë¥¼ ì‚¬ìš©í•˜ë©´ í”„ë¼ì´ë¹— ì„œë¸Œë„·ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¸í„°ë„· ë˜ëŠ” ê¸°íƒ€ AWS ì„œë¹„ìŠ¤ì— ì—°ê²°í•˜ëŠ” í•œí¸, ì¸í„°ë„·ì—ì„œ í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ì™€ì˜ ì—°ê²°ì„ ì‹œì‘í•˜ì§€ ëª»í•˜ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.NAT ê²Œì´íŠ¸ì›¨ì´ë¥¼ ë§Œë“¤ë ¤ë©´ NAT ê²Œì´íŠ¸ì›¨ì´ê°€ ì†í•  í¼ë¸”ë¦­ ì„œë¸Œë„·ì„ ì§€ì •í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— Step2ì—ì„œ ìš°ì„ ì ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.  ë„íë¨¼íŠ¸ë¡œ ë” ì•Œì•„ë³´ê¸°  ê·¸ë¦¼ì—ì„œëŠ” ë³´ì´ì§€ ì•Šì§€ë§Œ, VPCì—ëŠ” ì•”ì‹œì  ë¼ìš°í„°ê°€ ìˆìœ¼ë©° ë¼ìš°íŒ… í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì´ ì „ë‹¬ë˜ëŠ” ìœ„ì¹˜ë¥¼ ì œì–´í•©ë‹ˆë‹¤.VPCì˜ ê° ì„œë¸Œë„·ì„ ë¼ìš°íŒ… í…Œì´ë¸”ì— ì—°ê²°í•´ì•¼ í•©ë‹ˆë‹¤. í…Œì´ë¸”ì—ì„œëŠ” ì„œë¸Œë„·ì— ëŒ€í•œ ë¼ìš°íŒ…ì„ ì œì–´í•©ë‹ˆë‹¤.Step 2 ì½”ë“œë¥¼ ì ìš© í›„, ëª…ë ¹ì–´ë¡œ ì¸í”„ë¼ ìƒíƒœë¥¼ ì ê²€í•´ ì•„ë˜ì™€ ê°™ë‹¤ë©´ ë‹¤ìŒ ë‹¨ê³„ë¡œ ğŸš€$ terraform state listdata.aws_availability_zones.availableaws_eip.nat_1aws_eip.nat_2aws_internet_gateway.igwaws_nat_gateway.nat_gateway_1aws_nat_gateway.nat_gateway_2aws_route_table.route_table_pubaws_route_table_association.route_table_association_1aws_route_table_association.route_table_association_2aws_subnet.pub_sub_1aws_subnet.pub_sub_2aws_vpc.mainì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ ALBì™€ ì¸ìŠ¤í„´ìŠ¤ëŠ” ë‹¤ë£¨ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”í›„, ëª¨ë“ˆë¡œ í…Œë¼í¼ì„ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì—ì„œ í•™ìŠµí•˜ê² ìŠµë‹ˆë‹¤. Step 3Layer 2ï¸âƒ£ï¸ : Apps in a private subnet2ê°œì˜ í”„ë¼ì´ë¹— ì„œë¸Œë„·ì— ê°ê°ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë†“ìŠµë‹ˆë‹¤. ì´í›„, ë‘ í¼ë¸”ë¦­ ì„œë¸Œë„·ì— ì—°ê²°ëœ ALBëŠ” í”„ë¼ì´ë¹— ì„œë¸Œë„· ë¦¬ì†ŒìŠ¤ ê°„ì˜ íŠ¸ë˜í”½ì„ ë¶„ì‚°ì‹œí‚µë‹ˆë‹¤.  â—ï¸ì˜ˆì œ ê·¸ë¦¼ì—ì„œëŠ” Private subnetì˜ cidr blockì„ 10.0.2.0/22ë¡œ ê°€ì´ë“œ í•˜ì§€ë§Œ, ì´ëŠ” ì•ì„œ ë§Œë“  ì„œë¸Œë„·ê³¼ ë²”ìœ„ê°€ ê²¹ì¹˜ë¯€ë¡œ 10.0.4.0/22ë¡œ ë°”ê¿” ì§„í–‰í•©ë‹ˆë‹¤.CIDR ê³„ì‚°ê¸° ì—ì„œ ì •í™•í•˜ê²Œ í™•ì¸í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  Step3ì—ì„œë„ Step2ì™€ ê°™ì´ ê·¸ë¦¼ì—ì„œëŠ” ë³´ì´ì§€ ì•ŠëŠ” ë¼ìš°íŠ¸ í…Œì´ë¸”ì„ ë§Œë“¤ê³  NAT ê²Œì´íŠ¸ì›¨ì´ì™€ í”„ë¼ì´ë¹— ì„œë¸Œë„·ì„ ì—°ê²°í•´ ì¤ë‹ˆë‹¤.í”„ë¼ì´ë¹— ì„œë¸Œë„·ì˜ ìš”ì²­ì´ ì™¸ë¶€ë¡œ ë‚˜ê°ˆë•ŒëŠ” NAT ê²Œì´íŠ¸ì›¨ì´ì˜ ê³ ì • IPë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.(í”„ë¼ì´ë¹— ì„œë¸Œë„·ì˜ ë¼ìš°íŠ¸ í…Œì´ë¸”ì€ í¼ë¸”ë¦­ê³¼ ë‹¬ë¦¬ 2ê°œë¥¼ ë§Œë“¤ì–´ ê°ê° ì—°ê²°í•´ ì£¼ì—ˆìŠµë‹ˆë‹¤.)Step 3 ì½”ë“œë¥¼ ì ìš© í›„, ëª…ë ¹ì–´ë¡œ ì¸í”„ë¼ ìƒíƒœë¥¼ ì ê²€í•´ ì•„ë˜ì™€ ê°™ë‹¤ë©´ ë‹¤ìŒ ë‹¨ê³„ë¡œ ğŸš€$ terraform state listdata.aws_availability_zones.availableaws_eip.nat_1aws_eip.nat_2aws_internet_gateway.igwaws_nat_gateway.nat_gateway_1aws_nat_gateway.nat_gateway_2aws_route.private_nat_1aws_route.private_nat_2aws_route_table.route_table_pri_1aws_route_table.route_table_pri_2aws_route_table.route_table_pubaws_route_table_association.route_table_association_1aws_route_table_association.route_table_association_2aws_route_table_association.route_table_pri_association_1aws_route_table_association.route_table_pri_association_2aws_subnet.pri_sub_1aws_subnet.pri_sub_2aws_subnet.pub_sub_1aws_subnet.pub_sub_2aws_vpc.mainì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ DBì™€ ì¸ìŠ¤í„´ìŠ¤ ì—°ê²°ì€ ë‹¤ë£¨ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¶”í›„, ëª¨ë“ˆë¡œ í…Œë¼í¼ì„ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì—ì„œ í•™ìŠµí•˜ê² ìŠµë‹ˆë‹¤. Step 4Layer 3ï¸âƒ£ : Data in a second private subnetì²« ë²ˆì§¸ í”„ë¼ì´ë¹— ì„œë¸Œë„· ë’¤ì— ë‘ ë²ˆì§¸ í”„ë¼ì´ë¹— ì„œë¸Œë„·ì„ ë°°ì¹˜í•©ë‹ˆë‹¤. (ì½”ë“œ ìƒëµ) ì¥ì• ê°€ ë°œìƒí•  ê²½ìš°ë¥¼ ëŒ€ë¹„í•´ read-replica í˜¹ì€ standby êµ¬ì„±ìœ¼ë¡œ ë°°ì¹˜í•©ë‹ˆë‹¤.  â—Step4ì˜ ì„œë¸Œë„· ì‘ì„±ë²•ì€ Step3ì˜ ë°©ë²•ê³¼ ë™ì¼í•©ë‹ˆë‹¤. ì•„ë˜ ì‚¬ì§„ì€ CIDRì˜ ë²”ìœ„ê°€ ê²¹ì¹˜ë¯€ë¡œ, Private subnetì˜ cidr blockì„ 10.0.8.0/23ì„ 10.0.12.0/23ë¡œ, 10.0.10.0/23ì„ 10.0.14.0/23ìœ¼ë¡œ ë°”ê¿” ì§„í–‰í•˜ì„¸ìš”.  ë°ì´í„° ë¦¬ì†ŒìŠ¤(/23)ë³´ë‹¤ë¥¼ ì•± ë¦¬ì†ŒìŠ¤(/22)ë¥¼ í™•ì¥í•  ê°€ëŠ¥ì„±ì´ ì»¤, ë” í° ì„œë¸Œë„· ë§ˆìŠ¤í¬ë¥¼ í• ë‹¹í•©ë‹ˆë‹¤.Step 5Leave extra IPs availableë°°í¬ëœ ì¸í”„ë¼ê°€ í™•ì¥ë˜ì–´ ì•„í‚¤í…ì²˜ê°€ ë³€ê²½ë  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì—¬ìœ ë¶„ì˜ IPë¥¼ ì˜ˆì•½ì„ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. (ì½”ë“œ ìƒëµ)ìœ„ì™€ ê°™ì€ ë‹¨ê³„ë“¤ì„ í†µí•´ 3 Tier VPC Architectureë¥¼ í•™ìŠµí•´ë³´ì•˜ìŠµë‹ˆë‹¤.Terraformìœ¼ë¡œ ìƒì„±ëœ ìì›ë“¤ì€ terraform destoryëª…ë ¹ì–´ë¥¼ í†µí•´ í•™ìŠµì„ ì‹œì‘í•˜ê¸° ì „ ìƒíƒœë¡œ ë˜ëŒë¦¬ì„¸ìš”.ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ ìƒëµí–ˆë˜ ì¸ìŠ¤í„´ìŠ¤, DB, LB ë“±ì„ ëª¨ë“ˆë¡œ ê´€ë¦¬í•˜ë©° ë‹¤ë¤„ ë³´ê² ìŠµë‹ˆë‹¤.Terraform Courses    3-Tier VPC Architecture with Terraform    ECR Pipeline with Terraform â…  (CodeCommit)    ECR Pipeline with Terraform â…¡ (ECR, CodeBuild, IAM)    ECR Pipeline with Terraform â…¢ (CodePipeline)    Provision Infrastructure with Packer",
        "url": "/3Tier"
    }
    ,
    
    "pipenv01": {
        "title": "Pipenv, Nginx, Gunicorn ì„œë²„ ìš´ì˜í•˜ê¸°",
            "author": "HeuristicWave",
            "category": "",
            "content": "Virtualenv í™˜ê²½ì´ ì•„ë‹Œ Pipenvë¥¼ ì‚¬ìš©í•˜ë©° ë§Œë‚œ ì—ëŸ¬ í•´ê²° ê³¼ì • ì •ë¦¬ì‚¬ì „ ì‘ì—…ìì„¸í•œ ë°©ë²•ì€ í•˜ë‹¨ ì°¸ê³ ìë£Œë¥¼ í†µí•´ í™•ì¸ í•  ìˆ˜ ìˆë‹¤      gunicorn, nginx ì„¤ì¹˜          ec2ì—ì„œ nginx ì„¤ì¹˜í•˜ê¸° : CentOS 7 Nginx ì„¤ì¹˜ ë°©ë²•            gunicorn ì‘ë™í™•ì¸  Gunicorn ğŸ¦„ì„œë¹„ìŠ¤ ë“±ë¡ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±/etc/systemd/system/gunicorn.service íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì€ ë‚´ìš©ìœ¼ë¡œ ìƒì„±.pipenvëŠ” venvì™€ ExecStart ê²½ë¡œê°€ ë‹¤ë¥´ë‹¤ëŠ” ì ì„ ìœ ë…í•´ ì‘ì„±í•˜ì[Unit]Description=gunicorn daemonAfter=network.target[Service]User=ec2-userGroup=ec2-userWorkingDirectory=/home/ec2-user/django/repoExecStart=/usr/local/bin/pipenv run gunicorn --workers 3 \\        &lt;wsgiê°€ ìœ„ì¹˜í•œ í´ë”&gt;.wsgi:application --bind 0.0.0.0:8000[Install]WantedBy=multi-user.target  ë³¸ë˜ --bindë¶€ë¶„ì— unix:/home/ec2-user/django/gunicorn.sock ë¥¼ ë„£ì–´ êµ¬ë™í•˜ë©´ repoì˜ ìƒìœ„ í´ë”ì—  gunicorn.sockê°€ ìƒê¸´ë‹¤.nginxì˜ proxy_pass ë¶€ë¶„ë„ http://unix:/{$PATH}/gunicorn.sockì„ ê¸°ì¬í•´ sockë¡œ êµ¬ì„±í•˜ëŠ” ê²ƒì´ ë§ëŠ” ë°©ë²• ê°™ì€ë°â€¦ ì´ ë¶€ë¶„ì— ëŒ€í•´ì„œëŠ” í•™ìŠµì´ í•„ìš”í•˜ë‹¤.ì„œë¹„ìŠ¤ ë“±ë¡sudo systemctl start gunicornsudo systemctl enable gunicornì„œë¹„ìŠ¤ êµ¬ë™ í™•ì¸sudo systemctl status gunicornNginxì‚¬ì´íŠ¸ ì„¤ì • ì¶”ê°€ec2ì— nginxë¥¼ ë°›ì•˜ì„ ë•Œ, etc/nginx/sites-enabled ì™€ etc/nginx/sites-availabe ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤. í•´ë‹¹ ê²½ë¡œì— ì—†ë‹¤ë©´ ë§Œë“¤ì–´ì£¼ê³  ìˆìœ¼ë©´ default íŒŒì¼ì„ ì‚­ì œí•˜ì.server {        listen 80;        server_name &lt;IP or ë„ë©”ì¸&gt;;        charset utf-8;        location / {                include proxy_params;                proxy_pass http://0.0.0.0:8000        }        location /static/ {                root /home/ec2-user/django/repo;        }                location /media/ {                root /home/ec2-user/django/repo;        }}  nginx ì£¼ìš” ê°œë…, nginx : root vs aliasinclude proxy_paramsì˜ ê²½ìš° /etc/nginx/proxy_params ì— í”„ë¡ì‹œ í—¤ë”ë¥¼ ê¸°ì¬ í•´ì•¼ í•œë‹¤. (ë‹¤ìŒ ë§í¬ ì°¸ê³ ) nginx &amp; awsì‚¬ì´íŠ¸ ì¶”ê°€sudo ln -s /etc/nginx/sites-available/django_test /etc/nginx/sites-enabledê¸°ë™sudo systemctl start nginxê¸°íƒ€ ë„ì›€ì´ ë˜ëŠ” ëª…ë ¹ì–´sudo systemctl daemon-reloadsudo systemctl stop, restart nginxps -efpspkill gunicorn  dotenv ê´€ë ¨ ì—ëŸ¬ í•´ê²°í•˜ê¸°            gunicorn ì„ í™œìš©í•´ ì—°ê²° í•  ê²½ìš°      $ pip uninstall dotenv$ pip install python-dotenv                     docker + nginx + gunicorn ì„ í™œìš©í•  ê²½ìš°      $ pip uninstall dotenv$ pip install python-dotenv             ì°¸ê³ ìë£Œ  gunicorn ì‚¬ì „ì‘ì—…  Nginx, Gunicorn, Django ì—°ë™í•˜ê¸°",
        "url": "/pipenv01"
    }
    
    
    };
</script>
<script src="assets/js/lunr.js"></script>
<script src="assets/js/search.js"></script>

            </section>

        </article>

    </div>
</main>

<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->
<script>
$(function() {
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
});
</script>



        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://heuristicwave.github.io/">Heuristic Wave Blog</a> &copy; 2021</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyller/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
        <div id="subscribe" class="subscribe-overlay">
            <a class="subscribe-overlay-close" href="#"></a>
            <div class="subscribe-overlay-content">
                
                <h1 class="subscribe-overlay-title">Search on Heuristic Wave Blog</h1>
                <p class="subscribe-overlay-description">lunr.jsë¥¼ ì´ìš©í•œ posts ê²€ìƒ‰</p>
                <span id="searchform" method="post" action="/search/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()"
               id="searchtext" type="text" name="searchtext"
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
                <br>
            </div>
        </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-xxxxxxxx-x', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>
$(function() {
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
