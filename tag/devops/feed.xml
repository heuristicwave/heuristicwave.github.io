<?xml version="1.0" encoding="utf-8"?>

<feed xmlns="http://www.w3.org/2005/Atom" >
  <generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator>
  <link href="https://heuristicwave.github.io/tag/devops/feed.xml" rel="self" type="application/atom+xml" />
  <link href="https://heuristicwave.github.io/" rel="alternate" type="text/html" />
  <updated>2022-05-28T14:16:27+00:00</updated>
  <id>https://heuristicwave.github.io/tag/devops/feed.xml</id>

  
  
  

  
    <title type="html">Heuristic Wave Blog | </title>
  

  
    <subtitle>Careful Writer</subtitle>
  

  

  
    
      
    
  

  
  

  
    <entry>
      <title type="html">Using the awslogs log driver in ECS(Fargate)</title>
      <link href="https://heuristicwave.github.io/ECS_CW_Logs" rel="alternate" type="text/html" title="Using the awslogs log driver in ECS(Fargate)" />
      <published>2022-03-01T00:00:00+00:00</published>
      <updated>2022-03-01T00:00:00+00:00</updated>
      <id>https://heuristicwave.github.io/ECS_CW_Logs</id>
      <content type="html" xml:base="https://heuristicwave.github.io/ECS_CW_Logs">&lt;p&gt;ECS Taskì˜ ì»¨í…Œì´ë„ˆê°€ ìƒì‚°í•˜ëŠ” ë¡œê·¸ë“¤ì€ CloudWatchë¥¼ í™œìš©í•˜ì—¬ ìˆ˜ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
Cloudwatch Logsë¥¼ ìš´ì˜í•˜ë©° ë¡œê·¸ ì ì¬ê°€ ì œëŒ€ë¡œ ë˜ì§€ ì•Šê±°ë‚˜, Timestampê°€ ì¼ì¹˜í•˜ì§€ ì•Šê±°ë‚˜, ì§€ë‚˜ì¹œ ì§€ì—° ì‹œê°„ì´ ë°œìƒí•˜ê±°ë‚˜, ì•Œì•„ë³´ê¸° ì–´ë ¤ìš´ í˜•íƒœë¡œ ë¡œê·¸ê°€ ìŒ“ì¸ë‹¤ë©´ 
ì•„ë˜ ìš”ì†Œë“¤ì„ ê³ ë¯¼í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;-references&quot;&gt;ğŸ“š References&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.aws.amazon.com/AmazonECS/latest/developerguide/using_awslogs.html&quot;&gt;Using the awslogs log driver&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Regular_expression&quot;&gt;Regular expression Wikipedia&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;fargateì—ì„œ-í•„ìš”í•œ-awslogs-ë¡œê·¸-ë“œë¼ì´ë²„&quot;&gt;Fargateì—ì„œ í•„ìš”í•œ awslogs ë¡œê·¸ ë“œë¼ì´ë²„&lt;/h2&gt;

&lt;p&gt;ê³µì‹ ë¬¸ì„œì—ì„œëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;awslogs-region&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;awslogs-group&lt;/code&gt; ë§Œì´ í•„ìš”í•˜ë‹¤ê³  í•˜ì§€ë§Œ, &lt;strong&gt;Fargate&lt;/strong&gt;ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;awslogs-stream-prefix&lt;/code&gt;ì´ ì¶”ê°€ì ìœ¼ë¡œ í•„ìš”í•©ë‹ˆë‹¤.
ë˜í•œ, ê°€ì‹œì„±ì„ í™•ë³´í•˜ê¸° ìœ„í•´ CloudWatch Logsì— ìˆ˜ì§‘ëœ ì—¬ëŸ¬ ì¤„ì˜ ë¡œê·¸ë¥¼ í•˜ë‚˜ì˜ ë©”ì‹œì§€ë¡œ ë³´ê¸° ìœ„í•´ì„œëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;awslogs-multiline-pattern&lt;/code&gt;ì´ í•„ìˆ˜ì ìœ¼ë¡œ í•„ìš”í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;awslogs-multiline-pattern&quot;&gt;awslogs-multiline-pattern&lt;/h3&gt;

&lt;p&gt;ê³µì‹ ë¬¸ì„œì˜ Note ë¶€ë¶„ì„ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë©”ëª¨ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. &lt;em&gt;(ì •ë§ ê³µì‹ ë¬¸ì„œëŠ” í•œ ì¤„ë„ ê·¸ëƒ¥ ì§€ë‚˜ì¹  ìˆ˜ ì—†ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤!)&lt;/em&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Multiline logging performs regular expression parsing and matching of all log messages.
This may have a negative impact on logging performance.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ì‹¤ì œë¡œ ì €ëŠ” ì •ê·œ í‘œí˜„ì‹ì„ ê°„ê³¼í•˜ê³  ê²€ì¦ë˜ì§€ ì•Šì€ ì •ê·œì‹ë“¤ì„ ì ìš©í–ˆë‹¤ê°€ ë‹¤ìŒê³¼ ê°™ì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Negative Impact&lt;/code&gt;ë¥¼ ë§Œë‚¬ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ë¡œê·¸ê°€ ìˆ˜ì§‘ë˜ê¸°ê¹Œì§€ì˜ ì§€ë‚˜ì¹œ ì§€ì—° ì‹œê°„ ë°œìƒ (10ë¶„ ì´ìƒ)&lt;/li&gt;
  &lt;li&gt;ì§€ì—°ì‹œê°„ìœ¼ë¡œ ì¸í•œ Timestamp ë¶ˆì¼ì¹˜ (Ingestion timeê³¼ Event Timestampì˜ ê³¼ë„í•œ ì˜¤ì°¨)&lt;/li&gt;
  &lt;li&gt;1, 2ë²ˆ ì´ìœ ë¡œ ì¸í•œ ë¡œê·¸ ë¯¸ìˆ˜ì§‘&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;regular-expression-lab&quot;&gt;Regular Expression Lab&lt;/h2&gt;

&lt;p&gt;ì§€ê¸ˆë¶€í„° ì˜ˆì‹œë“¤ì„ í†µí•´, CW Logsë¥¼ ìš´ì˜í•˜ë©° ë§Œë‚  ìˆ˜ ìˆëŠ” ìƒí™©ë“¤ì„ ì²´í—˜í•´ ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;em&gt;ìƒ˜í”Œ ë¡œê·¸ë¥¼ ë³µì‚¬í•˜ì—¬ &lt;a href=&quot;https://regexr.com&quot;&gt;RegExr&lt;/a&gt;ì—ì„œ match ì—¬ë¶€ë¥¼ í…ŒìŠ¤íŠ¸í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;case-1ï¸âƒ£&quot;&gt;Case 1ï¸âƒ£&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;awslogs-multiline-pattern&lt;/code&gt;ì˜ &lt;strong&gt;value&lt;/strong&gt;ë¡œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;^INFO&lt;/code&gt;ë¥¼ ì„¤ì •í•  ê²½ìš° 3ê°œì˜ Line ì¤‘ match ë˜ëŠ” ë¼ì¸ì€ ëª‡ ë¼ì¸ì¼ê¹Œìš”?&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;INFO | &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;pkg/trace/info/stats.go:104 &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;LogStats&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                &lt;span class=&quot;c&quot;&gt;# Line 1&lt;/span&gt;
INFO | &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;pkg/trace/info/stats.go:104 &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;LogStats&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                &lt;span class=&quot;c&quot;&gt;# Line 2&lt;/span&gt;
12:15:10 UTC | INFO | &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;pkg/trace/info/stats.go:104 &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;LogStats&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Line 3&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;details&gt;
  &lt;summary&gt;ğŸ– ì •ë‹µ ë³´ê¸°&lt;/summary&gt;

  &lt;blockquote&gt;
    &lt;p&gt;&lt;strong&gt;INFO&lt;/strong&gt; | (pkg/trace/info/stats.go:104 in LogStats)                # Line 1&lt;/p&gt;
  &lt;/blockquote&gt;

  &lt;p&gt;^(caret) ì€ ì „ì²´ ë¬¸ìì—´ì˜ ì‹œì‘ ìœ„ì¹˜ì—ë§Œ ì¼ì¹˜í•˜ë¯€ë¡œ, Line 1 ë§Œì´ match ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;/details&gt;

&lt;h3 id=&quot;case-2ï¸âƒ£&quot;&gt;Case 2ï¸âƒ£&lt;/h3&gt;

&lt;p&gt;ë‹¤ìŒì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ì‹œ:ë¶„:ì´ˆ&lt;/code&gt;ë¥¼ í‘œí˜„í•˜ëŠ” ì •ê·œ í‘œí˜„ì‹ ì…ë‹ˆë‹¤. í•´ë‹¹ ì •ê·œ í‘œí˜„ì‹ì€ ì•„ë˜ 3ì¤„ì„ ëª¨ë‘ Match ì‹œí‚¬ ìˆ˜ ìˆì„ê¹Œìš”? &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(0[1-9]|1[0-9]|2[0-4]):(0[1-9]|[1-5][0-9]):(0[1-9]|[1-5][0-9])&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;07:36:35 | Which line will match? Line 1
08:00:01 | I am Line 2!
08:01:00 | I am Line 3!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;details&gt;
  &lt;summary&gt;ğŸ– ì •ë‹µ ë³´ê¸°&lt;/summary&gt;

  &lt;blockquote&gt;
    &lt;p&gt;&lt;strong&gt;07:36:35&lt;/strong&gt; | I was matched &lt;br /&gt;
08:00:01 | I was not matched! &lt;br /&gt;
08:01:00 | I was not matched! &lt;br /&gt;&lt;/p&gt;
  &lt;/blockquote&gt;

  &lt;p&gt;ê·¸ë ‡ë‹¤ë©´ ì™œ? ì²« ë²ˆì§¸ ë¼ì¸ë§Œì´ ë§¤ì¹­ë˜ì—ˆì„ê¹Œìš”? &lt;strong&gt;ë¶„, ì´ˆ&lt;/strong&gt;ì— í•´ë‹¹í•˜ëŠ” í‘œí˜„ì‹ì„ ìœ ì‹¬íˆ ì‚´í´ë³´ë©´ 00ë¶„ 00ì‹œëŠ” ë§¤ì¹­ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
ë•Œë¬¸ì— ê°ê° (ë¶„ : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(0[0-9]|[1-5][0-9])&lt;/code&gt;, ì´ˆ : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(0[0-9]|[1-5][0-9])&lt;/code&gt;)ë¡œ ìˆ˜ì •í•´ì•¼ ìœ„ 3ì¤„ì„ ë§¤ì¹­ ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;/details&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;other-case&quot;&gt;Other Case&lt;/h3&gt;

&lt;p&gt;ìœ„ 2ê°€ì§€ ì¼€ì´ìŠ¤ë§Œ ì¤€ë¹„ëœë‹¤ë©´ ëª¨ë“  ë¡œê·¸ë“¤ì„ ì œëŒ€ë¡œ ë¶„ë¦¬í•˜ì—¬ ìˆ˜ì§‘í•  ìˆ˜ ìˆì„ê¹Œìš”?&lt;/p&gt;

&lt;details&gt;
  &lt;summary&gt;ğŸ¤” ìƒê°í•´ë³´ê¸°&lt;/summary&gt;

  &lt;ul&gt;
    &lt;li&gt;Flagê°€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;INFO&lt;/code&gt; í˜•ì‹ì´ ì•„ë‹Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;WARN&lt;/code&gt;ì´ ë°œìƒí•  ê²½ìš°&lt;/li&gt;
    &lt;li&gt;Timestampë¡œ ë§¤ì¹­ ì‘ì—…ì„ í•˜ëŠ”ë° í•œ ì¤„ì— 1íšŒ ì´ìƒ Timestampê°€ í¬í•¨ëœ ê²½ìš°
      &lt;blockquote&gt;
        &lt;p&gt;ex) &lt;strong&gt;08:00:01&lt;/strong&gt; | Itâ€™s &lt;strong&gt;08:02:03&lt;/strong&gt; right now.&lt;/p&gt;
      &lt;/blockquote&gt;
    &lt;/li&gt;
    &lt;li&gt;Application Crashë¡œ ì¸í•œ ì˜ˆìƒì¹˜ ëª»í•œ ë©”ì‹œì§€ê°€ í¬í•¨ë  ê²½ìš°&lt;/li&gt;
    &lt;li&gt;awslogs ë¡œê·¸ ë“œë¼ì´ë²„ ë‚´ì˜ ìš°ì„ ìˆœìœ„&lt;/li&gt;
  &lt;/ul&gt;

&lt;/details&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ì•„ë§ˆë„ ìœ„ì— ê¸°ì¬í•œ ê²ƒë“¤ ì™¸ì—ë„ ë” ê³ ë ¤ í•  ê²ƒë“¤ì´ ë§ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.
ê°œë°œì´ë‚˜ ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œë¥¼ í’€ ë•Œì™€ ë§ˆì°¬ê°€ì§€ë¡œ í•­ìƒ ì˜ˆìƒì¹˜ ëª»í•œ ì‹¤íŒ¨ ì§€ì ì„ ì˜ˆìƒí•˜ëŠ” ìŠµê´€ì´ í•„ìš”í•œ ê²ƒ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;span class=&quot;table-of-contents-list&quot;&gt;ECS Error Handling and Troubleshooting&lt;/span&gt;&lt;/p&gt;
&lt;ul class=&quot;table-of-contents-list&quot;&gt;
    &lt;li&gt;&lt;a href=&quot;./ECS_Exec&quot;&gt;Using Amazon ECS Exec for debugging&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./ECS_CW_Logs&quot;&gt;Using the awslogs log driver in ECS(Fargate)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Heuristic Wave</name>
        
        
      </author>

      

      
        <category term="aws" />
      
        <category term="devops" />
      

      
        <summary type="html">ECS Taskì˜ ì»¨í…Œì´ë„ˆê°€ ìƒì‚°í•˜ëŠ” ë¡œê·¸ë“¤ì€ CloudWatchë¥¼ í™œìš©í•˜ì—¬ ìˆ˜ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Cloudwatch Logsë¥¼ ìš´ì˜í•˜ë©° ë¡œê·¸ ì ì¬ê°€ ì œëŒ€ë¡œ ë˜ì§€ ì•Šê±°ë‚˜, Timestampê°€ ì¼ì¹˜í•˜ì§€ ì•Šê±°ë‚˜, ì§€ë‚˜ì¹œ ì§€ì—° ì‹œê°„ì´ ë°œìƒí•˜ê±°ë‚˜, ì•Œì•„ë³´ê¸° ì–´ë ¤ìš´ í˜•íƒœë¡œ ë¡œê·¸ê°€ ìŒ“ì¸ë‹¤ë©´ ì•„ë˜ ìš”ì†Œë“¤ì„ ê³ ë¯¼í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Using Amazon ECS Exec for debugging</title>
      <link href="https://heuristicwave.github.io/ECS_Exec" rel="alternate" type="text/html" title="Using Amazon ECS Exec for debugging" />
      <published>2022-02-22T00:00:00+00:00</published>
      <updated>2022-02-22T00:00:00+00:00</updated>
      <id>https://heuristicwave.github.io/ECS_Exec</id>
      <content type="html" xml:base="https://heuristicwave.github.io/ECS_Exec">&lt;p&gt;Dockerì—ì„œëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exec&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ í†µí•´ ì‹¤í–‰ì¤‘ì¸ ì»¨í…Œì´ë„ˆì— ì ‘ì†í•˜ì—¬ ë””ë²„ê¹…ì´ ê°€ëŠ¥í•˜ë‹¤.
21ë…„ 3ì›” ë¶€í„° í•´ë‹¹ ê¸°ëŠ¥ì´ AWSì˜ ECSì—ì„œë„ ì‚¬ìš©ê°€ëŠ¥í•˜ê²Œ ë˜ì—ˆëŠ”ë°, í•´ë‹¹ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©° ë§Œë‚¬ë˜ ë¬¸ì œë“¤ì„ ê¸°ë¡.&lt;/p&gt;

&lt;h2 id=&quot;-references&quot;&gt;ğŸ“š References&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs-exec.html&quot;&gt;Using Amazon ECS Exec for debugging&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.aws.amazon.com/cli/latest/reference/ecs/execute-command.html&quot;&gt;AWS CLI Cmd Ref : excute-commnad&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;exec-í™œì„±í™”&quot;&gt;Exec í™œì„±í™”&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;SSM ì—ì´ì „íŠ¸ì™€ SSM ì„œë¹„ìŠ¤ ê°„ì˜ í†µì‹ ì— í•„ìš”í•œ ê¶Œí•œ ë¶€ì—¬&lt;/li&gt;
  &lt;li&gt;task-definition config ì¶”ê°€
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;&quot;linuxParameters&quot;&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;initProcessEnabled&quot;&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;CLIë¡œ execute-command enable í›„, ì ê²€
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;aws ecs create-service &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;--cluster&lt;/span&gt; cluster-name &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;--task-definition&lt;/span&gt; task-definition-name &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;--enable-execute-command&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;--service-name&lt;/span&gt; service-name &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;--desired-count&lt;/span&gt; 1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;ì•„ë˜ ëª…ë ¹ì–´ë¡œ í™œì„±í™” ì—¬ë¶€ í™•ì¸. (grep option í™œìš©, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;grep -F4 &quot;managedAgents&quot;&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;grep &quot;enableExecuteCommand&quot;&lt;/code&gt;)&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;aws ecs describe-tasks &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;--cluster&lt;/span&gt; cluster-name &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;--tasks&lt;/span&gt; task-id 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;í™œì„±í™” ìƒíƒœì¼ ë•Œì˜ Snippet&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;tasks&quot;&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            ...
            &lt;span class=&quot;s2&quot;&gt;&quot;containers&quot;&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    ...
                    &lt;span class=&quot;s2&quot;&gt;&quot;managedAgents&quot;&lt;/span&gt;: &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;
                        &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                            &lt;span class=&quot;s2&quot;&gt;&quot;lastStartedAt&quot;&lt;/span&gt;: &lt;span class=&quot;s2&quot;&gt;&quot;2021-03-01T14:49:44.574000-06:00&quot;&lt;/span&gt;,
                            &lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;s2&quot;&gt;&quot;ExecuteCommandAgent&quot;&lt;/span&gt;,
                            &lt;span class=&quot;s2&quot;&gt;&quot;lastStatus&quot;&lt;/span&gt;: &lt;span class=&quot;s2&quot;&gt;&quot;RUNNING&quot;&lt;/span&gt;
                        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;,
            ...
            &lt;span class=&quot;s2&quot;&gt;&quot;enableExecuteCommand&quot;&lt;/span&gt;: &lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;,
            ...
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Running ECS Exec
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;aws ecs execute-command &lt;span class=&quot;nt&quot;&gt;--cluster&lt;/span&gt; cluster-name &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;--task&lt;/span&gt; task-id &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;--container&lt;/span&gt; container-name &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;--interactive&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;--command&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ë¬¸ì œ-í•´ê²°&quot;&gt;ë¬¸ì œ í•´ê²°&lt;/h2&gt;

&lt;p&gt;Exec ëª…ë ¹ì–´ ì´í›„ ì—ëŸ¬ í•¸ë“¤ (ê³µì‹ ë¬¸ì„œë“¤ì— ë‹µì´ ë‹¤ ìˆì—‡ë‹¤ ğŸ˜‚)&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;An error occurred &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ClusterNotFoundException&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; when calling the ExecuteCommand operation: Cluster not found.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;Cluster ARN ê¸°ì… (From AWS CLI Ref : The Amazon Resource Name (ARN) or short name of the cluster from AWS CLI Ref)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SessionManagerPlugin is not found. Please refer to SessionManager Documentation here: http://docs.aws.amazon.com/console/systems-manager/session-manager-plugin-not-found
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;í´ë¼ì´ì–¸íŠ¸ PCì— SSM Plugin ì„¤ì¹˜ (From AWS Docs : Prerequisites for using ECS Exec)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;span class=&quot;table-of-contents-list&quot;&gt;ECS Error Handling and Troubleshooting&lt;/span&gt;&lt;/p&gt;
&lt;ul class=&quot;table-of-contents-list&quot;&gt;
    &lt;li&gt;&lt;a href=&quot;./ECS_Exec&quot;&gt;Using Amazon ECS Exec for debugging&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./ECS_CW_Logs&quot;&gt;Using the awslogs log driver in ECS(Fargate)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Heuristic Wave</name>
        
        
      </author>

      

      
        <category term="aws" />
      
        <category term="devops" />
      

      
        <summary type="html">Dockerì—ì„œëŠ” exec ëª…ë ¹ì–´ë¥¼ í†µí•´ ì‹¤í–‰ì¤‘ì¸ ì»¨í…Œì´ë„ˆì— ì ‘ì†í•˜ì—¬ ë””ë²„ê¹…ì´ ê°€ëŠ¥í•˜ë‹¤. 21ë…„ 3ì›” ë¶€í„° í•´ë‹¹ ê¸°ëŠ¥ì´ AWSì˜ ECSì—ì„œë„ ì‚¬ìš©ê°€ëŠ¥í•˜ê²Œ ë˜ì—ˆëŠ”ë°, í•´ë‹¹ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©° ë§Œë‚¬ë˜ ë¬¸ì œë“¤ì„ ê¸°ë¡.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Create Immutable Server using AWS Image Builder &amp;amp; Auto Scaling Group</title>
      <link href="https://heuristicwave.github.io/ImageBuilder" rel="alternate" type="text/html" title="Create Immutable Server using AWS Image Builder &amp; Auto Scaling Group" />
      <published>2022-02-21T00:00:00+00:00</published>
      <updated>2022-02-21T00:00:00+00:00</updated>
      <id>https://heuristicwave.github.io/ImageBuilder</id>
      <content type="html" xml:base="https://heuristicwave.github.io/ImageBuilder">&lt;p&gt;ë³¸ ê¸€ì€ 2021ë…„ 4ì›” 30ì¼ &lt;a href=&quot;https://aws.amazon.com/about-aws/whats-new/2021/04/ec2-image-builder-supports-auto-scaling-launch-template/&quot;&gt;EC2 Image Builder supports Auto Scaling launch template&lt;/a&gt;
ì— ì†Œê°œëœ ê¸°ëŠ¥ì„ í™œìš©í•´ Image Builderë¡œ Golden AMIë¥¼ ë§Œë“¤ê³ ,
í•´ë‹¹ ì´ë¯¸ì§€ë¡œ Auto Scaling Groupì˜ launch templateì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•ì„ ì†Œê°œí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;intro&quot;&gt;Intro&lt;/h1&gt;

&lt;p&gt;í´ë¼ìš°ë“œë¥¼ ë‹¤ë£¨ë‹¤ ë³´ë©´ &lt;strong&gt;Netflix&lt;/strong&gt; ê°€ ì—¬ëŸ¬ ë¶„ì•¼ì—ì„œ ì•ì¥ì„œ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ê·¸ì¤‘ì—ì„œ Immutable Server Patternì„ ì•Œë¦¬ëŠ”ë° ê¸°ì—¬í•œ 2013ë…„ì— ë°œê°„ëœ &lt;a href=&quot;https://netflixtechblog.com/ami-creation-with-aminator-98d627ca37b0&quot;&gt;AMI Creation with Aminator&lt;/a&gt;
ë¥¼ ê¼­ í•œë²ˆ ì½ì–´ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤. ê³¼ê±° ë„·í”Œë¦­ìŠ¤ëŠ” AWSì˜ ì´ë¯¸ì§€ íŒŒì¼ì„ ìƒì„±í•˜ê¸° ìœ„í•´ Aminatorë¼ëŠ” ë„êµ¬ë¥¼ ì‚¬ìš©í–ˆì§€ë§Œ,
ë³¸ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì´ë¯¸ì§€ ë¹Œë”ë¡œ AMIë¥¼ ë§Œë“¤ê³  Auto Scaling Groupì— ì ìš©ì‹œí‚¤ëŠ” ë°©ë²•ì„ ë°°ì›Œ Immutable Server Patternì„ í•™ìŠµí•´ ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;immutable-server&quot;&gt;Immutable Server&lt;/h2&gt;

&lt;p&gt;Immutable Server ëŒ€í•œ ë‚´ìš©ì€ martin fowler ë¸”ë¡œê·¸ì— ì†Œê°œëœ &lt;a href=&quot;https://martinfowler.com/bliki/ImmutableServer.html&quot;&gt;ImmutableServer&lt;/a&gt;
ê¸€ì„ ë³´ì‹œë©´ êµ‰ì¥íˆ ì˜ ì„¤ëª…ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ìš”ì•½ + ê·¸ë™ì•ˆì˜ ì œ ë‡Œí”¼ì…œì„ í•¨ê»˜ ë§ì”€ë“œë¦¬ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì„œë²„ë¥¼ ìš´ì˜í•˜ë‹¤ ë³´ë©´ ì—…ë°ì´íŠ¸ë¥¼ ë¹„ë¡¯í•œ ë‹¤ì–‘í•œ ì´ìŠˆë“¤ë¡œ ì¸í•´ êµ¬ì„±ìš”ì†Œê°€ ìì£¼ ë³€í•˜ê²Œ ë©ë‹ˆë‹¤.
ê·¸ë ‡ê²Œ ìš´ì˜í•˜ë‹¤ ë³´ë©´ ë¬´ì–¸ê°€ ê¼¬ì—¬ ì„œë²„ë¥¼ ì¬ ìƒì„±í•˜ëŠ” ì¼ì´ ë°œìƒí•˜ëŠ”ë° ì•„ë˜ì™€ ê°™ì€ ë¼ì´í”„ ì‚¬ì´í´ì„ ë§Œë‚˜ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://martinfowler.com/bliki/images/immutableServer/PhoenixServerLifecycle.png&quot; alt=&quot;phoenixServerLifecycle&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì´ëŸ° ìƒí™©ì—ì„œ êµ¬ì„±ì´ ë‹¤ë¥¸ ì—¬ëŸ¬ ëŒ€ì˜ ì„œë²„ë¥¼ ê°€ì§€ê²Œ ë˜ë©´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Configuration drift&lt;/code&gt;ê°€ ë°œìƒí–ˆë‹¤ê³  í‘œí˜„í•©ë‹ˆë‹¤.
ë˜í•œ ìœ„ ê·¸ë¦¼ì²˜ëŸ¼ ìê¾¸ ìƒˆë¡œìš´ ì´ë¯¸ì§€ë¡œ íšŒê·€í•˜ë‹ˆê¹Œ, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Shift Left&lt;/code&gt;ë¼ê³ ë„ í‘œí˜„í•˜ê³  ì´ë¥¼ í•œêµ­ì–´ë¡œ í‘œí˜„í•˜ëŠ” ë§ì„ ì°¾ì•„ë³´ë‹ˆ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ì›ì  íšŒê·€&lt;/code&gt;ë¼ëŠ” í‘œí˜„ë„ ì“°ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;êµ¬ì„± ë³€ê²½ì´ ì¦ì€ ì„œë²„ëŠ” ê¹¨ì§€ê¸°(fragile) ì‰½ê³ , ë˜ ì¥ì• ê°€ ë°œìƒí•  ê²½ìš° ì¬í˜„ì´ ì–´ë ¤ìš¸ë¿ë”ëŸ¬ ë³€ê²½ ì‹œ ì—°ì‡„ì ì¸ ì¥ì• ë¥¼ ìœ ë°œí•  ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.
ì´ë¥¼ ë‘ê³  ê¹¨ì§€ê¸° ì‰¬ìš´ ëˆˆì†¡ì´ ê°™ë‹¤ í•˜ì—¬ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Snowflake Server&lt;/code&gt;ë¼ ë¶€ë¦…ë‹ˆë‹¤.
ì´ ìƒí™©ì„ í”¼í•˜ê¸° ìœ„í•´, Configuration driftë¥¼ í”¼í•˜ëŠ” Base Image(Configurationì´ ë°œìƒí•˜ë©´ ìƒˆë¡­ê²Œ ìƒì„±)ë¥¼ í™œìš©í•œ ë°©ë²•ì„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Phoenix Server&lt;/code&gt;
ë¼ ë¶€ë¦…ë‹ˆë‹¤. &lt;em&gt;(&lt;a href=&quot;https://martinfowler.com/bliki/PhoenixServer.html&quot;&gt;Phoenix Server&lt;/a&gt; ìš©ì–´ëŠ” ë§ˆí‹´ íŒŒìš¸ëŸ¬ì˜ ë™ë£Œ &lt;a href=&quot;https://twitter.com/kornys&quot;&gt;Kornelis Sietsma&lt;/a&gt; ê°€ ì œì•ˆí–ˆë‹¤ í•©ë‹ˆë‹¤.)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/post/imagebuilder/immutableServer.png&quot; alt=&quot;immutableServer&quot; /&gt;&lt;/p&gt;

&lt;p&gt;í”¼ë‹‰ìŠ¤ ì„œë²„ì˜ ê°œë…ì€ ê¸°ë³¸ ì´ë¯¸ì§€(Base AMI, Golden AMI)ë¥¼ í†µí•´ ì–¸ì œë‚˜ ì¼ê´€ì„± ìˆëŠ” í™˜ê²½ì„ ì œê³µí–ˆê³ ,
ì´ëŸ¬í•œ ê°œë…ë“¤ì´ ìì—°ìŠ¤ëŸ½ê²Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Immutable Server&lt;/code&gt;ì˜ ê°œë…ìœ¼ë¡œ ì´ì–´ì¡ŒìŠµë‹ˆë‹¤.
&lt;em&gt;(ìµœê·¼ì—ëŠ” Immutable Serverë¥¼ ë„˜ì–´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Immutable Infrastructure&lt;/code&gt;ì˜ ê°œë…ë„ ìˆìŠµë‹ˆë‹¤!)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ì´ë¯¸ì§€-ë¹Œë”ì™€-ì˜¤í† -ìŠ¤ì¼€ì¼-ê·¸ë£¹ìœ¼ë¡œ-ì´ë®¤í„°ë¸”-ì„œë²„-êµ¬ì¶•í•˜ê¸°&quot;&gt;ì´ë¯¸ì§€ ë¹Œë”ì™€ ì˜¤í†  ìŠ¤ì¼€ì¼ ê·¸ë£¹ìœ¼ë¡œ ì´ë®¤í„°ë¸” ì„œë²„ êµ¬ì¶•í•˜ê¸°&lt;/h2&gt;

&lt;p&gt;í´ë¼ìš°ë“œì—ì„œì˜ Immutable Server Pattern ê²€ìƒ‰í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ì¢‹ì€ ì˜ˆì‹œë“¤ì´ ë‚˜ì˜µë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://aws.amazon.com/ko/blogs/mt/create-immutable-servers-using-ec2-image-builder-aws-codepipeline/&quot;&gt;Create immutable servers using EC2 Image Builder and AWS CodePipeline&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cloudblogs.microsoft.com/opensource/2018/05/23/immutable-infrastructure-azure-vsts-terraform-packer-ansible/&quot;&gt;Tutorial: Immutable infrastructure for Azure, using VSTS, Terraform, Packer and Ansible&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://learn.hashicorp.com/tutorials/terraform/packer&quot;&gt;Provision Infrastructure with Packer&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://heuristicwave.github.io/Packer&quot;&gt;í•˜ì‹œì½”í”„ íŠœí† ë¦¬ì–¼ì„ ë³´ê³  ë§Œë“  í•„ìì˜ ë¸”ë¡œê·¸ ğŸ¥²&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ê·¸ëŸ¬ë‚˜ ì´ì œë¶€í„° ë‹¤ë£°, ì´ë¯¸ì§€ ë¹Œë”ì™€ ì˜¤í†  ìŠ¤ì¼€ì¼ ê·¸ë£¹ìœ¼ë¡œ ì´ë®¤í„°ë¸” ì„œë²„ íŒ¨í„´ì„ ë§Œì¡±ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
AWSì—ì„œ ì œê³µí•˜ëŠ” AutoScaleì€ íƒ„ë ¥ì ì¸ í™•ì¥ê³¼ ì¶•ì†Œë¥¼ ì œê³µí•˜ì§€ë§Œ Desired Capacity ê¸°ëŠ¥ì„ í™œìš©í•´ í•­ìƒ ë™ì¼í•œ ì„œë²„ì˜ ìˆ˜ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/background/imagebuilder.png&quot; alt=&quot;imageBuilder&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Image Builderì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Image pipelines&lt;/code&gt;ë¥¼ í™œìš©í•´ ì›ë³¸ AMIë¡œë¶€í„° ì›í•˜ëŠ” í˜•íƒœì˜ Output(Custom/Golden/Base AMI)ì„ ì œì‘í•©ë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Distribution settings&lt;/code&gt;ì„ í†µí•´ lt(Launch Template)ì— 1ë²ˆì—ì„œ ìƒì„±í•œ AMIë¡œ êµì²´í•˜ì—¬ ìƒˆë¡œìš´ ë²„ì „ì„ ë§Œë“­ë‹ˆë‹¤.&lt;/li&gt;
  &lt;li&gt;ì´ì œ, ìƒˆë¡­ê²Œ ìƒì„±ë˜ëŠ” ASG(Auto Scaling Group)ì€ ìƒˆë¡­ê²Œ ë²„ì „ ì—…ëœ ltë¥¼ í†µí•´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;em&gt;3ë²ˆì˜ ASGì˜ ê²½ìš°, Refreshë¥¼ í•˜ê¸° ì „ê¹Œì§€ëŠ” ì´ì „ ìƒíƒœì˜ ltë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¸ìŠ¤í„´ìŠ¤ê°€ ìš´ì˜ë˜ê³  ìˆìŠµë‹ˆë‹¤.
ì´ë¯¸ì§€ ìƒì„±ê³¼ ë™ì‹œì— ìƒˆë¡œìš´ AMIë¡œ EC2 Refreshë¥¼ í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ìˆì§€ë§Œ,
ìƒˆë¡­ê²Œ ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤ê°€ ìš´ì˜í™˜ê²½ì— ë°”ë¡œ ì ìš©ë˜ëŠ” ê²ƒì€ ë°”ëŒì§í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ í•´ë‹¹ ë¶€ë¶„ì— ëŒ€í•œ ìë™í™”ëŠ” ì œì™¸í•˜ì˜€ìŠµë‹ˆë‹¤.
ë§Œì•½ ê²€ì¦ëœ AMIë¥¼ ìƒì„±í•œë‹¤ë©´, Lambda í˜¹ì€ ê¸°íƒ€ ë°©ë²• ë“±ì„ í†µí•´ Refresh í•˜ì—¬ ì´ë¯¸ì§€ ìƒì„±ë¶€í„° ë°°í¬ê¹Œì§€ ìë™í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;ì¶”í›„ ë‹¤ë¥¸ í¬ìŠ¤íŒ…ì—ì„œ ìì„¸íˆ ë‹¤ë£° ì˜ˆì •ì´ì§€ë§Œ, ì´ëŸ¬í•œ íŒ¨í„´ì€ Immutable Infrastructureì˜ í•œ ìš”ì†Œë¥¼ ì´ë£¨ê¸°ë„ í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;-workshop&quot;&gt;ğŸ“œ Workshop&lt;/h2&gt;

&lt;h3 id=&quot;0ï¸âƒ£-launch-template--auto-scaling-groups-ìƒì„±&quot;&gt;0ï¸âƒ£ Launch Template &amp;amp; Auto Scaling groups ìƒì„±&lt;/h3&gt;

&lt;p&gt;ê¸°ì¡´ í™˜ê²½ì— 0ï¸âƒ£ì´ ì¤€ë¹„ë˜ì–´ ìˆë‹¤ë©´ ë‹¤ìŒ ë‹¨ê³„ì¸ &lt;strong&gt;Distribution settings&lt;/strong&gt;ìœ¼ë¡œ ë„˜ì–´ê°€ë„ ì¢‹ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ ë‹¨ê³„ëŠ” ì œê°€ êµ‰ì¥íˆ ê²Œìœ¼ë¥¸ ê´€ê³„ë¡œ AWS Documentation : &lt;a href=&quot;https://docs.aws.amazon.com/autoscaling/ec2/userguide/create-asg-launch-template.html&quot;&gt;Creating an Auto Scaling group using a launch template&lt;/a&gt;
ìœ¼ë¡œ ëŒ€ì²´í•˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ğŸ’¡ ë§Œì•½ ê¸°ì¡´ í™˜ê²½ì´ Launch Templateì´ ì•„ë‹Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Launch Configurations&lt;/code&gt;ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆì„ ê²½ìš°,
ì½˜ì†” í™”ë©´ì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Copy to launch template&lt;/code&gt; ë²„íŠ¼ì„ ëˆ„ë¥´ì‹œë©´ ì†ì‰½ê²Œ ltë¡œ ë³€ê²½ ê°€ëŠ¥í•©ë‹ˆë‹¤. &lt;br /&gt;
ğŸ’¡ Launch Templateê³¼ Launch ConfigurationsëŠ” êµ‰ì¥íˆ ìœ ì‚¬í•˜ì§€ë§Œ, Launch Templateì˜ ê²½ìš° ë” ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤ì„ ì œê³µí•©ë‹ˆë‹¤.
íŠ¹íˆ ë²„ì „ê´€ë¦¬ ê¸°ëŠ¥ì„ í†µí•´ Rollbackì„ í•˜ê±°ë‚˜, ì—…ë°ì´íŠ¸ì‹œ ASGë¥¼ í™œìš©í•œ Rolling Updateê°€ ê°€ëŠ¥í•´ Launch Template ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;1ï¸âƒ£-distribution-settings&quot;&gt;1ï¸âƒ£ Distribution settings&lt;/h3&gt;

&lt;p&gt;EC2 Image Builder ì½˜ì†” í™”ë©´ì— ì ‘ì†í•´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Distribution settings&lt;/code&gt;ì—ì„œ ìƒˆë¡œìš´ ì„¸íŒ…ì„ ìƒì„±í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/post/imagebuilder/distribution.png&quot; alt=&quot;distribution&quot; /&gt;&lt;/p&gt;

&lt;p&gt;í•„ìˆ˜ í•­ëª©ì¸ ì´ë¦„ì„ ì‘ì„±í•˜ê³  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Region settings&lt;/code&gt;ì—ì„œ ë°°í¬í•  ë¦¬ì „ì„ í™•ì¸í•œ í›„,
í•˜ë‹¨ì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Launch template configuration&lt;/code&gt;ì—ì„œ Step 0ï¸âƒ£ì—ì„œ ì‘ì„±í•œ ltë¥¼ ì§€ì •í•˜ê³  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;create settings&lt;/code&gt;ë¡œ ìƒì„±í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;2ï¸âƒ£-image-pipelines&quot;&gt;2ï¸âƒ£ Image pipelines&lt;/h3&gt;

&lt;h4 id=&quot;step-1&quot;&gt;Step 1&lt;/h4&gt;

&lt;p&gt;Distribution settings ì‘ì„±ì´ ì™„ë£Œë˜ì—ˆë‹¤ë©´, ì½˜ì†”ì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Image pipelines&lt;/code&gt;ì— ì ‘ì†í•˜ì—¬ ì•„ë˜ ì •ë³´ë“¤ì„ ê¸°ì¬í•©ë‹ˆë‹¤.
ì•„ë˜ ì‚¬ì§„ì˜ ì¢Œì¸¡ Step 5ê¹Œì§€ì˜ ê³¼ì •ì„ ê±°ì¹˜ë©´ ëª©í‘œë¡œ í–ˆë˜ í™˜ê²½ì´ ì™„ì„±ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/post/imagebuilder/imagepipeline.png&quot; alt=&quot;pipeline&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Build schedule&lt;/code&gt;ì—ì„œëŠ” ì£¼ê¸°ì ìœ¼ë¡œ íŒŒì´í”„ë¼ì¸ì„ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ë°©ë²•ë“¤ì„ ì œê³µí•˜ëŠ”ë° ìš´ì˜ìê°€ ì›í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h4 id=&quot;step-2&quot;&gt;Step 2&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Choose recipe&lt;/code&gt; ë‹¨ê³„ì—ì„œëŠ” ê¸°ì¡´ì— ë§Œë“¤ì–´ë‘” &lt;strong&gt;recipe&lt;/strong&gt;ê°€ ì—†ìœ¼ë¯€ë¡œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Create new recipe&lt;/code&gt;ë¥¼ ì„ íƒí•˜ê³ , &lt;strong&gt;Image type&lt;/strong&gt;ìœ¼ë¡œ &lt;strong&gt;AMI&lt;/strong&gt;ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë‹¤ìŒ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Base image&lt;/code&gt;ë¥¼ ê³ ë¥´ëŠ” ë‹¨ê³„ì—ì„œëŠ” ì•„ë˜ í™”ë©´ê³¼ ê°™ì´ &lt;strong&gt;ê´€ë¦¬í˜• ì´ë¯¸ì§€&lt;/strong&gt;ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ ê¸°ì¡´ì— ì‘ì„±í•œ &lt;strong&gt;Custom AMI ID&lt;/strong&gt;ë¥¼ ì‚¬ìš©í•´ë„ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/post/imagebuilder/baseimage.png&quot; alt=&quot;baseimage&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ê·¸ë‹¤ìŒ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Instance configuration&lt;/code&gt;ì™€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Working directory&lt;/code&gt;ì—ì„œëŠ” &lt;strong&gt;ê¸°ë³¸ ê°’&lt;/strong&gt;ìœ¼ë¡œ ë‘¬ë„ ìƒê´€ì—†ì§€ë§Œ
&lt;strong&gt;SSM, User data, Working directory path&lt;/strong&gt;ì˜ í•„ìš” ì—¬ë¶€ì— ë”°ë¼ í™œìš©í•˜ì‹œë©´ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ì–´ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Components&lt;/code&gt;ì—ì„œëŠ” Golden AMIë¥¼ êµ¬ì¶•í•˜ê¸° ìœ„í•´ ì„ í–‰ë˜ì–´ì•¼ í•˜ëŠ” ê°ì¢… Agentë‚˜ ì†Œí”„íŠ¸ì›¨ì–´(Apache, dotnet etc)ë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì €ëŠ” í¸ì˜ìƒ CloudWatch Agentë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/post/imagebuilder/components.png&quot; alt=&quot;components&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ê·¸ë‹¤ìŒ ì´ì–´ì§€ëŠ” &lt;strong&gt;Test components, Storage, Tags&lt;/strong&gt; ì—­ì‹œ í•„ìš” ì—¬ë¶€ì— ë”°ë¼ í™œìš©í•˜ì‹œë©´ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h4 id=&quot;step-3&quot;&gt;Step 3&lt;/h4&gt;

&lt;p&gt;3ë‹¨ê³„ì— ì§„ì…í•˜ë©´ ì•„ë˜ ì‚¬ì§„ê³¼ ê°™ì´ ì´ë¯¸ì§€ ë¹Œë”ì˜ ì¸í”„ë¼ Config ê°’ë“¤ì„ ì •ì˜í•  ìˆ˜ ìˆëŠ” ê³µê°„ì´ ë‚˜ì˜µë‹ˆë‹¤.
3ë²ˆì§¸ ë²„íŠ¼ì¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Create New infrastructure configuration&lt;/code&gt;ìœ¼ë¡œ ì§ì ‘ ì¸ìŠ¤í„´ìŠ¤ ìœ í˜•, ë„¤íŠ¸ì›Œí¬, SNS topicì„ ì„¤ì •ì´ ê°€ëŠ¥í•˜ì§€ë§Œ,
ì €ëŠ” 1ë²ˆ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Create infrastructure configuration using service defaults&lt;/code&gt;ë¡œ ê¸°ë³¸ êµ¬ì„± ê°’ë“¤ì„ ì¡ì•„ì£¼ì—ˆìŠµë‹ˆë‹¤.
(IAM Roleê³¼ SNS Topicë„ ìë™ìœ¼ë¡œ ìƒì„±í•´ ì£¼ê³  êµ‰ì¥íˆ í¸ë¦¬í•˜ë„¤ìš”.)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/post/imagebuilder/defineconfig.png&quot; alt=&quot;config&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;step-4&quot;&gt;Step 4&lt;/h4&gt;

&lt;p&gt;ë“œë””ì–´, ì´ì „ &lt;strong&gt;1ï¸âƒ£ Distribution settings&lt;/strong&gt; ê³¼ì •ì—ì„œ ë§Œë“¤ì–´ë‘” &lt;strong&gt;ë°°í¬ ì„¤ì •&lt;/strong&gt; í•´ë‹¹ ë‹¨ê³„ì—ì„œ ì„ íƒí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/post/imagebuilder/associatelt.png&quot; alt=&quot;asso&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;step-5&quot;&gt;Step 5&lt;/h4&gt;

&lt;p&gt;Review ë‹¨ê³„ê¹Œì§€ êµ¬ì„± ìš”ì†Œë“¤ì„ ê²€í† í•´ ë³´ê³  Create pipelineì„ ëˆ„ë¥´ê³  Image pipelines ì½˜ì†”ë¡œ ëŒì•„ì˜¤ë©´ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ì„ ë§Œë‚˜ê²Œ ë©ë‹ˆë‹¤.
ì•„ë˜ ìº¡ì²˜í™”ë©´ì˜ ê²½ìš° ì´ë¯¸ ë¹Œë“œê°€ ëë‚œ ìƒíƒœì´ì§€ë§Œ, í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ì„œ &lt;strong&gt;Actions - Run pipeline&lt;/strong&gt; ë‹¨ê³„ë¥¼ ê±°ì¹˜ë©´,
ec2 ì½˜ì†”ì—ì„œ image buildë¥¼ ìœ„í•œ builder ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ê³  ì¢…ë£Œë˜ëŠ” ê²ƒì„ ê³¼ì •ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/post/imagebuilder/imgconsole.png&quot; alt=&quot;console&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;3ï¸âƒ£-review&quot;&gt;3ï¸âƒ£ Review&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;EC2 - Images - AMIs&lt;/strong&gt;ì—ì„œ ìƒˆë¡­ê²Œ ìƒì„±ëœ AMI í™•ì¸&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;EC2 - Launch templates&lt;/strong&gt;ì—ì„œ ìƒˆë¡­ê²Œ ë²„ì „ì´ ì˜¬ë¼ê°„ lt í™•ì¸, ì—¬ê¸°ì„œ Versions ì •ë³´ë¥¼ ëˆ„ë¥´ë©´ Image Builderê°€ ìƒì„±í•œ Descriptionì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
&lt;img src=&quot;../../assets/built/images/post/imagebuilder/version.png&quot; alt=&quot;version&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;ì œëŒ€ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ê¸°ì¡´ì˜ EC2 í•˜ë‚˜ë¥¼ ì¢…ë£Œì‹œí‚¤ë©´, ì €ì˜ ê²½ìš° ASGì˜ Desiredê°€ 2ë¡œ ì„¤ì •í–ˆìœ¼ë¯€ë¡œ í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒˆë¡œìš´ ë²„ì „ìœ¼ë¡œ ë³€ê²½ë©ë‹ˆë‹¤.
ì´ëŠ” &lt;strong&gt;EC2 - Auto Scaling groups&lt;/strong&gt;ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
&lt;img src=&quot;../../assets/built/images/post/imagebuilder/asg.png&quot; alt=&quot;asg&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;4ï¸âƒ£-clean-up&quot;&gt;4ï¸âƒ£ Clean Up&lt;/h3&gt;

&lt;p&gt;ë¶„í•´ëŠ” ì¡°ë¦½ì˜ ì—­ìˆœìœ¼ë¡œ?! 2ï¸âƒ£ -&amp;gt; 1ï¸âƒ£ -&amp;gt; 0ï¸âƒ£ ì—­ìˆœìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ ì •ë¦¬í•˜ê³  3ï¸âƒ£ Review í•­ëª©ì„ ì ê²€í•˜ì—¬ ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€ íšŒìˆ˜ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;outro&quot;&gt;Outro&lt;/h2&gt;

&lt;p&gt;ì§€ê¸ˆê¹Œì§€ ê°ì¢… ì´ì•¼ê¸° ê±°ë¦¬ë“¤ê³¼ EC2 Image Builderë¥¼ ì‚¬ìš©í•˜ë©° Immutable Server Patternì„ í•™ìŠµí•´ ë³´ì•˜ìŠµë‹ˆë‹¤.
ê³¼ê±° ì œê°€ Packerë¡œ ê´€ë ¨ í™˜ê²½ì„ êµ¬ì¶•í•œ ì ì´ ìˆëŠ”ë°, ì—­ì‹œ AWS í™˜ê²½ì—ì„œëŠ” AWSì˜ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²Œ ì—°ê³„ë„ ìš©ì´í•˜ê³  êµ¬ì¶•ë„ ì‰½ë„¤ìš”.&lt;/p&gt;

&lt;p&gt;ì†Œì¤‘í•œ ì‹œê°„ì„ ë‚´ì–´ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ì˜ëª»ëœ ë‚´ìš©ì€ ì§€ì í•´ ì£¼ì„¸ìš”! ğŸ˜ƒ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ğŸ“š References&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ê¸€ ì¤‘ê°„ì¤‘ê°„ í•˜ì´í¼ ë§í¬ë¡œ Reference ë“¤ì„ ë‹¬ì•„ë‘ì—ˆìŠµë‹ˆë‹¤.
íŠ¹íˆ, ì´ë²ˆ í¬ìŠ¤íŒ… ë ˆí¼ëŸ°ìŠ¤ë“¤ì€ ì¢‹ì€ ë‚´ìš©ë“¤ì´ ë§ìœ¼ë‹ˆ ì›ë³¸ë“¤ì„ ì½ì–´ë³´ì‹œê³  ë‹¹ì‹œ ì œê°€ ëŠë‚€ ê¸°ì¨ë“¤ì„ í•¨ê»˜ ëŠë‚„ìˆ˜ ìˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Heuristic Wave</name>
        
        
      </author>

      

      
        <category term="aws" />
      
        <category term="devops" />
      

      
        <summary type="html">ë³¸ ê¸€ì€ 2021ë…„ 4ì›” 30ì¼ EC2 Image Builder supports Auto Scaling launch template ì— ì†Œê°œëœ ê¸°ëŠ¥ì„ í™œìš©í•´ Image Builderë¡œ Golden AMIë¥¼ ë§Œë“¤ê³ , í•´ë‹¹ ì´ë¯¸ì§€ë¡œ Auto Scaling Groupì˜ launch templateì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•ì„ ì†Œê°œí•©ë‹ˆë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Terraform Tips 2 - Data &amp;amp; Index</title>
      <link href="https://heuristicwave.github.io/TerraformTips2" rel="alternate" type="text/html" title="Terraform Tips 2 - Data &amp; Index" />
      <published>2022-01-02T00:00:00+00:00</published>
      <updated>2022-01-02T00:00:00+00:00</updated>
      <id>https://heuristicwave.github.io/TerraformTips2</id>
      <content type="html" xml:base="https://heuristicwave.github.io/TerraformTips2">&lt;p&gt;Terraform ë” ìµìˆ™í•˜ê²Œ 2 - Data &amp;amp; Index&lt;/p&gt;

&lt;h2 id=&quot;intro&quot;&gt;Intro&lt;/h2&gt;

&lt;p&gt;ì´ë²ˆ í¬ìŠ¤íŒ…ì€ Tipì´ë¼ í•˜ê¸°ì—ëŠ” ë¶€ë„ëŸ¬ìš´ ì‚¬ì†Œí•œ ì§€ì‹ì´ì§€ë§Œ, ì œê°€ ìì£¼ ì‹¤ìˆ˜ í•˜ëŠ” ë‚´ìš©ì´ë¼ ê¸€ë¡œ ë‚¨ê¸°ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. &lt;strong&gt;Terraform Data&lt;/strong&gt;ë¥¼ ì˜ í™œìš©í•˜ë©´ ë””ìŠ¤í¬ ì´ë¯¸ì§€, ì½”ë“œë¡œ ì •ì˜í•œ ë‹¤ì–‘í•œ ë¦¬ì†ŒìŠ¤ ë° í´ë¼ìš°ë“œ ê³µê¸‰ì APIì—ì„œ ê°€ì ¸ì˜¨ ì •ë³´ë“¤ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ëª¨ë“  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Data Sources&lt;/code&gt;ê°€ ë™ì¼í•œ ë°©ë²•ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ì¡°íšŒí•  ìˆ˜ ìˆìœ¼ë©´ ì¢‹ê² ì§€ë§Œ, ë§‰ìƒ ì‚¬ìš©í•˜ë ¤ê³  í•˜ë©´ ì´ëŸ° ì €ëŸ° ë¬¸ì œë“¤ì„ ë§Œë‚˜ê²Œ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê³µì‹ë¬¸ì„œ(&lt;a href=&quot;https://learn.hashicorp.com/tutorials/terraform/data-sources&quot;&gt;Tutorial : Query Data Sources&lt;/a&gt;) ì—ì„œë„ Data í™œìš©ë°©ë²•ì„ ë°°ìš¸ ìˆ˜ ìˆì§€ë§Œ,
ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” 3ê°€ì§€ ì˜ˆì œì™€ í•¨ê»˜ ë¦¬ì†ŒìŠ¤ë¥¼ Queryí•˜ëŠ” ë°©ë²•ì„ ë°°ì›Œ ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;query-ami&quot;&gt;Query AMI&lt;/h2&gt;

&lt;p&gt;AWSì˜ ìµœì‹  AMIëŠ” ì£¼ê¸°ì ìœ¼ë¡œ ê°±ì‹ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸° ìœ„í•´, í•­ìƒ ìµœì‹  AMIë¥¼ ì°¸ì¡°í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ”ë° ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;data &lt;span class=&quot;s2&quot;&gt;&quot;aws_ami&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;amazon_linux&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  most_recent &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;true

  &lt;/span&gt;owners &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;amazon&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;

  filter &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    name   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;
    values &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;amzn2-ami-kernel-*-hvm-*-x86_64-gp2&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

  filter &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    name   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;owner-alias&quot;&lt;/span&gt;
    values &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;amazon&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

output &lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  value &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; data.aws_ami.amazon_linux.id
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì™€ ê°™ì€ ë°©ë²•ìœ¼ë¡œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;filter&lt;/code&gt;ì™€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;owners&lt;/code&gt; ê°’ì„ ì¡°ì •í•˜ë©° ì–´ë–¤ ì´ë¯¸ì§€ë“ ì§€ id ê°’(output)ì„ ì–»ì–´ ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì˜ˆë¥¼ ë“¤ì–´ ECSì™€ EKSì—ì„œ Optimized AMIë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ë‹¤ìŒê³¼ ê°™ì€ filter ê°’ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;values = [â€œamzn2-ami-ecs-hvm-*-x86_64-ebsâ€]&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;query-az&quot;&gt;Query AZ&lt;/h2&gt;

&lt;p&gt;AWSì˜ ë¦¬ì „ë§ˆë‹¤ ì‚¬ìš©ê°€ëŠ¥í•œ azê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì—, ì¡°ê¸ˆ ë” ìœ ì—°í•œ ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸° ìœ„í•´ ë‹¤ìŒ ì½”ë“œë¥¼ ì‚¬ìš©í•´ ì‚¬ìš©ê°€ëŠ¥í•œ azë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.
ì´í›„, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;data.&amp;lt;NAME&amp;gt;.&amp;lt;ATTRIBUTE&amp;gt;.names&lt;/code&gt; ë¡œ ì‚¬ìš©ê°€ëŠ¥í•œ az ê°’ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;data &lt;span class=&quot;s2&quot;&gt;&quot;aws_availability_zones&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;available&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  state &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;available&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;output &lt;span class=&quot;s2&quot;&gt;&quot;azs&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
 value &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; data.aws_availability_zones.available.names
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;names&lt;/code&gt;ì—ëŠ” ì‚¬ìš©ê°€ëŠ¥í•œ azê°€ ë°°ì—´ í˜•íƒœë¡œ ë“¤ì–´ê°€ ìˆì–´, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;names[0]&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;names[1]&lt;/code&gt;ê³¼ ê°™ì´ Index ê°’ìœ¼ë¡œ íŠ¹ì • ê°’ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ê·¸ëŸ¬ë‚˜, ëª¨ë“  dataê°€ Index ê°’ì„ ê°€ì§€ê³  ìˆëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;query-vpc_id&quot;&gt;Query vpc_id&lt;/h2&gt;

&lt;p&gt;ë‹¤ë¥¸ ë¦¬ì†ŒìŠ¤ì™€ AWS ì†”ë£¨ì…˜ë“¤ì„ ì—°ê³„í•˜ê¸° ìœ„í•´ì„œëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vpc_id&lt;/code&gt; ê°’ì´ í•„ìˆ˜ì ìœ¼ë¡œ ë“¤ì–´ê°‘ë‹ˆë‹¤.
vpcì˜ idë¥¼ êµ¬í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ idë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
(tags ê°’ì„ í™œìš©í•´ ì¼ì¢…ì˜ í•„í„°ë§ì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.)&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;data &lt;span class=&quot;s2&quot;&gt;&quot;aws_vpcs&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;vpcs&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    tags &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        Name &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; var.vpc_name
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

output &lt;span class=&quot;s2&quot;&gt;&quot;vpc_id&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    value &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; data.aws_vpcs.vpcs.ids
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ ì½”ë“œë¡œ ë‹¤ìŒê³¼ ê°™ì´ Output ê°’ì„ ì–»ì„ ìˆ˜ ìˆì§€ë§Œ, í•˜ë‚˜ì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;az&lt;/code&gt; ê°’ì„ ì–»ì„ë•Œì™€ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ids[0]&lt;/code&gt; í˜•ì‹ìœ¼ë¡œ ê°’ì„ ì¡°íšŒí•˜ë ¤ í•˜ë©´,
â€œThis value does not have any indices.â€ ë¼ëŠ” ì—ëŸ¬ ë©”ì‹œì§€ì™€ í•¨ê»˜ ì¶œë ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Changes to Outputs:
  + vpc_id &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;
      + &lt;span class=&quot;s2&quot;&gt;&quot;vpc-0x1234567890&quot;&lt;/span&gt;,
    &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë„ëŒ€ì²´ ë¬´ì—‡ì´ ì˜ëª»ëœ ê²ƒì¼ê¹Œìš”? azì™€ ë™ì¼í•œ ë°©ë²•ìœ¼ë¡œ ì ‘ê·¼í–ˆì§€ë§Œ, ì™œ ì§€ì›í•˜ì§€ ì•ŠëŠ”ì§€ëŠ” ì•„ì§ê¹Œì§€ë„ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤â€¦
ëˆ„êµ¬ ì•„ì‹œëŠ” ë¶„ì´ ìˆë‹¤ë©´ ì•Œë ¤ì£¼ì„¸ìš”.&lt;/p&gt;

&lt;h3 id=&quot;countë¡œ-index-ë¶€ì—¬í•˜ê¸°&quot;&gt;countë¡œ index ë¶€ì—¬í•˜ê¸°&lt;/h3&gt;

&lt;p&gt;ìœ„ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” azë¥¼ ê²€ìƒ‰í•  ë•Œë³´ë‹¤ëŠ” ë¶ˆí¸í•˜ì§€ë§Œ, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;count&lt;/code&gt;ë¥¼ ì‚¬ìš©í•´ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;data &lt;span class=&quot;s2&quot;&gt;&quot;aws_vpc&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;target&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  count &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; length&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;data.aws_vpcs.vpcs.ids&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; tolist&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;data.aws_vpcs.vpcs.ids&lt;span class=&quot;o&quot;&gt;)[&lt;/span&gt;count.index]
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# sample code using vpc_id&lt;/span&gt;
resource &lt;span class=&quot;s2&quot;&gt;&quot;aws_lb_target_group&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sample_resource&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  count &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; length&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;data.aws_vpcs.vpcs.ids&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# Skip Config&lt;/span&gt;
  vpc_id      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; data.aws_vpc.target[count.index].id
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;aws_vpcs&lt;/code&gt;ê°€ ì•„ë‹Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;aws_vpc&lt;/code&gt;ë¥¼ ì¶”ê°€í•˜ê³  index ë¥¼ ë¶€ì—¬í•˜ê¸° ìœ„í•œ ë‚´ì¥ í•¨ìˆ˜ë“¤ì„ ì‚¬ìš©í•´ indexë¥¼ ë¶€ì—¬í•©ë‹ˆë‹¤.
ì´í›„, ë¦¬ì†ŒìŠ¤ì—ì„œ data ê°’ë“¤ì„ ì‹ë³„í•˜ê¸° ìœ„í•œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;count&lt;/code&gt;ë¥¼ ê¸°ì…í•˜ê³  ìœ„ì™€ ê°™ì´ index ê°’ìœ¼ë¡œ ì¡°íšŒê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;outro&quot;&gt;Outro&lt;/h2&gt;

&lt;p&gt;ì§€ê¸ˆê¹Œì§€ Dataë¥¼ í™œìš©í•´ ê°ì¢… ë¦¬ì†ŒìŠ¤ë“¤ì„ ê²€ìƒ‰í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ ë³´ì•˜ìŠµë‹ˆë‹¤.&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vpc_id&lt;/code&gt;ë„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;az&lt;/code&gt;ì™€ ê°™ì´ ë³„ë„ì˜ index ê³¼ì • ì—†ì´,
ê°„í¸í•œ ì¡°íšŒê°€ ê°€ëŠ¥í•˜ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤. (ì œê°€ ì•„ì§ ë°©ë²•ì„ ëª¨ë¥´ëŠ” ê²ƒì¼ ìˆ˜ë„ ìˆì–´ìš”!)&lt;/p&gt;

&lt;p&gt;ì§€ê¸ˆê¹Œì§€ í…Œë¼í¼ ë” ìµìˆ™í•˜ê²Œ Data &amp;amp; Index í¸ì„ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ì˜ëª»ëœ ë‚´ìš©ì€ ì§€ì í•´ ì£¼ì„¸ìš”! ğŸ˜ƒ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;span class=&quot;table-of-contents-list&quot;&gt;Terraform Tips&lt;/span&gt;&lt;/p&gt;
&lt;ul class=&quot;table-of-contents-list&quot;&gt;
    &lt;li&gt;&lt;a href=&quot;./TerraformTips1&quot;&gt;Module &amp;amp; Output&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./TerraformTips2&quot;&gt;Data &amp;amp; Index&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Heuristic Wave</name>
        
        
      </author>

      

      
        <category term="devops" />
      
        <category term="terraform" />
      

      
        <summary type="html">Terraform ë” ìµìˆ™í•˜ê²Œ 2 - Data &amp;amp; Index</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Terraform Tips 1 - Module &amp;amp; Output</title>
      <link href="https://heuristicwave.github.io/TerraformTips1" rel="alternate" type="text/html" title="Terraform Tips 1 - Module &amp; Output" />
      <published>2021-11-15T00:00:00+00:00</published>
      <updated>2021-11-15T00:00:00+00:00</updated>
      <id>https://heuristicwave.github.io/TerraformTips1</id>
      <content type="html" xml:base="https://heuristicwave.github.io/TerraformTips1">&lt;p&gt;Terraform ë” ìµìˆ™í•˜ê²Œ 1 - Module &amp;amp; Output&lt;/p&gt;

&lt;h2 id=&quot;intro&quot;&gt;Intro&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;Terraform Module&lt;/strong&gt;ì„ ì˜ í™œìš©í•˜ë©´ ë³¸ì¸ì´ ì›í•˜ëŠ” ëŒ€ë¡œ ì¸í”„ë¼ë¥¼ ë ˆê³ ì²˜ëŸ¼ ì¡°ë¦½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë ˆê³ ì²˜ëŸ¼ ì¸í”„ë¼ë¥¼ ì¡°ë¦½í•˜ê¸° ìœ„í•´ì„œëŠ” ëª¨ë“ˆ ê°„ì˜ ì—°ê³„ê°€ ì¤‘ìš”í•œë°ìš”,
ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ëª¨ë“ˆ ë‚´ì— ì‘ì„±ëœ &lt;strong&gt;Output value&lt;/strong&gt;ë“¤ì„ í™œìš©í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ í¬ìŠ¤íŒ…ì€ Outputì— ëŒ€í•œ ì´í•´ê°€ ìˆë‹¤ëŠ” ê°€ì •í•˜ì— ê¸°ìˆ í•˜ì˜€ìœ¼ë¯€ë¡œ, Outputì— ëŒ€í•œ ì„¤ëª…ì´ í•„ìš”í•˜ì‹œë©´ ì•„ë˜ ë§í¬ë“¤ì„ ì°¸ê³ í•´ ì£¼ì„¸ìš”!&lt;/p&gt;

&lt;p&gt;ğŸ¥² ì‚¬ì‹¤, ì•„ë˜ ë¬¸ì„œë³´ë‹¤ ë” ì˜ ì„¤ëª…í•  ìì‹ ì´ ì—†ì–´ì„œâ€¦ ì–¸ì œë‚˜ ê°€ì¥ ì¢‹ì€ êµì¬ëŠ” ê³µì‹ ë¬¸ì„œì…ë‹ˆë‹¤!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.terraform.io/docs/language/values/outputs.html&quot;&gt;Terraform Docs&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://learn.hashicorp.com/tutorials/terraform/outputs&quot;&gt;Tutorial : Output Data from Terraform&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;output-command-option&quot;&gt;Output Command Option&lt;/h2&gt;

&lt;p&gt;Outputì€ terraform apply ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•˜ê³  ë‚œ í›„, ë§¨ ë§ˆì§€ë§‰ì— Value ë“¤ì´ ë Œë”ë§ ë˜ì–´ ë‚˜ì˜µë‹ˆë‹¤.
ê·¸ëŸ¬ë‚˜ í…Œë¼í¼ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ì¤‘ê°„ì¤‘ê°„ ì¸í”„ë¼ì˜ value ê°’ë“¤ì´ í•„ìš”í•  ë•Œê°€ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ëŸ´ ë•Œ, outputì´ ì •ì˜ëœ ìƒí™©ì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;terraform output {label}&lt;/code&gt; ëª…ë ¹ì–´ë¡œ Ouput ê°’ì„ í™•ì¸í•©ë‹ˆë‹¤.
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-raw&lt;/code&gt; ì˜µì…˜ì„ í•¨ê»˜ ì£¼ë©´ ë¬¸ìì—´ í˜•íƒœê°€ ì•„ë‹Œ rawí•œ í…ìŠ¤íŠ¸ ê°’ë§Œì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;terraform output &lt;span class=&quot;nt&quot;&gt;-raw&lt;/span&gt; security_group_id
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;accessing-child-module-outputs&quot;&gt;Accessing Child Module Outputs&lt;/h2&gt;

&lt;p&gt;í•˜ìœ„ ëª¨ë“ˆì˜ ì•„ì›ƒí’‹ì— ì ‘ê·¼í•  ê²½ìš°ë„ ì¢…ì¢… ìˆëŠ”ë°ìš”, ì´ë•ŒëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;module.&amp;lt;ëª¨ë“ˆ ëª…&amp;gt;.&amp;lt;Output ëª…&amp;gt;&lt;/code&gt; ì´ëŸ° í˜•ì‹ìœ¼ë¡œ ì¡°íšŒê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.
í•˜ìœ„ ëª¨ë“ˆ ì¶œë ¥ê°’ì— ì ‘ê·¼í•˜ëŠ” ê²ƒì´, ëª¨ë“ˆê³¼ ëª¨ë“ˆì€ ì—°ê³„í•˜ëŠ” ë°©ë²•ì´ê¸°ì— ì•„ë˜ ì˜ˆì‹œì—ì„œ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;module &lt;span class=&quot;s2&quot;&gt;&quot;vpc&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;terraform-aws-modules/vpc/aws&quot;&lt;/span&gt;
  name   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sample_vpc&quot;&lt;/span&gt;

  cidr &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;10.10.0.0/16&quot;&lt;/span&gt;

  azs            &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;us-west-2a&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
  public_subnets &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;10.10.1.0/24&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;

  tags &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    Owner       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;me&quot;&lt;/span&gt;
    Environment &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;stage&quot;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìœ„ì™€ ê°™ì€ vpc ëª¨ë“ˆì€ security group ëª¨ë“ˆê³¼ ê±°ì˜ ë‹¨ì§ ìˆ˜ì¤€ìœ¼ë¡œ í•¨ê»˜ ì›€ì§ì´ëŠ”ë°ìš”,
security group ëª¨ë“ˆì„ í™œìš©í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vpc_id&lt;/code&gt; ê°’ì´ í•„ìš”í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ ê²½ìš°, vpcë¥¼ ë¨¼ì € ìƒì„±í•˜ê³  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vpc_id&lt;/code&gt; ê°’ì„ ì•Œì•„ë‚´ì–´ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ëª¨ë“ˆì„ ì—°ê³„í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;module &lt;span class=&quot;s2&quot;&gt;&quot;security_group&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;terraform-aws-modules/security-group/aws&quot;&lt;/span&gt;
  name        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ssh&quot;&lt;/span&gt;
  description &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ssh from workstation&quot;&lt;/span&gt;
  vpc_id      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; module.vpc.vpc_id

  ingress_cidr_blocks &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0.0.0.0/0&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
  ingress_rules       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ssh-tcp&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;find-module-output-label&quot;&gt;Find Module Output Label&lt;/h2&gt;

&lt;p&gt;ë°©ê¸ˆ ì „, ëª¨ë“ˆì„ ì—°ê³„í•˜ëŠ” ë°©ë²•ì„ ë°°ì›Œ ë³´ì•˜ìŠµë‹ˆë‹¤. ê·¸ëŸ°ë°, ëª¨ë“ˆì„ ì—°ê³„í•˜ê¸° ìœ„í•´ì„œëŠ” ë¯¸ë¦¬ ì‚¬ì „ì— ì‘ì„±ëœ ëª¨ë“ˆì˜ Output Labelì„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ìš°ì„  ì—ë””í„°ì˜ Explorer íƒ­ì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.terraform&lt;/code&gt; í´ë”ë¥¼ ì—´ì–´ë´…ì‹œë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/post/module.png&quot; alt=&quot;module.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;applyë¥¼ ì ìš©í•œ &lt;em&gt;security-group, vpc&lt;/em&gt; ëª¨ë“ˆì´ ë‚´ ë¡œì»¬ ë¨¸ì‹ ì— ìˆ¨ì–´ ìˆìŠµë‹ˆë‹¤.
í•´ë‹¹ ëª¨ë“ˆ í´ë” ì•ˆì— ë“¤ì–´ê°€ë©´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;outputs.tf&lt;/code&gt; ê°€ ì •ì˜ë˜ì–´ ìˆìœ¼ë¯€ë¡œ í•´ë‹¹ íŒŒì¼ì„ ì°¸ê³ í•˜ì—¬ Label ê°’ì„ ì–»ì–´ì˜¤ë©´ ë©ë‹ˆë‹¤!&lt;/p&gt;

&lt;h3 id=&quot;example&quot;&gt;Example&lt;/h3&gt;

&lt;p&gt;ìƒí™© : VPC ëª¨ë“ˆì„ ì‚¬ìš©í•´ VPCì™€ ì„œë¸Œë„·ì„ êµ¬ì¶•í•œ ìƒí™©ì—ì„œ, EFSë¥¼ ê° ì„œë¸Œë„·ì—ì„œ ì‚¬ìš©í•˜ë ¤ê³  í•©ë‹ˆë‹¤.
EFSì—ì„œ ëª¨ë“ˆë¡œ ìƒì„±í•œ Subnetsì„ ì–´ë–»ê²Œ ì°¸ì¡°í• ê¹Œìš”?&lt;/p&gt;

&lt;details&gt;
  &lt;summary&gt;ğŸ– ì •ë‹µ ë³´ê¸°&lt;/summary&gt;

  &lt;p&gt;ìœ„ì—ì„œ ì–¸ê¸‰í•œëŒ€ë¡œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;modules/vpc/output.tf&lt;/code&gt; ì—ì„œ í”„ë¼ì´ë¹— ì„œë¸Œë„·ì˜ Labelì„ í™•ì¸í•´ë³´ë©´,
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;private_subnets&lt;/code&gt; ì´ë¼ ê¸°ì¬ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í™œìš©í•´ ì•„ë˜ì™€ ê°™ì´ ëª¨ë“ˆì„ ì°¸ì¡° í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

  &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;resource &lt;span class=&quot;s2&quot;&gt;&quot;aws_efs_mount_target&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;mount&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  count &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; length&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;module.vpc.private_subnets&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

  file_system_id &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; aws_efs_file_system.foo.id
  subnet_id      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; module.vpc.private_subnets[count.index]
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;  &lt;/div&gt;
&lt;/details&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;outro&quot;&gt;Outro&lt;/h2&gt;

&lt;p&gt;ì´ë ‡ê²Œ Moduleì˜ Output ê°’ì„ í™œìš©í•˜ëŠ” ë°©ë²•ì„ ì•Œê²Œ ë˜ë‹ˆ, í…Œë¼í¼ ëª¨ë“ˆ ì¡°ë¦½ì— ëŒ€í•œ ìì‹ ê°ì´ ìƒê²¼ìŠµë‹ˆë‹¤. 
ì•ìœ¼ë¡œë„ í…Œë¼í¼ì— ë” ìµìˆ™í•˜ì§€ê¸° ìœ„í•œ ë°©ë²•ë“¤ì„ ì‹œë¦¬ì¦ˆë¡œ ì—°ì¬í•  ê³„íšì¸ë°, ì–¸ì œ ëë‚ ì§€ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤. ğŸ˜‘&lt;/p&gt;

&lt;p&gt;ì§€ê¸ˆê¹Œì§€ í…Œë¼í¼ ë” ìµìˆ™í•˜ê²Œ Module &amp;amp; Output í¸ì„ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ì˜ëª»ëœ ë‚´ìš©ì€ ì§€ì í•´ ì£¼ì„¸ìš”! ğŸ˜ƒ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;span class=&quot;table-of-contents-list&quot;&gt;Terraform Tips&lt;/span&gt;&lt;/p&gt;
&lt;ul class=&quot;table-of-contents-list&quot;&gt;
    &lt;li&gt;&lt;a href=&quot;./TerraformTips1&quot;&gt;Module &amp;amp; Output&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./TerraformTips2&quot;&gt;Data &amp;amp; Index&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Heuristic Wave</name>
        
        
      </author>

      

      
        <category term="devops" />
      
        <category term="terraform" />
      

      
        <summary type="html">Terraform ë” ìµìˆ™í•˜ê²Œ 1 - Module &amp;amp; Output</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Self-service Infrastructure</title>
      <link href="https://heuristicwave.github.io/SelfService" rel="alternate" type="text/html" title="Self-service Infrastructure" />
      <published>2021-10-25T00:00:00+00:00</published>
      <updated>2021-10-25T00:00:00+00:00</updated>
      <id>https://heuristicwave.github.io/SelfService</id>
      <content type="html" xml:base="https://heuristicwave.github.io/SelfService">&lt;p&gt;ë³¸ ê¸€ì€ &lt;a href=&quot;https://www.oreilly.com/library/view/infrastructure-as-code/9781491924334/&quot;&gt;Kief Morrisì˜ Infrastructure as Code&lt;/a&gt; ì™€ &lt;a href=&quot;https://www.hashicorp.com/resources/unlocking-the-cloud-operating-model-provisioning&quot;&gt;HashiCorp ë°±ì„œ&lt;/a&gt; ë¥¼ ì½ê³  í•™ìŠµí•œ ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±í•œ ê¸€ ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ì„œë¬¸&quot;&gt;ì„œë¬¸&lt;/h2&gt;

&lt;p&gt;IaC(Infrastructure as Code)ì— ê´€ì‹¬ì„ ê°–ê³  ê³µë¶€ë¥¼ í•˜ë‹¤ë³´ë©´ &lt;strong&gt;Self-service Infra&lt;/strong&gt;ë¼ëŠ” ë§ì„ ìì£¼ ë§Œë‚˜ê²Œ ë©ë‹ˆë‹¤.
ëª‡ ê°œì›”ì§¸ ì™€ë‹¿ì§€ ì•ŠëŠ” ê°œë…ì´ì˜€ì§€ë§Œ, ìµœê·¼ &lt;strong&gt;í‚¤í”„ ëª¨ë¦¬ìŠ¤&lt;/strong&gt;ì˜ ì±…ì„ ë‹¤ì‹œ ì½ê³  ì¡°ê¸ˆì€ ì•Œê²Œ ëœ ê±° ê°™ì•„ ê·¸ë™ì•ˆ ê³µë¶€í•œ Self-service Infraì— ëŒ€í•œ ìë£Œë“¤ì„ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Self-service Infra&lt;/strong&gt;ì— ê´€í•œ ë°°ê²½ì§€ì‹ì„ ë„“íˆëŠ” ë° ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;dynamic-infrastructure&quot;&gt;Dynamic Infrastructure&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;ë™ì  ì¸í”„ë¼&lt;/strong&gt;ëŠ” ì„œë²„, ìŠ¤í† ë¦¬ì§€, ë„¤íŠ¸ì›Œí¬ì™€ ê°™ì€ ì¸í”„ë¼ ìì›ì„ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œì„ ë§í•©ë‹ˆë‹¤.
ë™ì  ì¸í”„ë¼ì˜ ì¢…ë¥˜ë¡œëŠ” Public/Private í´ë¼ìš°ë“œ, ì˜¤í”ˆìŠ¤íƒì„ í™œìš©í•˜ëŠ” ì‚¬ì„¤ í´ë¼ìš°ë“œ, ë² ì–´ë©”íƒˆ ë“±ì´ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì•ì„  ì •ì˜ë§Œ ë³´ë©´ ë™ì  ì¸í”„ë¼ëŠ” í´ë¼ìš°ë“œì™€ êµ‰ì¥íˆ ìœ ì‚¬í•˜ì§€ë§Œ, &lt;strong&gt;í‚¤í”„ ëª¨ë¦¬ìŠ¤&lt;/strong&gt;ëŠ” ë™ì  ì¸í”„ë¼ê°€ í´ë¼ìš°ë“œë³´ë‹¤ ë²”ìœ„ê°€ ë” ë„“ë‹¤ê³  í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ğŸ“£ &lt;em&gt;ë™ì  ì¸í”„ë¼ë¥¼ ì†Œê°œí•˜ë©° ì•Œë ¤ë“œë¦¬ê³  ì‹¶ì€ ë¬¸ì¥ì´ ìˆìŠµë‹ˆë‹¤.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;í´ë¼ìš°ë“œë¡œì˜ ì „í™˜&lt;/strong&gt;ì´ë¼ëŠ” ì˜ë¯¸ì— ëŒ€í•´ ë§ì€ ì‚¬ëŒë“¤ì´ ì—¬ëŸ¬ ì¸¡ë©´ì—ì„œ ì„¤ëª…ì„ í•˜ì§€ë§Œ,
ì €ëŠ” HashiCorpì˜ &lt;a href=&quot;https://www.hashicorp.com/resources/unlocking-the-cloud-operating-model-provisioning&quot;&gt;Unlocking the Cloud Operating Model: Provisioning&lt;/a&gt;
ë°±ì„œì— ì†Œê°œëœ ë‹¤ìŒ í‘œí˜„ì— ì°¸ ê³µê°ì´ ê°‘ë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;í´ë¼ìš°ë“œë¡œì˜ ì „í™˜ì˜ ë³¸ì§ˆì ì¸ ì˜ë¯¸ëŠ” â€œì •ì â€ ì¸í”„ë¼ì—ì„œ â€œë™ì â€ ì¸í”„ë¼ë¡œì˜ ì „í™˜ì…ë‹ˆë‹¤.&lt;/p&gt;

  &lt;p&gt;The essential implications of the transition to the cloud is the shift from â€œstaticâ€ infrastructure to â€œdynamicâ€ infrastructure&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ë™ì -ì¸í”„ë¼-í”Œë«í¼-ìš”êµ¬-ì‚¬í•­&quot;&gt;ë™ì  ì¸í”„ë¼ í”Œë«í¼ ìš”êµ¬ ì‚¬í•­&lt;/h2&gt;

&lt;p&gt;ë™ì  ì¸í”„ë¼ í”Œë«í¼ì€ ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì„±ì´ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Programmable&lt;/li&gt;
  &lt;li&gt;On-Demand&lt;/li&gt;
  &lt;li&gt;Self-Service&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;-programmable&quot;&gt;ğŸ’» Programmable&lt;/h3&gt;

&lt;p&gt;ë™ì  ì¸í”„ë¼ í”Œë«í¼ì€ í”„ë¡œê·¸ë˜ë°ì„ ì‰½ê²Œ í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ìœ ì € ì¸í„°í˜ì´ìŠ¤ ì™¸ì—ë„ ìŠ¤í¬ë¦½íŠ¸, CLIì™€ ê°™ì€ ë„êµ¬ë“¤ê³¼ë„ ìƒí˜¸ ì‘ìš© í•  ìˆ˜ ìˆë„ë¡ í”„ë¡œê·¸ë˜ë° APIê°€ í•„ìš”í•©ë‹ˆë‹¤.
ì•„ë˜ ê° í”Œë«í¼ ë³„ SDKë¥¼ ì‚¬ìš©í•˜ë©´ í´ë¼ìš°ë“œ ë‚´ ìì›ì„ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://aws.amazon.com/tools/&quot;&gt;AWS SDK&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://azure.microsoft.com/en-us/downloads/&quot;&gt;Azure SDK&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cloud.google.com/sdk/&quot;&gt;GCP SDK&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.openstack.org/openstacksdk/latest/&quot;&gt;Openstack SDK&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;-on-demand&quot;&gt;â° On-Demand&lt;/h3&gt;

&lt;p&gt;ë™ì  ì¸í”„ë¼ í”Œë«í¼ì—ì„œ ìì›ì„ ì¦‰ì‹œ ìƒì„±í•˜ê³  ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.
ë˜í•œ ì „í†µì ì¸ ì¸í”„ë¼ì˜ ê³¼ê¸ˆ ì •ì±…ì´ ì¼ì • ê¸°ê°„ ë™ì•ˆì˜ ê³„ì•½ì„ ê¸°ë°˜ìœ¼ë¡œ í•œë‹¤ë©´, ë™ì  ì¸í”„ë¼ì—ì„œëŠ” ì‹œê°„ë‹¹ ê³¼ê¸ˆ ì²´ê³„ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ğŸŠ &lt;em&gt;ë“œë””ì–´ ëŒ€ë§ì˜ ì…€í”„ ì„œë¹„ìŠ¤ê°€ ì²˜ìŒ ì†Œê°œ ë©ë‹ˆë‹¤!&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;-self-service&quot;&gt;ğŸƒğŸ» Self-Service&lt;/h3&gt;

&lt;p&gt;ì…€í”„ì„œë¹„ìŠ¤ëŠ” ì˜¨ë””ë§¨ë“œ ìš”êµ¬ ì‚¬í•­ì„ ì¢€ ë” ë°œì „ì‹œí‚¨ ê°œë…ì…ë‹ˆë‹¤. ì „í†µì ì¸ ë°©ë²•ì—ì„œ ì¸í”„ë¼ë¥¼ ìš”êµ¬í•˜ê¸° ìœ„í•´ì„œëŠ” ì„¸ë¶€ ìš”ì²­ ì–‘ì‹, ì„¤ê³„ ë° ëª…ì„¸ ë¬¸ì„œ, êµ¬í˜„ ê³„íš ìˆ˜ë¦½ ë“±ì„ í•„ìš”ë¡œ í–ˆìŠµë‹ˆë‹¤.
ì…€í”„ì„œë¹„ìŠ¤ëŠ” ì „í†µì ì¸ ë°©ë²•ì—ì„œ ë” ì§„í™”í•˜ì—¬ &lt;strong&gt;í•„ìš”í•œ ì¸í”„ë¼ë¥¼ ì¦‰ì‹œ í”„ë¡œë¹„ì €ë‹í•˜ê³  ì‰½ê²Œ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” ìë™í™”ëœ ì ˆì°¨&lt;/strong&gt;ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ğŸ›  &lt;em&gt;ì…€í”„ ì„œë¹„ìŠ¤ëŠ” ì¸í”„ë¼ í…œí”Œë¦¿ì„ ìš´ìš©í•  ìˆ˜ ìˆëŠ” IaC ë„êµ¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬í˜„í•©ë‹ˆë‹¤.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;ì˜ˆë¥¼ ë“¤ì–´ ê°œë°œìê°€ ë¡œë“œë°¸ëŸ°ì„œë¡œ ALBë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ê°€ NLBë¡œ ë°”ê¾¸ê³  ì‹¶ì€ ê²½ìš°, ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ëœ ì¸í”„ë¼ ì½”ë“œë¥¼ ì¬ë°°í¬ í•˜ë©´ ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-terraform highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;resource&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aws_lb&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;test&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;               &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;test-lb-tf&quot;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;internal&lt;/span&gt;           &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;
  
  &lt;span class=&quot;c1&quot;&gt;# load_balancer_type = &quot;application&quot;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;load_balancer_type&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;network&quot;&lt;/span&gt;
  
  &lt;span class=&quot;c1&quot;&gt;# Leave out other config ...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;HashiCorp&lt;/strong&gt;ê°€ ì •ì˜í•œ &lt;a href=&quot;https://www.hashicorp.com/products/terraform/self-service-infrastructure&quot;&gt;Self-Service Infrastructure&lt;/a&gt; ê²Œì‹œë¬¼ì„ ë³´ë©´,
Self-Service Infraê°€ ì–´ë–¤ ì˜ë¯¸ì¸ì§€ ë” ì‰½ê²Œ ë‹¤ê°€ì˜µë‹ˆë‹¤. &lt;em&gt;(ì²¨ë¶€ëœ ë§í¬ë¥¼ í†µí•´ ì…€í”„ì„œë¹„ìŠ¤ì˜ ì¥ì ì„ ê¼­ í•œë²ˆ ì½ì–´ë³´ì„¸ìš”!)&lt;/em&gt;&lt;/p&gt;

&lt;h4 id=&quot;ê¸°ì¡´-ë°©ë²•&quot;&gt;ê¸°ì¡´ ë°©ë²•&lt;/h4&gt;

&lt;p&gt;ê°œë°œìëŠ” ì¸í”„ë¼ ë‹´ë‹¹ìê°€ ì¸í”„ë¼ë¥¼ í• ë‹¹í•  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://www.hashicorp.com/img/products/terraform/use-cases/self-service-infrastructure/self-service-challenge.png&quot; width=&quot;600&quot; height=&quot;300&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;ì…€í”„-ì„œë¹„ìŠ¤-ì ìš©&quot;&gt;ì…€í”„ ì„œë¹„ìŠ¤ ì ìš©&lt;/h4&gt;

&lt;p&gt;ì‘ì„±ëœ ì¸í”„ë¼ í…œí”Œë¦¿ì„ í™œìš©í•´ ì˜¨ë””ë§¨ë“œë¡œ í”„ë¡œë¹„ì €ë‹ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://www.hashicorp.com/img/products/terraform/use-cases/self-service-infrastructure/self-service-solution.png&quot; width=&quot;600&quot; height=&quot;300&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ê¸€ì„-ë§ˆì¹˜ë©°&quot;&gt;ê¸€ì„ ë§ˆì¹˜ë©°&lt;/h2&gt;
&lt;p&gt;ì €ëŠ” í…Œë¼í¼ì„ ê³µë¶€í•œ ì´í›„, ê°„ë‹¨í•œ ì›¹ì„œë¹„ìŠ¤ë¥¼ ìš´ì˜í•˜ëŠ” í† ì´í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•  ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ì¸í”„ë¼ í™˜ê²½ì„ ìì£¼ ì‚¬ìš©í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://github.com/GSNextLevel/neoTerraform/blob/main/image/webserver_cluster.png?raw=true&quot; width=&quot;500&quot; height=&quot;550&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë¯¸ë¦¬ ì½”ë“œë¡œ ì •ì˜í•œ ì¸í”„ë¼ ë•ë¶„ì— ê°œë°œì—ë§Œ ì§‘ì¤‘í•  ìˆ˜ ìˆëŠ” í™˜ê²½ê³¼ ìƒì‚°ì„± í–¥ìƒì„ ê²½í—˜í–ˆìŠµë‹ˆë‹¤.
ë˜í•œ í…Œë¼í¼ ëª¨ë“ˆ ë•ë¶„ì— ì œê°€ ì›í•˜ëŠ” ëŒ€ë¡œ ì¸í”„ë¼ ìŠ¤í™ì„ ë³€ê²½í•˜ê³  ê°ì¢… í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ ì¶”ê°€ í˜¹ì€ ì œê±°ê°€ ê°€ëŠ¥í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì…€í”„ì„œë¹„ìŠ¤ ì¸í”„ë¼ê°€ ê¸°ì¡´ ìŠ¹ì¸ ì²´ê³„(&lt;em&gt;ë¦¬ì†ŒìŠ¤ ìš”ì²­ â¡ï¸ ë‹´ë‹¹ì ìŠ¹ì¸&lt;/em&gt;)ë¥¼ ë¶€ì •í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë¼ê³  ìƒê°í•©ë‹ˆë‹¤.
ê¸°ì¡´ ì²´ê³„ê°€ ê°–ê³  ìˆëŠ” ë³´ì•ˆì  ì´ì ì„ í¬í•¨í•œ ì¥ì ë“¤ì„ ìœ ì§€í•˜ë©°, ìœ ì—°í•˜ê³  ì‹ ì†í•˜ê²Œ ì¸í”„ë¼ë¥¼ ìš´ìš©í•˜ëŠ” Self-service í™˜ê²½ì´ ë¶ˆëŸ¬ì˜¬ ì¥ì ì„ ê³ ë¯¼í•´ ë´ì•¼ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë§ˆì§€ë§‰ìœ¼ë¡œ, DevOps ë¬¸í™”ê°€ ì •ì°©í•´ê°€ë©° &lt;strong&gt;CI/CD&lt;/strong&gt; ë¥¼ í†µí•´ ì§€ì†ì  ë°°í¬ê°€ ê°€ëŠ¥í•´ì§€ë©° ë” ì¦ì€ ì„œë¹„ìŠ¤ ì¶œì‹œê°€ ê°€ëŠ¥í•´ì¡ŒìŠµë‹ˆë‹¤.
ë˜í•œ, &lt;strong&gt;IaC&lt;/strong&gt;ë¥¼ í†µí•´ Immutable Infraë¥¼ ì¶”êµ¬í•˜ë©° ì¸í”„ë¼ì˜ ì¼ê´€ì„±ê³¼ ì•ˆì •ì„±ì„ ë³´ì¥í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
ì•ì„  ë‘ ê°œì˜ ê°œë…ì— ë”í•´ &lt;strong&gt;Self-service&lt;/strong&gt;ë¥¼ ì¶”êµ¬í•œë‹¤ë©´ ì¡°ì§ì˜ ë¯¼ì²©ì„±ê³¼ ìƒì‚°ì„± í–¥ìƒì— ë„ì›€ì´ ë  ê²ƒì´ë¼ê³  ìƒê°í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì†Œì¤‘í•œ ì‹œê°„ì„ ë‚´ì–´ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ì˜ëª»ëœ ë‚´ìš©ì€ ì§€ì í•´ì£¼ì„¸ìš”! ğŸ˜ƒ&lt;/p&gt;

&lt;hr /&gt;</content>

      
      
      
      
      

      <author>
          <name>Heuristic Wave</name>
        
        
      </author>

      

      
        <category term="devops" />
      

      
        <summary type="html">ë³¸ ê¸€ì€ Kief Morrisì˜ Infrastructure as Code ì™€ HashiCorp ë°±ì„œ ë¥¼ ì½ê³  í•™ìŠµí•œ ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±í•œ ê¸€ ì…ë‹ˆë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Provision Infrastructure with Packer</title>
      <link href="https://heuristicwave.github.io/Packer" rel="alternate" type="text/html" title="Provision Infrastructure with Packer" />
      <published>2021-08-02T00:00:00+00:00</published>
      <updated>2021-08-02T00:00:00+00:00</updated>
      <id>https://heuristicwave.github.io/Packer</id>
      <content type="html" xml:base="https://heuristicwave.github.io/Packer">&lt;p&gt;ë³¸ ê¸€ì€ &lt;a href=&quot;https://learn.hashicorp.com/tutorials/terraform/packer&quot;&gt;HashiCorp Learn - Provision Infrastructure with Packer&lt;/a&gt; ì—ì„œ ë‹¤ë£¨ëŠ” ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±í•œ ê¸€ ì…ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Packerë¥¼ ì‚¬ìš©í•´ AWS AMIë¥¼ ë§Œë“¤ê³  Terraformê³¼ ì—°ê³„í•˜ì—¬ í™œìš©í•˜ëŠ” ë°©ë²•ì— ì•½ê°„ì˜ ì„¤ëª…ê³¼ íŒì„ ë‹´ì•„ í•œêµ­ì–´ë¡œ ì¬ì‘ì„±í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. (ì„¤ì¹˜ì™€ ê´€ë ¨ëœ ì¤€ë¹„ì‚¬í•­ì€ ìƒëµë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì›ë¬¸ì„ í™•ì¸í•´ì£¼ì„¸ìš”.)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;í”„ë¡œì íŠ¸-êµ¬ì¡°&quot;&gt;í”„ë¡œì íŠ¸ êµ¬ì¡°&lt;/h2&gt;

&lt;p&gt;ë¨¼ì €, í•´ë‹¹ íŠœí† ë¦¬ì–¼ì„ ì§„í–‰í•˜ê¸° ìœ„í•œ í”„ë¡œì íŠ¸ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. ì•„ë˜ì™€ í´ë”ì™€ íŒŒì¼ì„ ì¤€ë¹„í•´ì£¼ì„¸ìš”.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
â””â”€â”€ provision-infra-with-packer
    â”œâ”€â”€ images
    â”‚   â””â”€â”€ image.pkr.hcl
    â”œâ”€â”€ instances
    â”‚   â”œâ”€â”€ main.tf
    â”‚   â””â”€â”€ variables.tf
    â””â”€â”€ scripts
        â””â”€â”€ setup.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;local-ssh-key-ìƒì„±í•˜ê¸°&quot;&gt;Local SSH key ìƒì„±í•˜ê¸°&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;provision-infra-with-packer&lt;/code&gt; í´ë” ì•ˆì—ì„œ AWS AMIë¡œ ë§Œë“¤ ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•˜ê¸° ìœ„í•œ SSH í‚¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
í•„ìëŠ” ì‚¬ìš©í•  ê³µê°œí‚¤ë¥¼ Mac OSì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ssh-keygen&lt;/code&gt;ìœ¼ë¡œ ìƒì„±í•˜ì˜€ìŠµë‹ˆë‹¤. ê°ì í™˜ê²½ì— ë§ëŠ” ë°©ë²•ìœ¼ë¡œ SSH ê³µê°œí‚¤ë¥¼ ìƒì„±í•˜ì„¸ìš”.
ì•”í˜¸í™” íƒ€ì…(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-t&lt;/code&gt;)ì„ RSAë¡œ ì£¼ì„(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-C&lt;/code&gt;)ì„ ì´ë©”ì¼ë¡œ ìƒì„±ë˜ëŠ” ê³µê°œí‚¤ì˜ ìœ„ì¹˜(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-f&lt;/code&gt;)ë¥¼ í˜„ì¬ directoryë¡œ ì„¤ì •í•˜ê³  ê³µê°œí‚¤ì˜ ì´ë¦„ì„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tf-packer&lt;/code&gt;ë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.
ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ê³  ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ë©´ ë˜ì§€ë§Œ í¸ì˜ìƒ ê³µë°±ìœ¼ë¡œ ë‘ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; rsa &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;your_email@example.com&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ./tf-packer
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´í›„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tf-packer&lt;/code&gt;ì™€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tf-packer.pub&lt;/code&gt; 2ê°€ì§€ íŒŒì¼ì´ ìƒì„±ë˜ì—ˆë‹¤ë©´ ë‹¤ìŒ ë‹¨ê³„ ğŸš€&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;packer-ì½”ë“œ-ì‘ì„±í•˜ê¸°&quot;&gt;Packer ì½”ë“œ ì‘ì„±í•˜ê¸°&lt;/h2&gt;

&lt;p&gt;&lt;em&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;image.pkr.hcl&lt;/code&gt; íŒŒì¼ì—ì„œ ì§„í–‰í•©ë‹ˆë‹¤.&lt;/em&gt; &lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;1ï¸âƒ£-ami-êµ¬ì¶•ì—-í•„ìš”í•œ-config-ì‘ì„±&quot;&gt;1ï¸âƒ£ AMI êµ¬ì¶•ì— í•„ìš”í•œ config ì‘ì„±&lt;/h3&gt;

&lt;p&gt;packerê°€ ë¹Œë“œí•œ ì´ë¯¸ì§€ê°€ ì €ì¥ë  ë¦¬ì „ì˜ ì •ë³´ì™€ AMIì— timestamp ì •ë³´ë¥¼ ë„£ê¸° ìœ„í•œ configë¥¼ ì°¨ë¡€ë¡œ ì‘ì„±í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;variable &lt;span class=&quot;s2&quot;&gt;&quot;region&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; string
  default &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;us-east-1&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

locals &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; timestamp &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; regex_replace&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;timestamp&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;[- TZ:]&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2ï¸âƒ£ï¸-base-amiì—-ëŒ€í•œ-source-ami-config-ì‘ì„±&quot;&gt;2ï¸âƒ£ï¸ Base AMIì— ëŒ€í•œ Source AMI config ì‘ì„±&lt;/h3&gt;

&lt;p&gt;packerê°€ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” Base AMIì— ëŒ€í•œ ì •ë³´ë¥¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;source&lt;/code&gt; ë¸”ë¡ì— ì •ì˜í•©ë‹ˆë‹¤.
1ë‹¨ê³„ì—ì„œ ì‘ì„±í•œ config ê°’ì„ í™œìš©í•´ ë¦¬ì „ê³¼ timestampë¥¼ ë„£ì–´ì£¼ëŠ” ì½”ë“œì™€ Packer Builderë¡œ ì‚¬ìš©í•  &lt;strong&gt;ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…ì„ ì§€ì •&lt;/strong&gt;í•©ë‹ˆë‹¤.
ì´í›„, AWSì— ì¡´ì¬í•˜ëŠ” ìˆ˜ë§ì€ AMI ì¤‘ì—ì„œ sourceë¡œ í™œìš©í•  ì´ë¯¸ì§€ë¥¼ &lt;strong&gt;filter&lt;/strong&gt; ì½”ë“œë¡œ ì‘ì„±í•©ë‹ˆë‹¤.
(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;name&lt;/code&gt; ë¶€ë¶„ì— ì§ì ‘ ami ë²ˆí˜¸ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ê¸°ì¬ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.)&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;amazon-ebs&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;example&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  ami_name      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;learn-terraform-packer-&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;local&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.timestamp&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
  instance_type &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;t2.micro&quot;&lt;/span&gt;
  region        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; var.region
  source_ami_filter &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    filters &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      name                &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ubuntu/images/*ubuntu-xenial-16.04-amd64-server-*&quot;&lt;/span&gt;
      root-device-type    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ebs&quot;&lt;/span&gt;
      virtualization-type &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hvm&quot;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    most_recent &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;true
    &lt;/span&gt;owners      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;099720109477&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  ssh_username &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ubuntu&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;3ï¸âƒ£-packer-build-config-ì‘ì„±&quot;&gt;3ï¸âƒ£ Packer build config ì‘ì„±&lt;/h3&gt;

&lt;p&gt;build ë¶€ë¶„ì—ì„œëŠ” &lt;a href=&quot;https://learn.hashicorp.com/tutorials/packer/aws-get-started-provision?in=packer/aws-get-started#add-provisioner-to-template&quot;&gt;í™˜ê²½ë³€ìˆ˜ ì„¸íŒ…ì´ë‚˜ ëª…ë ¹ì–´ë¥¼ inline í˜•íƒœ&lt;/a&gt;ë¡œ ê¸°ì… í•  ìˆ˜ ìˆì§€ë§Œ,
ì•„ë˜ì™€ ê°™ì€ ê°„ë‹¨í•œ ê¸°ëŠ¥ë§Œ ìˆ˜í–‰í•˜ë„ë¡ ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;hcl&lt;/code&gt; ë¬¸ë²•ì— ë”°ë¼ &lt;strong&gt;sourceë¥¼ ì§€ì •&lt;/strong&gt;í•˜ê³ , í”„ë¡œë¹„ì €ë‹ì„ ìœ„í•œ &lt;strong&gt;ê³µê°œí‚¤ì˜ ìœ„ì¹˜ë¥¼ ëª…ì„¸&lt;/strong&gt;í•©ë‹ˆë‹¤. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;source&lt;/code&gt;ëŠ” ë¡œì»¬ ë¨¸ì‹ , &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;destination&lt;/code&gt;ì€ ì›ê²© ë¨¸ì‹  ì…ë‹ˆë‹¤.
ë§ˆì§€ë§‰ìœ¼ë¡œ Packerë¡œ ë¹Œë“œí•œ ì´ë¯¸ì§€ì—ì„œ Application Setupì´ ë‹´ê¸´ &lt;strong&gt;scriptë¥¼ ì§€ì •&lt;/strong&gt;í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;build &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  sources &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;source.amazon-ebs.example&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;

  provisioner &lt;span class=&quot;s2&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;../tf-packer.pub&quot;&lt;/span&gt;
    destination &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/tmp/tf-packer.pub&quot;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  provisioner &lt;span class=&quot;s2&quot;&gt;&quot;shell&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    script &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;../scripts/setup.sh&quot;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;4ï¸âƒ£-shell-script-ì‘ì„±&quot;&gt;4ï¸âƒ£ Shell script ì‘ì„±&lt;/h2&gt;

&lt;p&gt;&lt;em&gt;í•´ë‹¹ ì‘ì—…ì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scripts&lt;/code&gt; í´ë”ì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;setup.sh&lt;/code&gt;ì—ì„œ ì§„í–‰í•©ë‹ˆë‹¤.&lt;/em&gt; &lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ì´ ë¶€ë¶„ì€ Terraformìœ¼ë¡œ í”„ë¡œë¹„ì €ë‹ í•œ ì¸í”„ë¼ë¥¼ ì›¹í˜ì´ì§€ì—ì„œ í™•ì¸í•˜ê¸° ìœ„í•´ ê°„ë‹¨í•œ ìƒ˜í”Œì„ ë„ìš°ëŠ” ì½”ë“œê°€ ë‹´ê²¨ìˆìŠµë‹ˆë‹¤.
ì•„ë˜ Scriptì— í•„ìš”í•œ ì¢…ì†ì„± ì„¤ì¹˜, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;terraform&lt;/code&gt;ì„ userì— ì¶”ê°€, ìƒì„±í•œ SSHí‚¤ ì„¤ì¹˜, ìƒ˜í”Œ Go App ì„¤ì¹˜ê°€ ë‹¨ê³„ê°€ ì‘ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;noscript&gt;
  &lt;pre&gt;#!/bin/bash
set -e

# Install necessary dependencies
sudo DEBIAN_FRONTEND=noninteractive apt-get -y -o Dpkg::Options::=&amp;quot;--force-confdef&amp;quot; -o Dpkg::Options::=&amp;quot;--force-confold&amp;quot; dist-upgrade
sudo apt-get -y -qq install curl wget git vim apt-transport-https ca-certificates
sudo add-apt-repository ppa:longsleep/golang-backports -y
sudo apt -y -qq install golang-go

# Setup sudo to allow no-password sudo for &amp;quot;hashicorp&amp;quot; group and adding &amp;quot;terraform&amp;quot; user
sudo groupadd -r hashicorp
sudo useradd -m -s /bin/bash terraform
sudo usermod -a -G hashicorp terraform
sudo cp /etc/sudoers /etc/sudoers.orig
echo &amp;quot;terraform ALL=(ALL) NOPASSWD:ALL&amp;quot; | sudo tee /etc/sudoers.d/terraform

# Installing SSH key
sudo mkdir -p /home/terraform/.ssh
sudo chmod 700 /home/terraform/.ssh
sudo cp /tmp/tf-packer.pub /home/terraform/.ssh/authorized_keys
sudo chmod 600 /home/terraform/.ssh/authorized_keys
sudo chown -R terraform /home/terraform/.ssh
sudo usermod --shell /bin/bash terraform

# Create GOPATH for Terraform user &amp;amp; download the webapp from GitHub
sudo -H -i -u terraform -- env bash &amp;lt;&amp;lt; EOF
whoami
echo ~terraform

cd /home/terraform

export GOROOT=/usr/lib/go
export GOPATH=/home/terraform/go
export PATH=$PATH:$GOROOT/bin:$GOPATH/bin
go get -d github.com/hashicorp/learn-go-webapp-demo
EOF
&lt;/pre&gt;
&lt;/noscript&gt;
&lt;script src=&quot;https://gist.github.com/heuristicwave/3c0d9afefb5e04d7b69700f11918e9a0.js&quot;&gt; &lt;/script&gt;

&lt;p&gt;1 ~ 4ë‹¨ê³„ë¥¼ ë§ˆì³¤ë‹¤ë©´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;images&lt;/code&gt; í´ë” ìœ„ì¹˜ì— &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;packer build image.pkr.hcl&lt;/code&gt; ëª…ë ¹ì–´ë¡œ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ì´ë¯¸ì§€ ë¹Œë“œ í›„, ì½˜ì†” &lt;strong&gt;Images&lt;/strong&gt; íƒ­ì˜ &lt;strong&gt;AMIs&lt;/strong&gt;ì„ í™•ì¸í•˜ë©´ ë¹Œë“œí•œ ì´ë¯¸ì§€ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.
ë˜í•œ, ì¸ìŠ¤í„´ìŠ¤ íƒ­ì„ í™•ì¸í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ Base AMIë¥¼ ë§Œë“¤ê¸° ìœ„í•œ Packer Builderì˜ í”ì ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
&lt;img src=&quot;/assets/built/images/post/packerBuilder.png&quot; alt=&quot;Packer_Builder&quot; /&gt;
í•´ë‹¹ í™”ë©´ì˜ Instance IDë¥¼ ëˆŒëŸ¬ ì„¤ì •ë“¤ì„ í™•ì¸í•´ë³´ë©´ source ë¸”ë¡ì— ì •ì˜í•œ ê°’ì„ ë°”íƒ•ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;terraformìœ¼ë¡œ-packer-ì´ë¯¸ì§€-ë°°í¬&quot;&gt;Terraformìœ¼ë¡œ Packer ì´ë¯¸ì§€ ë°°í¬&lt;/h2&gt;

&lt;p&gt;&lt;em&gt;í•´ë‹¹ ì‘ì—…ì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;instances&lt;/code&gt; í´ë”ì—ì„œ ì§„í–‰í•©ë‹ˆë‹¤.&lt;/em&gt; &lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;sample-app-infra-code-ì‘ì„±í•˜ê¸°&quot;&gt;Sample App Infra Code ì‘ì„±í•˜ê¸°&lt;/h3&gt;

&lt;p&gt;ì•„ë˜ ğŸ›  ì´ëª¨í‹°ì½˜ì„ í´ë¦­í•˜ì—¬ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main.tf&lt;/code&gt;ì™€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;varaiables.tf&lt;/code&gt;ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;details&gt;
  &lt;summary&gt;ğŸ”¨ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main.tf&lt;/code&gt; ğŸ”¨&lt;/summary&gt;
  &lt;p&gt;&lt;br /&gt;&lt;/p&gt;

  &lt;div class=&quot;language-terraform highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;terraform&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;required_providers&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;aws&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;source&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hashicorp/aws&quot;&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;version&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;~&amp;gt; 3.26.0&quot;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;required_version&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;~&amp;gt; 1.0.2&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;provider&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aws&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;region&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;region&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;resource&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aws_vpc&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;vpc&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;cidr_block&lt;/span&gt;           &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cidr_vpc&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;enable_dns_support&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;enable_dns_hostnames&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;resource&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aws_internet_gateway&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;igw&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;vpc_id&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;aws_vpc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vpc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;resource&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aws_subnet&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;subnet_public&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;vpc_id&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;aws_vpc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vpc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;cidr_block&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cidr_subnet&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;resource&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aws_route_table&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;rtb_public&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;vpc_id&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;aws_vpc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vpc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;route&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;cidr_block&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0.0.0.0/0&quot;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gateway_id&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;aws_internet_gateway&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;igw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;resource&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aws_route_table_association&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;rta_subnet_public&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;subnet_id&lt;/span&gt;      &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;aws_subnet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;subnet_public&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;route_table_id&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;aws_route_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;rtb_public&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;resource&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aws_security_group&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sg_22_80&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sg_22&quot;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;vpc_id&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;aws_vpc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;vpc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# SSH access from the VPC&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;ingress&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;from_port&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;to_port&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;protocol&lt;/span&gt;    &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;tcp&quot;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;cidr_blocks&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0.0.0.0/0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;ingress&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;from_port&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8080&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;to_port&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8080&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;protocol&lt;/span&gt;    &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;tcp&quot;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;cidr_blocks&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0.0.0.0/0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;ingress&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;from_port&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;to_port&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;protocol&lt;/span&gt;    &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;tcp&quot;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;cidr_blocks&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0.0.0.0/0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;egress&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;from_port&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;to_port&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;protocol&lt;/span&gt;    &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;-1&quot;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;cidr_blocks&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0.0.0.0/0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;resource&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aws_instance&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;web&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;ami&lt;/span&gt;                         &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ami-YOUR-AMI-ID&quot;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;instance_type&lt;/span&gt;               &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;t2.micro&quot;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;subnet_id&lt;/span&gt;                   &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;aws_subnet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;subnet_public&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;vpc_security_group_ids&lt;/span&gt;      &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;aws_security_group&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sg_22_80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;associate_public_ip_address&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;tags&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;Name&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Learn-Packer&quot;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;public_ip&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;aws_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;web&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;public_ip&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;  &lt;/div&gt;

&lt;/details&gt;

&lt;details&gt;
  &lt;summary&gt;ğŸ”§ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;varaiables.tf&lt;/code&gt; ğŸ”§&lt;/summary&gt;
  &lt;p&gt;&lt;br /&gt;&lt;/p&gt;

  &lt;div class=&quot;language-terraform highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;variable&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;cidr_vpc&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;CIDR block for the VPC&quot;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;default&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;10.1.0.0/16&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;variable&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;cidr_subnet&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;CIDR block for the subnet&quot;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;default&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;10.1.0.0/24&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;variable&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;environment_tag&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Environment tag&quot;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;default&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Learn&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;variable&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;region&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;The region Terraform deploys your instance&quot;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;default&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;us-east-1&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;  &lt;/div&gt;
&lt;/details&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ì¸í”„ë¼ ì½”ë“œì— ëŒ€í•œ ì„¤ëª…ì€ ìƒëµí•˜ê² ìŠµë‹ˆë‹¤. &lt;br /&gt;
ì¸í”„ë¼ì— ëŒ€í•œ í…Œë¼í¼ ì½”ë“œê°€ ê¶ê¸ˆí•˜ì‹œë‹¤ë©´ ë‹¤ë¥¸ ê²Œì‹œê¸€ì´ë‚˜ &lt;a href=&quot;https://heuristicwave.github.io/3Tier&quot;&gt;ì œ í¬ìŠ¤íŒ…&lt;/a&gt;ì„ ì½ì–´ë³´ì„¸ìš”!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;ami-query-í•˜ê¸°&quot;&gt;AMI Query í•˜ê¸°&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://learn.hashicorp.com/tutorials/terraform/packer&quot;&gt;ë³¸ë¬¸&lt;/a&gt;ì—ëŠ” ì†Œê°œë˜ì§€ ì•Šì•˜ì§€ë§Œ, Packerì™€ Terraformì˜ í†µí•©ì„ ìœ„í•´ í•„ìê°€ ì‘ì„±í•œ ë¶€ë¶„ì…ë‹ˆë‹¤.
Terraformì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Data Sources&lt;/code&gt;ë¥¼ í™œìš©í•´ ë¹Œë“œëœ AMIë¥¼ Queryí•˜ì—¬ ìƒ˜í”Œ ì•±ì„ í”„ë¡œë¹„ì €ë‹ í•´ë´…ì‹œë‹¤.
ì„ í–‰ ì‘ì—…ì—ì„œ ì§„í–‰í•œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main.tf&lt;/code&gt; í•˜ë‹¨ì— ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-terraform highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aws_ami_ids&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;myami&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;owners&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;YOUR Account ID&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# sort_ascending = true&lt;/span&gt;
  
  &lt;span class=&quot;nx&quot;&gt;filter&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;learn-terraform-packer-*&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Packerë¡œ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí–ˆìœ¼ë¯€ë¡œ, ami ownerê°€ ë˜ì—ˆìŠµë‹ˆë‹¤!
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;owners&lt;/code&gt; ë¶€ë¶„ì— ìì‹ ì˜ ê³„ì • IDë¥¼ ì‘ì„±í•˜ê³  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;filter&lt;/code&gt;ì— packer buildë¥¼ í•  ë–„ ì‚¬ìš©í•œ ami_nameì„ value ê°’ìœ¼ë¡œ ë„£ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;sort_ascending&lt;/strong&gt; default ê°’ì´ false&lt;/p&gt;

  &lt;p&gt;sort_ascending = false : listì˜ 0ë²ˆì§¸ ìš”ì†Œê°€ latest &lt;br /&gt;
sort_ascending = true : ë§Œë“¤ì–´ì§„ ìˆœì„œëŒ€ë¡œ ë¦¬ìŠ¤íŠ¸ ìƒì„± (ê°€ì¥ ë¨¼ì € ìƒì„±ëœ amiê°€ 0ë²ˆ)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ì´ì–´ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main.tf&lt;/code&gt;ì— ì¸ìŠ¤í„´ìŠ¤ ë¦¬ì†ŒìŠ¤ë¥¼ ì •ì˜í•œ ë¶€ë¶„ì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ami = &quot;ami-YOUR-AMI-ID&quot;&lt;/code&gt; ì½”ë“œë¥¼ ì•„ë˜ì™€ ê°™ì´ ëŒ€ì²´í•©ë‹ˆë‹¤.
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;data&lt;/code&gt; ê°ì²´ì— í•„í„°ë§í•œ ê²°ê³¼ ê°’ë“¤ì´ ë¹Œë“œëœ AMIë“¤ì´ ë¦¬ìŠ¤íŠ¸ í˜•ì‹ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ”ë° &lt;strong&gt;latest&lt;/strong&gt; ë²„ì „ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ 0ë²ˆì§¸ ì´ë¯¸ì§€ë¥¼ ëª…ì‹œí•©ë‹ˆë‹¤.
í¸ì˜ìƒ ì‚¬ìš©ëœ ami ë²ˆí˜¸ë¥¼ í„°ë¯¸ë„ì—ì„œ í™•ì¸ í•  ìˆ˜ ìˆë„ë¡ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;output&lt;/code&gt;ì— ëŒ€í•œ ì½”ë“œë„ í•¨ê»˜ ì‘ì„±í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-terraform highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;resource&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aws_instance&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;web&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;ami&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;aws_ami_ids&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;myami&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ids&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;# &quot;ami-YOUR-AMI-ID&quot;&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Skip Other Config&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;my_ami&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;aws_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;web&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ami&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  í…Œë¼í¼ ì½”ë“œê°€ ìœ„ì¹˜í•œ í´ë”ì—ì„œ(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;instances&lt;/code&gt; í´ë” í•˜ìœ„) ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;terraform init &amp;amp;&amp;amp; terraform apply&lt;/code&gt; ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;yes&lt;/code&gt;ë¥¼ ê¸°ì…í•©ë‹ˆë‹¤. &lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ëª…ë ¹ì–´ë¡œ ì¸í”„ë¼ ìƒíƒœë¥¼ ì ê²€í•´ ì•„ë˜ì™€ ê°™ë‹¤ë©´ ë‹¤ìŒ ë‹¨ê³„ë¡œ ğŸš€&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;terraform state list
data.aws_ami_ids.myami
aws_instance.web
aws_internet_gateway.igw
aws_route_table.rtb_public
aws_route_table_association.rta_subnet_public
aws_security_group.sg_22_80
aws_subnet.subnet_public
aws_vpc.vpc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;data objectì— ë‹´ê¸´ ì •ë³´ê°€ í™•ì¸í•˜ê³  ì‹¶ë‹¤ë©´? &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$ terraform state show data.aws_ami_ids.myami.ids&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ì¸ìŠ¤í„´ìŠ¤-í™•ì¸í•˜ê¸°&quot;&gt;ì¸ìŠ¤í„´ìŠ¤ í™•ì¸í•˜ê¸°&lt;/h2&gt;

&lt;p&gt;SSHë¥¼ í†µí•´ ì¸ìŠ¤í„´ìŠ¤ì— ì—°ê²°í•©ë‹ˆë‹¤. &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ssh terraform@$(terraform output -raw public_ip) -i ../tf-packer&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Go ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•˜ì„¸ìš”. &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cd go/src/github.com/hashicorp/learn-go-webapp-demo&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ë°ëª¨ ì•±ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;go run webapp.go&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ë°°í¬í•œ ì•± í™•ì¸ì„ ìœ„í•´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;terraform output public_ip&lt;/code&gt;ë¡œ ì–»ì€ IPì— 8080 í¬íŠ¸ë¡œ ì ‘ì†í•˜ë©´ ê°„ë‹¨í•œ í…ŒíŠ¸ë¦¬ìŠ¤ ê²Œì„ ì•±ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;ì¸ìŠ¤í„´ìŠ¤-ë¦¬ì†ŒìŠ¤-íšŒìˆ˜&quot;&gt;ì¸ìŠ¤í„´ìŠ¤ ë¦¬ì†ŒìŠ¤ íšŒìˆ˜&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;terraform destroy&lt;/code&gt; ëª…ë ¹ì–´ë¡œ ìƒê¸° í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•œ ì¸í”„ë¼ë¥¼ ë¦¬ì†ŒìŠ¤ë¥¼ íšŒìˆ˜í•©ë‹ˆë‹¤. Packerë¡œ ì‘ì„±í•œ ì´ë¯¸ì§€ëŠ” íŒŒê´´ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ìœ„ì™€ ê°™ì€ ë‹¨ê³„ë“¤ì„ í†µí•´ íŒ¨ì»¤ë¡œ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ê³  í…Œë¼í¼ê³¼ í†µí•©í•˜ëŠ” ë°©ë²•ì„ í•™ìŠµí•´ë³´ì•˜ìŠµë‹ˆë‹¤.
ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ ë‹¤ë¤˜ë˜ ë‚´ìš©ì€ &lt;strong&gt;Immutable Servers&lt;/strong&gt;ë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•œ ë°©ë²• ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.
ì˜¤ëŠ˜ í¬ìŠ¤íŒ…ì— ì¶”ê°€ë¡œ &lt;strong&gt;Ansible&lt;/strong&gt;ì„ í†µí•©í•œë‹¤ë©´, &lt;strong&gt;Immutable Infrastructure&lt;/strong&gt;ë¥¼ êµ¬ì¶•í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;span class=&quot;table-of-contents-list&quot;&gt;Terraform Courses&lt;/span&gt;&lt;/p&gt;
&lt;ul class=&quot;table-of-contents-list&quot;&gt;
    &lt;li&gt;&lt;a href=&quot;./3Tier&quot;&gt;3-Tier VPC Architecture with Terraform&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./CodeCommit&quot;&gt;ECR Pipeline with Terraform â…  (CodeCommit)&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./CodeBuild&quot;&gt;ECR Pipeline with Terraform â…¡ (ECR, CodeBuild, IAM)&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./CodePipeline&quot;&gt;ECR Pipeline with Terraform â…¢ (CodePipeline)&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./Packer&quot;&gt;Provision Infrastructure with Packer&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Heuristic Wave</name>
        
        
      </author>

      

      
        <category term="devops" />
      
        <category term="aws" />
      

      
        <summary type="html">ë³¸ ê¸€ì€ HashiCorp Learn - Provision Infrastructure with Packer ì—ì„œ ë‹¤ë£¨ëŠ” ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±í•œ ê¸€ ì…ë‹ˆë‹¤.</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">Look into EKS max pods</title>
      <link href="https://heuristicwave.github.io/EKS_Max_Pods" rel="alternate" type="text/html" title="Look into EKS max pods" />
      <published>2021-06-19T18:00:00+00:00</published>
      <updated>2021-06-19T18:00:00+00:00</updated>
      <id>https://heuristicwave.github.io/EKS_Max_Pods</id>
      <content type="html" xml:base="https://heuristicwave.github.io/EKS_Max_Pods">&lt;p&gt;EKS ë…¸ë“œì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ Podì˜ ê°œìˆ˜ëŠ” ëª‡ ê°œì¼ê¹Œ?&lt;/p&gt;

&lt;h1 id=&quot;preview&quot;&gt;Preview&lt;/h1&gt;

&lt;p&gt;ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” EKSì˜ ë…¸ë“œ ê·¸ë£¹ì—ì„œëŠ” ìµœëŒ€ ëª‡ ê°œì˜ í¬ë“œ(Private IP)ê°€ í• ë‹¹ ê°€ëŠ¥í•˜ê³  ì–´ë– í•œ ë°©ë²•ìœ¼ë¡œ ìµœëŒ€ í¬ë“œì˜ ê°œìˆ˜ë¥¼ ì œì–´í•  ìˆ˜ ìˆëŠ”ì§€ ì•Œì•„ë³´ì.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;build-up&quot;&gt;Build Up&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://kubernetes.io/docs/setup/best-practices/cluster-large/&quot;&gt;ì¿ ë²„ë„¤í‹°ìŠ¤ ë„ê·œë¨¼íŠ¸&lt;/a&gt; ì— ë”°ë¥´ë©´ ë…¸ë“œë‹¹ 110ê°œì˜ í¬ë“œë¥¼ ìƒì„±í•  ìˆ˜ ìˆìœ¼ë©°, ë…¸ë“œëŠ” 5000ê°œê¹Œì§€ ìƒì„± ê°€ëŠ¥í•´ ì´ 15ë§Œ ê°œì˜ í¬ë“œê°€ ìƒì„± ê°€ëŠ¥í•˜ë‹¤ê³  í•œë‹¤. &lt;br /&gt;
&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/flexible-pod-cidr?hl=en#cidr_ranges_for_clusters&quot;&gt;GCPì˜ GKE ê°€ì´ë“œ&lt;/a&gt; ì— ë”°ë¥´ë©´ ê¸°ë³¸ í´ëŸ¬ìŠ¤í„° ë…¸ë“œ í•˜ë‚˜ì— ìµœëŒ€ 110ê°œì˜ í¬ë“œê°€ ìƒì„± ê°€ëŠ¥í•˜ë‹¤ê³  í•œë‹¤. &lt;br /&gt;
êµ¬ê¸€ë§ì„ í†µí•´ í™•ì¸í•˜ë‹ˆ, ë…¸ë“œì—ì„œ í¬ë“œì˜ ê°¯ìˆ˜ê°€ ì¦ê°€í• ìˆ˜ë¡ kubelet, cAdvisor ë“±ê³¼ ê°™ì€ K8s ì—ì´ì „íŠ¸ì— ì˜¤ë²„í—¤ë“œë¥¼ ë°œìƒì‹œí‚¤ë¯€ë¡œ 110ê°œ ì •ë„ë¥¼ ê¶Œì¥í•œë‹¤ê³  í•œë‹¤.
ê·¸ë˜ì„œ ê·¸ëŸ°ì§€ &lt;a href=&quot;https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/&quot;&gt;kubelet docs&lt;/a&gt; ì—ì„œë„ ì•„ë˜ì™€ ê°™ì€ max-podsê°€ 110ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ê°€ì§„ë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;--max-pods&lt;/span&gt; int32     Default: 110
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;eks-eni-max-pods&quot;&gt;EKS eni max pods&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html#AvailableIpPerENI&quot;&gt;IP addresses per network interface per instance type&lt;/a&gt; ì„ í™•ì¸í•´ë³´ë©´ AWSì˜ ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…ë³„ ENI ê°œìˆ˜ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.
&lt;a href=&quot;https://docs.aws.amazon.com/eks/latest/userguide/pod-networking.html&quot;&gt;EKS ì„¤ëª…ì„œ&lt;/a&gt; ë¥¼ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê³µì‹ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. &lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(# of network interfaces for the instance type Ã— (# of IPv4 per network interface - 1)) + 2&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ENIì˜ ì²« ë²ˆì§¸ IPëŠ” í¬ë“œê°€ ì‚¬ìš©í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ 1ì„ ë¹¼ê³  AWS CNIì™€ kube-proxyê°€ ì°¨ì§€í•˜ëŠ” 2ê°œì˜ IPë¥¼ ë§ˆì§€ë§‰ ìˆ˜ì‹ì— ë”í•´ ìµœì¢… ì‚¬ìš© ê°€ëŠ¥í•œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;max-pod&lt;/code&gt; ê°’ì„ ì•Œ ìˆ˜ ìˆë‹¤. &lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ì„¤ëª…í•œ ê³µì‹ ì´ì™¸ì—ë„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kubectl&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ í†µí•´ Maximum Podsë¥¼ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;â¯ kubectl get nodes &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt;
NAME                                            STATUS   ROLES    AGE   VERSION
ip-10-0-0-178.ap-northeast-2.compute.internal   Ready    &amp;lt;none&amp;gt;   18h   v1.19.6-eks-49a6c0
ip-10-0-1-143.ap-northeast-2.compute.internal   Ready    &amp;lt;none&amp;gt;   18h   v1.19.6-eks-49a6c0
â¯ kubectl describe nodes ip-10-0-0-178.ap-northeast-2.compute.internal | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; pods
  pods:                        17
  pods:                        17
Non-terminated Pods:          &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;17 &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;total&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;-labs-1&quot;&gt;ğŸ‘€ Labs 1&lt;/h3&gt;

&lt;p&gt;kubectlì˜ ëª…ë ¹ì–´ì—ì„œ ë…¸ë“œ(t3.medium)ë‹¹ 17ê°œì˜ í¬ë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ê³  í–ˆëŠ”ë°, ì§ì ‘ ë…¸ë“œê·¸ë£¹ ë‚´ì—ì„œ í¬ë“œë¥¼ ìµœëŒ€ë¡œ ë„ì›Œ í™•ì¸í•´ë³´ì. ë…¸ë“œê·¸ë£¹ ë‚´ì— nginx 32ê°œë¥¼ ì˜¬ë ¤ë³´ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/post/maxPodsTest.png&quot; alt=&quot;EKSMaxPods&quot; /&gt;&lt;/p&gt;

&lt;p&gt;K9s ì‰˜ì„ í†µí•´ ì´ 38ê°œì˜ í¬ë“œê°€ í™•ì¸ë˜ì—ˆê³  38ê°œ ì¤‘ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;aws-node&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;coredns&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kube-proxy&lt;/code&gt;ê°€ ê°ê° 2ê°œì˜ ë…¸ë“œì— ìœ„ì¹˜í•˜ê³  4ê°œì˜ nginx í¬ë“œê°€ &lt;strong&gt;Pending&lt;/strong&gt; ìƒíƒœë¼ëŠ” ê²ƒì„ íŒŒì•…í–ˆë‹¤.
ì¦‰, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;38(Total) - 4(Pending) = 17(t3.medium Maximum Pods) * 2(# of Node)&lt;/code&gt; ì‹¤í—˜ ê²°ê³¼ì™€ ì•ì„œ ì•Œì•„ë³¸ Maximum Podsê°€ ë™ì¼í•˜ë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;maximum-pods-ë³€ê²½í•˜ê¸°&quot;&gt;Maximum Pods ë³€ê²½í•˜ê¸°&lt;/h2&gt;

&lt;p&gt;EKSì—ì„œ Maximum Podsë¥¼ ê²°ì • ì§“ëŠ” ìš”ì†ŒëŠ” ENIë‹¤. ê·¸ëŸ¬ë‚˜ í´ëŸ¬ìŠ¤í„°ì˜ ë…¸ë“œê·¸ë£¹ì„ ìƒì„±í•  ë•Œ kubeletì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;max-pods&lt;/code&gt; ê°’ì„ ë³€ê²½í•´ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•  ìˆ˜ ìˆë‹¤. 
&lt;a href=&quot;https://docs.aws.amazon.com/eks/latest/userguide/cni-custom-network.html&quot;&gt;AWS Docs&lt;/a&gt; ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ (ë¶ˆì¹œì ˆí•œ?) ì„¤ëª…ì„ í†µí•´ ENIì™€ ë³„ê°œë¡œ max-podsë¥¼ ì œì–´í•  ìˆ˜ ìˆëŠ” íŒíŠ¸ë¥¼ ì–»ì—ˆë‹¤.
&lt;img src=&quot;../../assets/built/images/post/bootstrapArg.png&quot; alt=&quot;max-pods.png&quot; /&gt;
ê³µì‹ ë¬¸ì„œì—ì„œ ì„¤ëª…ì´ êµ‰ì¥íˆ ë¹ˆì•½í•˜ì§€ë§Œ, EKSì—ì„œ ë…¸ë“œ ê·¸ë£¹ì„ ì»¤ìŠ¤í…€ìœ¼ë¡œ ìƒì„±í•  ë•Œ &lt;strong&gt;Launch templates&lt;/strong&gt;ì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UserData&lt;/code&gt;ë¥¼ ì•„ë˜ì™€ ê°™ì´ ì •ì˜í•˜ë©´ Maximum Podsê°€ ë³€ê²½ëœë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;MIME-Version: 1.0
Content-Type: multipart/mixed&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;boundary&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;==MYBOUNDARY==&quot;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MYBOUNDARY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;
Content-Type: text/x-shellscript&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;charset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;us-ascii&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
/etc/eks/bootstrap.sh &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Cluster Name&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--use-max-pods&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--kubelet-extra-args&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'--max-pods=10'&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MYBOUNDARY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;details&gt;
  &lt;summary&gt;GCPì—ì„œ Max Podsë¥¼ ì œì–´í•˜ëŠ” ë°©ë²• ğŸ‘ˆ Click! &lt;/summary&gt;

  &lt;p&gt;&lt;a href=&quot;https://cloud.google.com/kubernetes-engine/docs/how-to/flexible-pod-cidr?hl=en#configuring_maximum_pods_per_node&quot;&gt;GCPì—ì„œëŠ” í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•  ë•Œ&lt;/a&gt;
ì•„ë˜ ëª…ë ¹ì–´ì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--default-max-pods-per-node&lt;/code&gt; íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;max-pods&lt;/code&gt;(ğŸ‘† Build Up ë‹¨ê³„ì—ì„œ default 110 ğŸ‘†)ë¥¼ ì¡°ì ˆí•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;
  &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gcloud container clusters create CLUSTER_NAME &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# ìƒëµ&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--default-max-pods-per-node&lt;/span&gt; MAXIMUM_PODS &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# ìƒëµ&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;  &lt;/div&gt;

&lt;/details&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;-labs-2&quot;&gt;ğŸ‘€ Labs 2&lt;/h3&gt;

&lt;p&gt;ì•„ë˜ ì‚¬ì§„ì˜ ì™¼ìª½ì€ Labs 1ì˜ Pureí•œ t3.medium, ì˜¤ë¥¸ìª½ì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;max-pods&lt;/code&gt;ë¥¼ ì§€ì •í•œ Custom t3.mediumì´ë‹¤. ì½˜ì†”í™”ë©´ì—ì„œ ìŠ¤í™ì€ ê°™ì§€ë§Œ í• ë‹¹ëœ í¬ë“œì˜ ìˆ˜ê°€ ë‹¤ë¥´ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/built/images/post/max10pods.png&quot; alt=&quot;max-pods-10.png&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;result&quot;&gt;Result&lt;/h2&gt;

&lt;p&gt;ì§€ê¸ˆê¹Œì§€ ë‹¤ì–‘í•œ ë°©ë²•ì„ í†µí•´ EKSì—ì„œ Maximum Podsë¥¼ íŒŒì•…í•˜ëŠ” ë°©ë²•ê³¼ ë³€ê²½í•˜ëŠ” ë°©ë²• ë°°ì› ë‹¤.
AWSì—ì„œëŠ” ENIë¼ëŠ” &lt;em&gt;ê°€ìƒ ë„¤íŠ¸ì›Œí¬ ì¹´ë“œë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë…¼ë¦¬ì  ë„¤íŠ¸ì›Œí¬ êµ¬ì„± ìš”ì†Œ&lt;/em&gt; ë•ë¶„ì— ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…ë§ˆë‹¤ ìƒì„±ë  ìˆ˜ ìˆëŠ” í¬ë“œì˜ ìˆ˜ê°€ ë‹¬ëë‹¤.
ê·¸ ë°–ì—ë„ GCPì— ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ì„¤ê³„ ì² í•™ì„ ê·¸ëŒ€ë¡œ ì´ì–´ë°›ì•„ kubeletì˜ max-pods ê°’ì´ ë™ì¼í•˜ê³  í´ëŸ¬ìŠ¤í„° ìƒì„± ìˆœê°„ì—ë„ max-pods ì„¤ì •ì— ëŒ€í•œ ììœ ë„ê°€ ë†’ë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì–´ë– í•œ ë°©ë²•ì´ ë” ìš°ìœ„ì— ìˆëŠ”ì§€ ê²°ë¡ ì§“ê¸° ì–´ë µì§€ë§Œ, CSPì˜ ì¿ ë²„ë„¤í‹°ìŠ¤ max-pods ìƒì„± ì›ë¦¬ë¥¼ íŒŒì•…í•˜ì—¬ ìµœì ì˜ IP í• ë‹¹ì— ë„ì›€ì´ ë˜ë©´ ì¢‹ê² ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ì†Œì¤‘í•œ ì‹œê°„ì„ ë‚´ì–´ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ì˜ëª»ëœ ë‚´ìš©ì€ ì§€ì í•´ì£¼ì„¸ìš”! ğŸ˜ƒ&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;span class=&quot;table-of-contents-list&quot;&gt;EKS Series&lt;/span&gt;&lt;/p&gt;
&lt;ul class=&quot;table-of-contents-list&quot;&gt;
    &lt;li&gt;&lt;a href=&quot;./EKSMaxPods&quot;&gt;Look into EKS max pods&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Heuristic Wave</name>
        
        
      </author>

      

      
        <category term="aws" />
      
        <category term="devops" />
      
        <category term="backend" />
      

      
        <summary type="html">EKS ë…¸ë“œì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ Podì˜ ê°œìˆ˜ëŠ” ëª‡ ê°œì¼ê¹Œ?</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">ECR CodePipeline with Terraform â…¢</title>
      <link href="https://heuristicwave.github.io/CodePipeline" rel="alternate" type="text/html" title="ECR CodePipeline with Terraform â…¢" />
      <published>2021-04-09T00:00:00+00:00</published>
      <updated>2021-04-09T00:00:00+00:00</updated>
      <id>https://heuristicwave.github.io/CodePipeline</id>
      <content type="html" xml:base="https://heuristicwave.github.io/CodePipeline">&lt;p&gt;Terraformìœ¼ë¡œ ECR íŒŒì´í”„ë¼ì¸ êµ¬ì¶•í•˜ê¸° 3 (CodePipeline)&lt;/p&gt;

&lt;h1 id=&quot;preview&quot;&gt;Preview&lt;/h1&gt;

&lt;p&gt;3í¸ì—ì„œëŠ” CodePipelineì„ ìƒì„±í•˜ê³  IAM ì •ì±…ê³¼ ì—­í• ì„ ë¶€ì—¬í•˜ëŠ” ë²•ì„ ë°°ì›Œë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/codepipeline&quot;&gt;ë¬¸ì„œ&lt;/a&gt;
ë¥¼ í™•ì¸í•˜ë©´ artifactê°€ ë‹´ê¸°ëŠ” ë²„í‚·, pipelineì„ ìƒì„±í•˜ëŠ” ë¦¬ì†ŒìŠ¤, ê´€ë ¨ëœ IAM Roleê³¼ Policyê°€ ë³´ì…ë‹ˆë‹¤.
í…Œë¼í¼ì€ ì„ ì–¸í˜• ì–¸ì–´ì´ë¯€ë¡œ Roleê³¼ Resourceì˜ ì‘ì„± ìˆœì„œê°€ ë°”ë€Œì–´ë„ ìƒê´€ì´ ì—†ì§€ë§Œ, ì½˜ì†”ì—ì„œ ì‘ì—…í•  ê²½ìš° Roleì„ ë¨¼ì € ì‘ì„±í•˜ê³  ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•˜ë‹ˆ 3í¸ì—ì„œëŠ” IAMì„ ë¨¼ì € ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;iam-role&quot;&gt;IAM Role&lt;/h3&gt;
&lt;p&gt;ì•„ë˜ Roleì„ ë°©ê¸ˆì „ ìƒì„±í•œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;codepipeline.tf&lt;/code&gt;ì— ì‘ì„±í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;resource &lt;span class=&quot;s2&quot;&gt;&quot;aws_iam_role&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;codepipeline_role&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  name &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;terraform-codepipeline&quot;&lt;/span&gt;
  assume_role_policy &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;EOF&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;
{
  &quot;Version&quot;: &quot;2012-10-17&quot;,
  &quot;Statement&quot;: [
    {
      &quot;Action&quot;: &quot;sts:AssumeRole&quot;,
      &quot;Principal&quot;: {
        &quot;Service&quot;: &quot;codepipeline.amazonaws.com&quot;
      },
      &quot;Effect&quot;: &quot;Allow&quot;
    }
  ]
}
&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;EOF
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;iam-policy&quot;&gt;IAM Policy&lt;/h3&gt;
&lt;p&gt;ë³¸ë˜ í•„ìš”í•œ ì •ì±…ë§Œì„ ê³¨ë¼ &lt;a href=&quot;https://awspolicygen.s3.amazonaws.com/policygen.html&quot;&gt;ì •ì±…ìƒì„±ê¸°&lt;/a&gt; ì—ì„œ ìƒìƒëœ ì •ì±…ì„ í™œìš©í•˜ëŠ” ë°©ë²•ì´ ìˆì§€ë§Œ, ì–´ë–¤ ì •ì±…ì´ í•„ìš”í•œì§€ í•œë²ˆì— ë§ì¶”ê¸°ëŠ” ë„ˆë¬´ ì–´ë µìŠµë‹ˆë‹¤.
(ì €ì˜ ê²½ìš° ì¸í„°ë„·ì—ì„œ íƒ€ì¸ì´ ì‘ì„±í•œ ì •ì±…ê³¼ ì—ëŸ¬ë©”ì‹œì§€ë¥¼ ë§ì•„ê°€ë©° ì •ì±…ì„ ì‘ì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤ ğŸ˜…)&lt;br /&gt;
â• ì•„ë˜ Policyë¥¼ ë°©ê¸ˆì „ ìƒì„±í•œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;codepipeline.tf&lt;/code&gt;ì— ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;resource &quot;aws_iam_policy&quot; &quot;codepipeline_policy&quot; {
  description = &quot;Codepipeline Execution Policy&quot;
  policy      = &amp;lt;&amp;lt;EOF
{
  &quot;Version&quot;: &quot;2012-10-17&quot;,
  &quot;Statement&quot;: [
    {
      &quot;Action&quot;: [
        &quot;s3:GetObject&quot;, &quot;s3:GetObjectVersion&quot;, &quot;s3:PutObject&quot;,
        &quot;s3:GetBucketVersioning&quot;
      ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;${aws_s3_bucket.artifact_bucket.arn}/*&quot;
    },
    {
      &quot;Action&quot; : [
        &quot;codebuild:StartBuild&quot;, &quot;codebuild:BatchGetBuilds&quot;,
        &quot;iam:PassRole&quot;
      ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;*&quot;
    },
    {
      &quot;Action&quot; : [
        &quot;codecommit:CancelUploadArchive&quot;,
        &quot;codecommit:GetBranch&quot;,
        &quot;codecommit:GetCommit&quot;,
        &quot;codecommit:GetUploadArchiveStatus&quot;,
        &quot;codecommit:UploadArchive&quot;
      ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;${aws_codecommit_repository.test.arn}&quot;
    }
  ]
}
EOF
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ğŸš© ì´ì–´ì„œ ìƒì„±í•œ &lt;strong&gt;Policyë¥¼ Roleì— ë¶€ì—¬&lt;/strong&gt;í•©ë‹ˆë‹¤. ì´ê²ƒ ì—­ì‹œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;codebuild.tf&lt;/code&gt;ì— ì¶”ê°€í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;resource &lt;span class=&quot;s2&quot;&gt;&quot;aws_iam_role_policy_attachment&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;codepipeline-attach&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  role       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; aws_iam_role.codepipeline_role.name
  policy_arn &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; aws_iam_policy.codepipeline_policy.arn
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;codepipeline&quot;&gt;CodePipeline&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;aws_codepipeline&lt;/code&gt;ë¦¬ì†ŒìŠ¤ì˜ configì—ëŠ” artifact storeì™€ ì•”í˜¸í™” í‚¤, Source-Build-Deployë¡œ ì´ì–´ì§€ëŠ” ê° Stageê°€ ì„ ì–¸ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
ë¦¬ì†ŒìŠ¤ ì•ˆì— ê¸°ì¬ëœ ì„¤ì •ë“¤ì€ í•„ìˆ˜ê°€ ì•„ë‹ˆë¯€ë¡œ ì„ íƒí•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” deploy stageì™€ ì•”í˜¸í™” configëŠ” ì œì™¸í•˜ê³  ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;resource &lt;span class=&quot;s2&quot;&gt;&quot;aws_codepipeline&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;pipeline&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  name     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.source_repo_name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.source_repo_branch&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;-Pipeline&quot;&lt;/span&gt;
  role_arn &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; aws_iam_role.codepipeline_role.arn
  artifact_store &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    location &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; aws_s3_bucket.artifact_bucket.bucket
    &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;S3&quot;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

  stage &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    name &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Source&quot;&lt;/span&gt;
    action &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      name             &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Source&quot;&lt;/span&gt;
      category         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Source&quot;&lt;/span&gt;
      owner            &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;AWS&quot;&lt;/span&gt;
      version          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1&quot;&lt;/span&gt;
      provider         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;CodeCommit&quot;&lt;/span&gt;
      output_artifacts &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SourceOutput&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
      run_order        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
      configuration &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        RepositoryName       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; var.source_repo_name
        BranchName           &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; var.source_repo_branch
        PollForSourceChanges &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;false&quot;&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

  stage &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    name &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Build&quot;&lt;/span&gt;
    action &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      name             &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Build&quot;&lt;/span&gt;
      category         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Build&quot;&lt;/span&gt;
      owner            &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;AWS&quot;&lt;/span&gt;
      version          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1&quot;&lt;/span&gt;
      provider         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;CodeBuild&quot;&lt;/span&gt;
      input_artifacts  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SourceOutput&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
      output_artifacts &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;BuildOutput&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
      run_order        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
      configuration &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        ProjectName &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; aws_codebuild_project.codebuild.id
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;1í¸ì—ì„œ ì‘ì„±í•œ CodeCommitì„ Stageì˜ Source, 2í¸ì—ì„œ ì‘ì„±í•œ CodeBuildë¥¼ Buildë‹¨ê³„ ì§€ì •í–ˆìŠµë‹ˆë‹¤.
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;terraform apply, plan&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ ì°¨ë¡€ë¡œ ë°˜ì˜í•´ ì˜¤ë¥˜ê°€ ì—†ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì§€ê¸ˆê¹Œì§€ ì‘ì„±ëœ ì¸í”„ë¼ë¥¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;terraform state list&lt;/code&gt;ëª…ë ¹ì–´ë¥¼ í†µí•´ í™•ì¸í•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;â¯ terraform state list
aws_codebuild_project.codebuild
aws_codecommit_repository.test
aws_codepipeline.pipeline
aws_ecr_repository.image_repo
aws_iam_policy.codebuild_policy
aws_iam_policy.codepipeline_policy
aws_iam_role.codebuild_role
aws_iam_role.codepipeline_role
aws_iam_role_policy_attachment.codebuild-attach
aws_iam_role_policy_attachment.codepipeline-attach
aws_s3_bucket.artifact_bucket
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://console.aws.amazon.com/codepipeline&quot;&gt;CodePipe line ì½˜ì†”&lt;/a&gt; ì—ì„œ í™•ì¸í•˜ë©´ ê¶Œí•œì´ ì—†ì–´ ì‹¤íŒ¨í•œ í™”ë©´ì´ ë‚˜ì˜¬ ê²ƒ ì…ë‹ˆë‹¤.
ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë˜ ë‹¤ë¥¸ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;codepipeline-trigger&quot;&gt;CodePipeline Trigger&lt;/h2&gt;
&lt;p&gt;CodeCommitì—ì„œ ë°œìƒí•œ ì´ë²¤íŠ¸ê°€ CodePipelineìœ¼ë¡œ íŠ¸ë¦¬ê±°ë˜ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ ì •ì˜ëœ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;â• ì•„ë˜ ì½”ë“œë¥¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;codepipeline.tf&lt;/code&gt;ì— ì¶”ê°€í•˜ê³  ì¸í”„ë¼ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.&lt;/p&gt;
&lt;noscript&gt;
  &lt;pre&gt;resource &amp;quot;aws_iam_role&amp;quot; &amp;quot;trigger_role&amp;quot; {
  name               = &amp;quot;terraform-trigger&amp;quot;
  assume_role_policy = &amp;lt;&amp;lt;EOF
{
  &amp;quot;Version&amp;quot;: &amp;quot;2012-10-17&amp;quot;,
  &amp;quot;Statement&amp;quot;: [
    {
      &amp;quot;Action&amp;quot;: &amp;quot;sts:AssumeRole&amp;quot;,
      &amp;quot;Principal&amp;quot;: {
        &amp;quot;Service&amp;quot;: &amp;quot;events.amazonaws.com&amp;quot;
      },
      &amp;quot;Effect&amp;quot;: &amp;quot;Allow&amp;quot;,
      &amp;quot;Sid&amp;quot;: &amp;quot;&amp;quot;
    }
  ]
}
EOF
}

resource &amp;quot;aws_iam_policy&amp;quot; &amp;quot;trigger_policy&amp;quot; {
  description = &amp;quot;CodePipeline Trigger Execution Policy&amp;quot;
  policy      = &amp;lt;&amp;lt;EOF
{
  &amp;quot;Version&amp;quot;: &amp;quot;2012-10-17&amp;quot;,
  &amp;quot;Statement&amp;quot;: [
    {
      &amp;quot;Action&amp;quot;: [
        &amp;quot;codepipeline:StartPipelineExecution&amp;quot;
      ],
      &amp;quot;Effect&amp;quot;: &amp;quot;Allow&amp;quot;,
      &amp;quot;Resource&amp;quot;: &amp;quot;${aws_codepipeline.pipeline.arn}&amp;quot;
    }
  ]
}
EOF
}

resource &amp;quot;aws_iam_role_policy_attachment&amp;quot; &amp;quot;trigger-attach&amp;quot; {
  role       = aws_iam_role.trigger_role.name
  policy_arn = aws_iam_policy.trigger_policy.arn
}&lt;/pre&gt;
&lt;/noscript&gt;
&lt;script src=&quot;https://gist.github.com/heuristicwave/5b566b2cc70337501a4d60b71215930f.js&quot;&gt; &lt;/script&gt;

&lt;h2 id=&quot;result&quot;&gt;Result&lt;/h2&gt;
&lt;p&gt;Trigger ê¹Œì§€ ì •ìƒì ìœ¼ë¡œ ì ìš©í•˜ê³  í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ í™œìš©í•  ì•„ë¬´ Dockerfileì„ CodeCommitì— Pushí•©ë‹ˆë‹¤.
ë‹¤ì‹œ &lt;a href=&quot;https://console.aws.amazon.com/codepipeline&quot;&gt;CodePipeline ì½˜ì†”&lt;/a&gt; ì— ì ‘ì†í•´ ìš°ìƒë‹¨ì— ìœ„ì¹˜í•œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ë³€ê²½ì‚¬í•­ ë¦´ë¦¬ìŠ¤&lt;/code&gt;ë¥¼ ëˆ„ë¥´ë©´,
ì•„ë˜ì™€ ê°™ì´ ì •ìƒì ìœ¼ë¡œ ì½”ë“œ íŒŒì´í”„ë¼ì¸ì´ ì‘ë™í•˜ì—¬ ìš´ì˜ë˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
&lt;img src=&quot;../../assets/built/images/post/ecr_terraform_demo.png&quot; alt=&quot;terraform_demo&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;cleanup&quot;&gt;Cleanup&lt;/h2&gt;
&lt;p&gt;S3 bucketì€ ë¹ˆìƒíƒœì—¬ì•¼ ì œê±°ê°€ ê°€ëŠ¥í•˜ê¸°ì— &lt;a href=&quot;https://console.aws.amazon.com/s3/home&quot;&gt;S3 ì½˜ì†”&lt;/a&gt; ì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ecr-pipeline&lt;/code&gt;ì˜ ë°ì´í„°ë¥¼ ëª¨ë‘ ì‚­ì œí•©ë‹ˆë‹¤.
ì´ì–´ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;terraform destory&lt;/code&gt; ëª…ë ¹ì–´ë¡œ ëª¨ë“  ë¦¬ì†ŒìŠ¤ë¥¼ íšŒìˆ˜í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ì´ 3í¸ì— ê±¸ì³ì„œ í…Œë¼í¼ìœ¼ë¡œ &lt;strong&gt;ìµœì†Œí•œì˜ ë¦¬ì†ŒìŠ¤&lt;/strong&gt;ë¡œ ECR Pipeline êµ¬ì¶•ë²•ì„ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. (CloudWatch ê¸°ëŠ¥ì„ ì¶”ê°€í•´ CodePipelineì„ êµ¬ì¶•í•´ë³´ì„¸ìš” ğŸ‘)
í•´ë‹¹ ê³¼ì •ì„ í†µí•´ AWS ì¸í”„ë¼ ìƒì„±ë²•ê³¼, IAM í™œìš©ë²•, Variable, Output, tfvars ë“±ì„ í™œìš©í•´ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ë²•ì„ ê³µë¶€í–ˆìŠµë‹ˆë‹¤.
ë‹¤ë¥¸ CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•ë²•ë„ ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ ë‹¤ë£¬ ë°©ë²•ê³¼ í¬ê²Œ ë‹¤ë¥´ì§€ ì•Šìœ¼ë‹ˆ, í•´ë‹¹ í¬ìŠ¤íŒ…ì´ ë„ì›€ì´ ë˜ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤. ğŸ˜&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;span class=&quot;table-of-contents-list&quot;&gt;Terraform Courses&lt;/span&gt;&lt;/p&gt;
&lt;ul class=&quot;table-of-contents-list&quot;&gt;
    &lt;li&gt;&lt;a href=&quot;./3Tier&quot;&gt;3-Tier VPC Architecture with Terraform&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./CodeCommit&quot;&gt;ECR Pipeline with Terraform â…  (CodeCommit)&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./CodeBuild&quot;&gt;ECR Pipeline with Terraform â…¡ (ECR, CodeBuild, IAM)&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./CodePipeline&quot;&gt;ECR Pipeline with Terraform â…¢ (CodePipeline)&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./Packer&quot;&gt;Provision Infrastructure with Packer&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Heuristic Wave</name>
        
        
      </author>

      

      
        <category term="aws" />
      
        <category term="devops" />
      
        <category term="terraform" />
      

      
        <summary type="html">Terraformìœ¼ë¡œ ECR íŒŒì´í”„ë¼ì¸ êµ¬ì¶•í•˜ê¸° 3 (CodePipeline)</summary>
      

      
      
    </entry>
  
    <entry>
      <title type="html">ECR CodePipeline with Terraform â…¡</title>
      <link href="https://heuristicwave.github.io/CodeBuild" rel="alternate" type="text/html" title="ECR CodePipeline with Terraform â…¡" />
      <published>2021-04-08T00:00:00+00:00</published>
      <updated>2021-04-08T00:00:00+00:00</updated>
      <id>https://heuristicwave.github.io/CodeBuild</id>
      <content type="html" xml:base="https://heuristicwave.github.io/CodeBuild">&lt;p&gt;Terraformìœ¼ë¡œ ECR íŒŒì´í”„ë¼ì¸ êµ¬ì¶•í•˜ê¸° 2 (ECR, CodeBuild, IAM)&lt;/p&gt;

&lt;p&gt;2í¸ì—ì„œëŠ” &lt;strong&gt;ECR&lt;/strong&gt;ê³¼ &lt;strong&gt;CodeBuild&lt;/strong&gt;ë¥¼ ìƒì„±í•˜ê³  &lt;strong&gt;IAM ì—­í• , ì •ì±…ì„ ë¶€ì—¬&lt;/strong&gt;í•˜ëŠ” ë²•ì„ í•™ìŠµí•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;ecr&quot;&gt;ECR&lt;/h2&gt;
&lt;p&gt;ECR ì—­ì‹œ &lt;a href=&quot;https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository&quot;&gt;ê³µì‹ ë¬¸ì„œ&lt;/a&gt; ì—ì„œ ì‚¬ìš©ë°©ë²•ì„ í™•ì¸í•©ë‹ˆë‹¤.
ê³µì‹ë¬¸ì„œì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;image_scanning_configuration&lt;/code&gt; configë¥¼ ì‚¬ìš©í•˜ë©´ ì·¨ì•½ì  ìŠ¤ìº”ì´ ê°€ëŠ¥í•˜ë‹¤ ì„¤ëª…ë˜ì–´ ìˆì§€ë§Œ, í•„ìš”í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì œì™¸í•˜ê² ìŠµë‹ˆë‹¤.
ë”ë¶ˆì–´, outputë„ í•¨ê»˜ ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;EOF&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt; &amp;gt; ecr.tf
resource &quot;aws_ecr_repository&quot; &quot;image_repo&quot; {
  name                 = var.image_repo_name
  image_tag_mutability = &quot;MUTABLE&quot;
}

output &quot;image_repo_url&quot; {
  value = aws_ecr_repository.image_repo.repository_url
}

output &quot;image_repo_arn&quot; {
  value = aws_ecr_repository.image_repo.arn
}
&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;EOF
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ì´ì–´ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ecr.tf&lt;/code&gt;ì—ì„œ ë³€ìˆ˜ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ &lt;strong&gt;var.image_repo_name&lt;/strong&gt; ë¶€ë¶„ì´ ì‘ë™í•˜ë„ë¡ 1í¸ì—ì„œ ì‘ì„±í•œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;variables.tf&lt;/code&gt; ì•„ë˜ ê°’ì„ ì¶”ê°€í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;âœ… í¸ì˜ìƒ ì´ë²ˆ ë‹¨ê³„ì— í•„ìš”í•œ variableì„ í•¨ê»˜ í¬í•¨í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;variable &quot;image_repo_name&quot; {
  description = &quot;Image repo name&quot;
  type        = string
}

variable &quot;container_name&quot; {
  description = &quot;Container Name&quot;
  default     = &quot;my-container&quot;
}

variable &quot;source_repo_branch&quot; {
  description = &quot;Source repo branch&quot;
  type        = string
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ecr ì‘ì„±ì„ ì™„ë£Œí–‡ìœ¼ë‹ˆ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;plan, apply&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ ì°¨ë¡€ë¡œ ì…ë ¥í•´ ì¸í”„ë¼ë¥¼ ìƒì„±í•˜ê³  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;terraform state list&lt;/code&gt;ëª…ë ¹ì–´ë‚˜ &lt;a href=&quot;https://console.aws.amazon.com/ecr/home&quot;&gt;ì½˜ì†”&lt;/a&gt; ì—ì„œ ìƒì„±ëœ ì¸í”„ë¼ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;codebuild&quot;&gt;CodeBuild&lt;/h2&gt;
&lt;p&gt;CodeBuildë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ &lt;a href=&quot;https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/codebuild_project&quot;&gt;Terraform ë„íë¨¼íŠ¸&lt;/a&gt; ì—ì„œ ì‚¬ìš©ë²•ì„ í™•ì¸í•©ë‹ˆë‹¤.
ê¸°ì¡´ê¹Œì§€ì˜ ì‘ì—…ê³¼ëŠ” ë‹¬ë¦¬ ìƒë‹¹íˆ ì–´ë ¤ì›Œ ë³´ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì“± í›ì–´ë³´ë©´ í¬ê²Œ 4ê°€ì§€(bucket, IAM Roleê³¼ Policy, Codebuild)ë¡œ ì •ë¦¬ë©ë‹ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;bucket&quot;&gt;Bucket&lt;/h3&gt;
&lt;p&gt;ë„íë¨¼íŠ¸ì™€ ê°™ì´ ìš°ì„ ì ìœ¼ë¡œ S3ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. bucketì˜ ì´ë¦„ì€ ì„ íƒì´ì§€ë§Œ, ì—¬ëŸ¬ê°œì˜ ë²„í‚·ì„ ê°€ì§€ê³  ìˆëŠ” ì €ëŠ” ì‹ë³„ì„ ìœ„í•´ ì´ë¦„ì„ ë¶€ì—¬í–ˆìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;EOF&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt; &amp;gt; codebuild.tf
resource &quot;aws_s3_bucket&quot; &quot;artifact_bucket&quot; {
  bucket = &quot;ecr-pipeline&quot;
}
&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;EOF
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;iam-role&quot;&gt;IAM Role&lt;/h3&gt;
&lt;p&gt;ë„íë¨¼íŠ¸ë¥¼ ë”°ë¼ AssumeRoleì„ ì‚¬ìš©í•©ì‹œë‹¤. &lt;br /&gt;
â• S3ì„ ë§Œë“¤ë•Œ ì‚¬ìš©í•œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;codebuild.tf&lt;/code&gt;ì— ì•„ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;resource &quot;aws_iam_role&quot; &quot;codebuild_role&quot; {
  name = &quot;terraform-codebuild&quot;,
  assume_role_policy = &amp;lt;&amp;lt;EOF
{
   &quot;Version&quot;: &quot;2012-10-17&quot;,
   &quot;Statement&quot;: [
      {
         &quot;Effect&quot;: &quot;Allow&quot;,
         &quot;Principal&quot;: {
            &quot;Service&quot;: &quot;codebuild.amazonaws.com&quot;
         },
         &quot;Action&quot;: &quot;sts:AssumeRole&quot;
      }
   ]
}
EOF
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;iam-policy&quot;&gt;IAM Policy&lt;/h3&gt;
&lt;p&gt;ì •ì±…ì€ IAM ì½˜ì†”ì—ì„œ ê¸°ì¡´ì— ë§Œë“¤ì–´ì§„ ì •ì±…ì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆì§€ë§Œ, ì•„ë˜ì™€ ê°™ì´ ì§ì ‘ ì‘ì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
ë„íë¨¼íŠ¸ì—ì„œ EC2ì— ëŒ€í•œ ì •ì±…ì„ ì‚¬ìš©í•˜ì§€ë§Œ, ìš°ë¦¬ëŠ” ECRì„ ì‚¬ìš©í•˜ë¯€ë¡œ ì•„ë˜ì™€ ê°™ì€ ì •ì±…ì„ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;noscript&gt;
  &lt;pre&gt;resource &amp;quot;aws_iam_policy&amp;quot; &amp;quot;codebuild_policy&amp;quot; {
  description = &amp;quot;CodeBuild Execution Policy&amp;quot;
  policy      = &amp;lt;&amp;lt;EOF
{
  &amp;quot;Version&amp;quot;: &amp;quot;2012-10-17&amp;quot;,
  &amp;quot;Statement&amp;quot;: [
    {
      &amp;quot;Action&amp;quot;: [
        &amp;quot;logs:CreateLogGroup&amp;quot;, &amp;quot;logs:CreateLogStream&amp;quot;, &amp;quot;logs:PutLogEvents&amp;quot;,
        &amp;quot;ecr:GetAuthorizationToken&amp;quot;
      ],
      &amp;quot;Effect&amp;quot;: &amp;quot;Allow&amp;quot;,
      &amp;quot;Resource&amp;quot;: &amp;quot;*&amp;quot;
    },
    {
      &amp;quot;Action&amp;quot;: [
        &amp;quot;s3:GetObject&amp;quot;, &amp;quot;s3:GetObjectVersion&amp;quot;, &amp;quot;s3:PutObject&amp;quot;
      ],
      &amp;quot;Effect&amp;quot;: &amp;quot;Allow&amp;quot;,
      &amp;quot;Resource&amp;quot;: &amp;quot;${aws_s3_bucket.artifact_bucket.arn}/*&amp;quot;
    },
    {
      &amp;quot;Action&amp;quot;: [
        &amp;quot;ecr:GetDownloadUrlForLayer&amp;quot;, &amp;quot;ecr:BatchGetImage&amp;quot;,
        &amp;quot;ecr:BatchCheckLayerAvailability&amp;quot;, &amp;quot;ecr:PutImage&amp;quot;,
        &amp;quot;ecr:InitiateLayerUpload&amp;quot;, &amp;quot;ecr:UploadLayerPart&amp;quot;,
        &amp;quot;ecr:CompleteLayerUpload&amp;quot;
      ],
      &amp;quot;Effect&amp;quot;: &amp;quot;Allow&amp;quot;,
      &amp;quot;Resource&amp;quot;: &amp;quot;${aws_ecr_repository.image_repo.arn}&amp;quot;
    }
  ]
}
EOF
}&lt;/pre&gt;
&lt;/noscript&gt;
&lt;script src=&quot;https://gist.github.com/heuristicwave/09103b88af041153ccd206ec6d51b7c1.js&quot;&gt; &lt;/script&gt;

&lt;p&gt;20, 30ë¼ì¸ì—ì„œ ì•ì„œ ìƒì„±í•œ ë¦¬ì†ŒìŠ¤ë¥¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${ì±„ì›€ì°¸ì¡°}&lt;/code&gt; ë¬¸ë²•ìœ¼ë¡œ ìœ ì—°í•œ ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ğŸš© ì´ì–´ì„œ ìƒì„±í•œ &lt;strong&gt;Policyë¥¼ Roleì— ë¶€ì—¬&lt;/strong&gt;í•©ë‹ˆë‹¤. ì´ê²ƒ ì—­ì‹œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;codebuild.tf&lt;/code&gt;ì— ì¶”ê°€í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;resource &quot;aws_iam_role_policy_attachment&quot; &quot;codebuild-attach&quot; {
  role       = aws_iam_role.codebuild_role.name
  policy_arn = aws_iam_policy.codebuild_policy.arn
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;codebuild-1&quot;&gt;CodeBuild&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/codebuild_project&quot;&gt;Terraform ë„íë¨¼íŠ¸&lt;/a&gt; ë¥¼ ë³´ì•„ë„ ì–´ë–»ê²Œ í•´ì•¼ ECRì— ì ìš©ì‹œí‚¬ ìˆ˜ ìˆëŠ”ì§€ ì•Œê¸° ì–´ë µìŠµë‹ˆë‹¤.
ìš°ì„  CodeBuildë¥¼ ì´í•´í•˜ê¸° ìœ„í•´ &lt;a href=&quot;https://docs.aws.amazon.com/ko_kr/codebuild/latest/userguide/sample-docker.html&quot;&gt;AWS docs&lt;/a&gt; ë¥¼ ì½ì–´ë´…ì‹œë‹¤.
ëŒ€ëµ ë¦¬ì†ŒìŠ¤ ì´ë¦„ì„ ì •í•˜ê³ , í™˜ê²½ì„ êµ¬ì„±í•˜ê³  ë¹Œë“œë¥¼ í•˜ê¸° ìœ„í•œ ë°©ë²•ì„ ì •ì˜í•´ì•¼ í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
CodeBuildê°€ ì •ì˜ëœ ì•„ë˜ ì½”ë“œë¥¼ í™œìš©í•´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;codebuild.tf&lt;/code&gt;ì— ì¶”ê°€í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;noscript&gt;
  &lt;pre&gt;resource &amp;quot;aws_codebuild_project&amp;quot; &amp;quot;codebuild&amp;quot; {
  name         = &amp;quot;codebuild-${var.source_repo_name}-${var.source_repo_branch}&amp;quot;
  service_role = aws_iam_role.codebuild_role.arn

  artifacts {
    type = &amp;quot;CODEPIPELINE&amp;quot;
  }
  
  environment {
    compute_type                = &amp;quot;BUILD_GENERAL1_MEDIUM&amp;quot;
    image                       = &amp;quot;aws/codebuild/standard:3.0&amp;quot;
    type                        = &amp;quot;LINUX_CONTAINER&amp;quot;
    privileged_mode             = true
    image_pull_credentials_type = &amp;quot;CODEBUILD&amp;quot;
    environment_variable {
      name  = &amp;quot;REPOSITORY_URI&amp;quot;
      value = aws_ecr_repository.image_repo.repository_url
    }
    environment_variable {
      name  = &amp;quot;AWS_DEFAULT_REGION&amp;quot;
      value = var.aws_region
    }
    environment_variable {
      name  = &amp;quot;CONTAINER_NAME&amp;quot;
      value = var.container_name
    }
  }
  source {
    type      = &amp;quot;CODEPIPELINE&amp;quot;
    buildspec = &amp;lt;&amp;lt;BUILDSPEC
${file(&amp;quot;buildspec.yml&amp;quot;)}
BUILDSPEC
  }
}&lt;/pre&gt;
&lt;/noscript&gt;
&lt;script src=&quot;https://gist.github.com/heuristicwave/2ebf79ce3cbdf4a87657b272f9e1d994.js&quot;&gt; &lt;/script&gt;

&lt;p&gt;31ë¼ì¸ì´ ì°¸ì¡°í•˜ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;buildspec.yml&lt;/code&gt;ì„ pre_build, build, post_buildì— ë§ì¶° ì‘ì„±í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s&quot;&gt;cat &amp;lt;&amp;lt;EOF &amp;gt; buildspec.yml&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.2&lt;/span&gt;

&lt;span class=&quot;na&quot;&gt;phases&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;runtime-versions&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;18&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;pre_build&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;commands&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;echo Logging in to Amazon ECR...&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;$(aws ecr get-login --region $AWS_DEFAULT_REGION --no-include-email)&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;COMMIT_HASH=$(echo $CODEBUILD_RESOLVED_SOURCE_VERSION | cut -c 1-7)&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;IMAGE_TAG=${COMMIT_HASH:=latest}&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;commands&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;echo Build started on `date`&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;echo Building the Docker image...&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;docker build -t $REPOSITORY_URI:latest .&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;docker tag $REPOSITORY_URI:latest $REPOSITORY_URI:$IMAGE_TAG&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;post_build&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;commands&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;echo Build completed on `date`&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;echo Pushing the Docker image...&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;docker push $REPOSITORY_URI:latest&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;docker push $REPOSITORY_URI:$IMAGE_TAG&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;echo Writing image definitions file...&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;printf '[{&quot;name&quot;:&quot;%s&quot;,&quot;imageUri&quot;:&quot;%s&quot;}]' $CONTAINER_NAME $REPOSITORY_URI:$IMAGE_TAG &amp;gt; imagedefinitions.json&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;artifacts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;files&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;imagedefinitions.json&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì§€ê¸ˆê¹Œì§€ ì‘ì„±ëœ ì¸í”„ë¼ë¥¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;terraform state list&lt;/code&gt;ëª…ë ¹ì–´ë¥¼ í†µí•´ í™•ì¸í•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;â¯ terraform state list
aws_codebuild_project.codebuild
aws_codecommit_repository.test
aws_ecr_repository.image_repo
aws_iam_policy.codebuild_policy
aws_iam_role.codebuild_role
aws_iam_role_policy_attachment.codebuild-attach
aws_s3_bucket.artifact_bucket
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;details&gt;
  &lt;summary&gt;ìƒì„±í•œ ì¸í”„ë¼ê°€ ìœ„ì™€ ê°™ì§€ ì•Šì„ ê²½ìš°, ğŸ‘‰ Click&lt;/summary&gt;

  &lt;p&gt;ì‹¤ìˆ˜ë¡œ ì˜ë„ì¹˜ ì•Šì€ ì¸í”„ë¼ê°€ í”„ë¡œë¹„ì €ë‹ ë˜ì—ˆë‹¤ë©´ 2ê°€ì§€ ë°©ë²•ì„ í†µí•´ ì› ìƒíƒœë¡œ ë³µêµ¬ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/p&gt;
  &lt;ol&gt;
    &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;terraform destroy&lt;/code&gt; ëª…ë ¹ì–´ë¡œ íŠ¹ì • ì¸í”„ë¼ë§Œ ë˜ëŒë¦¬ê±°ë‚˜ í”„ë¡œë¹„ì €ë‹ í•˜ê³ ì‹¶ì€ ê²½ìš°, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-target&lt;/code&gt; ì˜µì…˜ê³¼ í•¨ê»˜ resource ëª…ìœ¼ë¡œ ëª…ë ¹ì–´ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. &lt;br /&gt;
&lt;em&gt;ì˜ˆì‹œ) terraform destory -target aws_vpc.main&lt;/em&gt;&lt;/li&gt;
    &lt;li&gt;ì˜ëª» ì‘ì„±í•œ ì½”ë“œë¥¼ ìˆ˜ì • í›„, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;terraform apply&lt;/code&gt;ëª…ë ¹ì–´ë¥¼ ì ìš©í•˜ì—¬ ìµœì‹  ìƒíƒœì˜ ì¸í”„ë¼ë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤.&lt;/li&gt;
  &lt;/ol&gt;

&lt;/details&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;span class=&quot;table-of-contents-list&quot;&gt;Terraform Courses&lt;/span&gt;&lt;/p&gt;
&lt;ul class=&quot;table-of-contents-list&quot;&gt;
    &lt;li&gt;&lt;a href=&quot;./3Tier&quot;&gt;3-Tier VPC Architecture with Terraform&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./CodeCommit&quot;&gt;ECR Pipeline with Terraform â…  (CodeCommit)&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./CodeBuild&quot;&gt;ECR Pipeline with Terraform â…¡ (ECR, CodeBuild, IAM)&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./CodePipeline&quot;&gt;ECR Pipeline with Terraform â…¢ (CodePipeline)&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;./Packer&quot;&gt;Provision Infrastructure with Packer&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Heuristic Wave</name>
        
        
      </author>

      

      
        <category term="aws" />
      
        <category term="devops" />
      
        <category term="terraform" />
      

      
        <summary type="html">Terraformìœ¼ë¡œ ECR íŒŒì´í”„ë¼ì¸ êµ¬ì¶•í•˜ê¸° 2 (ECR, CodeBuild, IAM)</summary>
      

      
      
    </entry>
  
</feed>
